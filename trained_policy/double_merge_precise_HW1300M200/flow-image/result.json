{"episode_reward_max": 211.16137059056396, "episode_reward_min": 135.39383949053578, "episode_reward_mean": 162.3928865695209, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.122691084636989, "mean_inference_ms": 0.8436876670339613, "mean_action_processing_ms": 0.0786167010168896, "mean_env_wait_ms": 9.09713362250601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 7500, "agent_timesteps_total": 7500, "timers": {"sample_time_ms": 11104.831, "sample_throughput": 675.382, "learn_time_ms": 5557.549, "learn_throughput": 1349.516, "update_time_ms": 2.232}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 48.75332879211943, "policy_loss": -0.0072460254662180855, "vf_loss": 48.75938741069729, "vf_explained_var": -0.08704972267150879, "kl": 0.0059383441074560795, "entropy": 7.081132807974088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 7500, "num_agent_steps_sampled": 7500, "num_steps_trained": 7500}, "done": false, "episodes_total": 10, "training_iteration": 1, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-53-00", "timestamp": 1693792380, "time_this_iter_s": 16.670736074447632, "time_total_s": 16.670736074447632, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 16.670736074447632, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.69583333333333, "ram_util_percent": 18.349999999999998}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 326.5391283999876, "episode_reward_min": 135.39383949053578, "episode_reward_mean": 180.871946100843, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.077838841181366, "mean_inference_ms": 0.8447557920017699, "mean_action_processing_ms": 0.07851439564776516, "mean_env_wait_ms": 8.237244942763152, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 15000, "agent_timesteps_total": 15000, "timers": {"sample_time_ms": 9826.873, "sample_throughput": 763.213, "learn_time_ms": 5541.333, "learn_throughput": 1353.465, "update_time_ms": 2.252}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 48.11178747274108, "policy_loss": -0.006898199784237955, "vf_loss": 48.11819162207135, "vf_explained_var": -0.05507771298289299, "kl": 0.004942170841854548, "entropy": 7.023497599262302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 15000, "num_agent_steps_sampled": 15000, "num_steps_trained": 15000}, "done": false, "episodes_total": 20, "training_iteration": 2, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-53-14", "timestamp": 1693792394, "time_this_iter_s": 14.0829439163208, "time_total_s": 30.753679990768433, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 30.753679990768433, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 30.959999999999997, "ram_util_percent": 18.559999999999995}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 326.5391283999876, "episode_reward_min": 135.39383949053578, "episode_reward_mean": 190.00635324751212, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9852541366357297, "mean_inference_ms": 0.8429248655870721, "mean_action_processing_ms": 0.07833500758750249, "mean_env_wait_ms": 7.712818765812391, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 22500, "agent_timesteps_total": 22500, "timers": {"sample_time_ms": 9083.498, "sample_throughput": 825.673, "learn_time_ms": 5546.756, "learn_throughput": 1352.142, "update_time_ms": 2.249}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 5.000000000000001e-05, "total_loss": 51.304521483081885, "policy_loss": -0.01018589110176821, "vf_loss": 51.31429844872426, "vf_explained_var": -0.034638628363609314, "kl": 0.00817767180671265, "entropy": 6.9292662337674935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 22500, "num_agent_steps_sampled": 22500, "num_steps_trained": 22500}, "done": false, "episodes_total": 30, "training_iteration": 3, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-53-27", "timestamp": 1693792407, "time_this_iter_s": 13.163192987442017, "time_total_s": 43.91687297821045, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 43.91687297821045, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.81578947368421, "ram_util_percent": 18.568421052631578}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 433.1175575571451, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 203.7281029792317, "episode_len_mean": 737.65, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.930409035633203, "mean_inference_ms": 0.8410847446889125, "mean_action_processing_ms": 0.07815205910820003, "mean_env_wait_ms": 7.35245868442099, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 30000, "agent_timesteps_total": 30000, "timers": {"sample_time_ms": 8797.82, "sample_throughput": 852.484, "learn_time_ms": 5551.156, "learn_throughput": 1351.07, "update_time_ms": 2.168}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 79.61491628097275, "policy_loss": -0.012746426278046506, "vf_loss": 79.62734903885146, "vf_explained_var": -0.0039009444881230593, "kl": 0.012550927298765977, "entropy": 6.896048891746392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 30000, "num_agent_steps_sampled": 30000, "num_steps_trained": 30000}, "done": false, "episodes_total": 40, "training_iteration": 4, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-53-40", "timestamp": 1693792420, "time_this_iter_s": 13.51439118385315, "time_total_s": 57.4312641620636, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 57.4312641620636, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.034999999999997, "ram_util_percent": 18.589999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 433.1175575571451, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 213.35304216262898, "episode_len_mean": 740.12, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.88240535452151, "mean_inference_ms": 0.8396852381322992, "mean_action_processing_ms": 0.07799630336541426, "mean_env_wait_ms": 7.094842915800723, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 37500, "agent_timesteps_total": 37500, "timers": {"sample_time_ms": 8632.411, "sample_throughput": 868.819, "learn_time_ms": 5548.503, "learn_throughput": 1351.716, "update_time_ms": 2.133}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 5.000000000000001e-05, "total_loss": 92.55538251197945, "policy_loss": -0.008583839315826357, "vf_loss": 92.56374282836914, "vf_explained_var": -0.001237971242517233, "kl": 0.008946538729233818, "entropy": 6.937704071756136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 37500, "num_agent_steps_sampled": 37500, "num_steps_trained": 37500}, "done": false, "episodes_total": 50, "training_iteration": 5, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-53-54", "timestamp": 1693792434, "time_this_iter_s": 13.5159273147583, "time_total_s": 70.9471914768219, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 70.9471914768219, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.873684210526324, "ram_util_percent": 18.61052631578947}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 454.4736653135753, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 226.68942434114427, "episode_len_mean": 741.7666666666667, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.845395152974637, "mean_inference_ms": 0.8370340035467955, "mean_action_processing_ms": 0.07776688818584704, "mean_env_wait_ms": 6.8835991591900205, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 45000, "agent_timesteps_total": 45000, "timers": {"sample_time_ms": 8480.852, "sample_throughput": 884.345, "learn_time_ms": 5551.909, "learn_throughput": 1350.887, "update_time_ms": 2.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 119.13146666187352, "policy_loss": -0.008000363227990219, "vf_loss": 119.13934554407152, "vf_explained_var": 0.005760527215898037, "kl": 0.009709566682835501, "entropy": 6.7959387480202365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 45000, "num_agent_steps_sampled": 45000, "num_steps_trained": 45000}, "done": false, "episodes_total": 60, "training_iteration": 6, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-54-07", "timestamp": 1693792447, "time_this_iter_s": 13.300078868865967, "time_total_s": 84.24727034568787, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 84.24727034568787, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 18.65263157894737}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 454.4736653135753, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 233.1614145078166, "episode_len_mean": 742.9428571428572, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8130261146224576, "mean_inference_ms": 0.8343211586270596, "mean_action_processing_ms": 0.07752646324117929, "mean_env_wait_ms": 6.715265280937828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 52500, "agent_timesteps_total": 52500, "timers": {"sample_time_ms": 8308.338, "sample_throughput": 902.708, "learn_time_ms": 5556.986, "learn_throughput": 1349.652, "update_time_ms": 2.109}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 5.000000000000001e-05, "total_loss": 113.00233515723276, "policy_loss": -0.00753488293375378, "vf_loss": 113.00981213197869, "vf_explained_var": 0.002465008059516549, "kl": 0.009185907681236312, "entropy": 6.881216605234954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 52500, "num_agent_steps_sampled": 52500, "num_steps_trained": 52500}, "done": false, "episodes_total": 70, "training_iteration": 7, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-54-20", "timestamp": 1693792460, "time_this_iter_s": 12.868430614471436, "time_total_s": 97.1157009601593, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 97.1157009601593, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.77777777777778, "ram_util_percent": 18.655555555555555}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 245.92204511490428, "episode_len_mean": 743.825, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.783785812591462, "mean_inference_ms": 0.8316686569104998, "mean_action_processing_ms": 0.07729040014891828, "mean_env_wait_ms": 6.569031410635371, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 60000, "agent_timesteps_total": 60000, "timers": {"sample_time_ms": 8111.593, "sample_throughput": 924.603, "learn_time_ms": 5554.392, "learn_throughput": 1350.283, "update_time_ms": 2.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 5.000000000000001e-05, "total_loss": 156.61516458543682, "policy_loss": -0.010923935220403186, "vf_loss": 156.62604093389996, "vf_explained_var": 0.0018069331999868155, "kl": 0.015102273826270869, "entropy": 6.739459301253497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 60000, "num_agent_steps_sampled": 60000, "num_steps_trained": 60000}, "done": false, "episodes_total": 80, "training_iteration": 8, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-54-32", "timestamp": 1693792472, "time_this_iter_s": 12.279852151870728, "time_total_s": 109.39555311203003, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 109.39555311203003, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 30.033333333333335, "ram_util_percent": 18.66666666666667}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 260.96111062870233, "episode_len_mean": 738.4333333333333, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7653571114425075, "mean_inference_ms": 0.828844458002706, "mean_action_processing_ms": 0.0770365858865602, "mean_env_wait_ms": 6.435769093847027, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 67500, "agent_timesteps_total": 67500, "timers": {"sample_time_ms": 7973.63, "sample_throughput": 940.6, "learn_time_ms": 5553.345, "learn_throughput": 1350.537, "update_time_ms": 2.211}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 5.000000000000001e-05, "total_loss": 216.7857710110939, "policy_loss": -0.007359984049857673, "vf_loss": 216.79310483770854, "vf_explained_var": 0.0022338111884891987, "kl": 0.008551573901668176, "entropy": 6.5382162627527265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 67500, "num_agent_steps_sampled": 67500, "num_steps_trained": 67500}, "done": false, "episodes_total": 90, "training_iteration": 9, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-54-45", "timestamp": 1693792485, "time_this_iter_s": 12.423492431640625, "time_total_s": 121.81904554367065, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 121.81904554367065, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.13333333333334, "ram_util_percent": 18.650000000000002}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 268.5446856669356, "episode_len_mean": 739.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.13095155029018, 143.4402520852926, 211.16137059056396, 154.48740681860082, 145.09545374437704, 202.62996980059881, 176.23801410578943, 137.32975313922282, 144.02185436993742, 135.39383949053578, 190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.755636028198028, "mean_inference_ms": 0.8258813851077197, "mean_action_processing_ms": 0.07678114818341453, "mean_env_wait_ms": 6.318701682394338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 75000, "agent_timesteps_total": 75000, "timers": {"sample_time_ms": 7959.083, "sample_throughput": 942.32, "learn_time_ms": 5551.457, "learn_throughput": 1350.997, "update_time_ms": 2.189}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 199.21509204153287, "policy_loss": -0.008364863815851572, "vf_loss": 199.22343955605717, "vf_explained_var": 0.016730409115552902, "kl": 0.011264929714871825, "entropy": 6.791125755794978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 75000, "num_agent_steps_sampled": 75000, "num_steps_trained": 75000}, "done": false, "episodes_total": 100, "training_iteration": 10, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-54-58", "timestamp": 1693792498, "time_this_iter_s": 13.370210886001587, "time_total_s": 135.18925642967224, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 135.18925642967224, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 26.394736842105264, "ram_util_percent": 18.573684210526313}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 280.73948706251764, "episode_len_mean": 739.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.5376747096961, 164.36498697637327, 197.18697573626753, 155.5945514959942, 152.9172664309823, 175.2751257571995, 262.09120892599424, 326.5391283999876, 203.0588635349877, 165.9442743541684, 210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.716662113217993, "mean_inference_ms": 0.8211174606507474, "mean_action_processing_ms": 0.07633907813331142, "mean_env_wait_ms": 5.930604365885565, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 82500, "agent_timesteps_total": 82500, "timers": {"sample_time_ms": 7804.916, "sample_throughput": 960.933, "learn_time_ms": 5548.845, "learn_throughput": 1351.633, "update_time_ms": 2.159}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 183.56247924546065, "policy_loss": -0.010495716670401773, "vf_loss": 183.572951261876, "vf_explained_var": 0.12935355305671692, "kl": 0.01576279635228354, "entropy": 7.088019232830759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 82500, "num_agent_steps_sampled": 82500, "num_steps_trained": 82500}, "done": false, "episodes_total": 110, "training_iteration": 11, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-55-13", "timestamp": 1693792513, "time_this_iter_s": 15.102347373962402, "time_total_s": 150.29160380363464, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 150.29160380363464, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 26.4952380952381, "ram_util_percent": 18.65238095238096}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 290.0404915776546, "episode_len_mean": 739.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.93254647735552, 182.26387255252862, 227.1391857856539, 214.34122472205178, 167.36001071755615, 215.89118048196167, 195.04230659483542, 238.2222944848959, 208.82940987672592, 222.72964371494027, 228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.683301103517585, "mean_inference_ms": 0.8158244106259732, "mean_action_processing_ms": 0.07588975094754193, "mean_env_wait_ms": 5.709739394996806, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 90000, "agent_timesteps_total": 90000, "timers": {"sample_time_ms": 7719.528, "sample_throughput": 971.562, "learn_time_ms": 5548.895, "learn_throughput": 1351.62, "update_time_ms": 2.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 215.2335904008251, "policy_loss": -0.007524399754149302, "vf_loss": 215.2410956689867, "vf_explained_var": 0.22973208129405975, "kl": 0.012048898330411237, "entropy": 6.9162684982105835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 90000, "num_agent_steps_sampled": 90000, "num_steps_trained": 90000}, "done": false, "episodes_total": 120, "training_iteration": 12, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-55-27", "timestamp": 1693792527, "time_this_iter_s": 13.229133605957031, "time_total_s": 163.52073740959167, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 163.52073740959167, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 27.910526315789465, "ram_util_percent": 18.668421052631583}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6223004282457, "episode_reward_min": 106.63615571965936, "episode_reward_mean": 298.03919083042547, "episode_len_mean": 739.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.2555852977715, 279.4398478024855, 234.5971393526183, 252.54915014294892, 205.6267515515222, 194.44145750732883, 433.1175575571451, 326.0631159427675, 106.63615571965936, 188.20676086965506, 290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 256, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6726456630244098, "mean_inference_ms": 0.8111440661713128, "mean_action_processing_ms": 0.07548087091690983, "mean_env_wait_ms": 5.5578455703429075, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 97500, "agent_timesteps_total": 97500, "timers": {"sample_time_ms": 7723.265, "sample_throughput": 971.092, "learn_time_ms": 5547.758, "learn_throughput": 1351.898, "update_time_ms": 2.108}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 215.95258436041362, "policy_loss": -0.010567504952077643, "vf_loss": 215.96312890780175, "vf_explained_var": 0.3338082432746887, "kl": 0.015167070814080105, "entropy": 6.829572537793951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 97500, "num_agent_steps_sampled": 97500, "num_steps_trained": 97500}, "done": false, "episodes_total": 130, "training_iteration": 13, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-55-40", "timestamp": 1693792540, "time_this_iter_s": 13.189119815826416, "time_total_s": 176.7098572254181, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 176.7098572254181, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 29.27894736842105, "ram_util_percent": 18.61578947368421}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.9576450528209, "episode_reward_min": 146.52969310542343, "episode_reward_mean": 314.1272556385427, "episode_len_mean": 744.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.18362408478487, 246.14802576287315, 184.40594401531692, 264.9170660187126, 308.93364132036277, 306.4594345532238, 209.26058279905362, 266.5752701140288, 171.74539713048006, 269.8990031633463, 323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6663312386783558, "mean_inference_ms": 0.8066396014962183, "mean_action_processing_ms": 0.07509138718079372, "mean_env_wait_ms": 5.436522074967168, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 105000, "agent_timesteps_total": 105000, "timers": {"sample_time_ms": 7630.412, "sample_throughput": 982.909, "learn_time_ms": 5546.725, "learn_throughput": 1352.149, "update_time_ms": 2.103}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 275.1228806059239, "policy_loss": -0.009069026019266348, "vf_loss": 275.1319286023156, "vf_explained_var": 0.21856436133384705, "kl": 0.014585998887022016, "entropy": 6.040193394483146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 105000, "num_agent_steps_sampled": 105000, "num_steps_trained": 105000}, "done": false, "episodes_total": 140, "training_iteration": 14, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-55-53", "timestamp": 1693792553, "time_this_iter_s": 12.573291301727295, "time_total_s": 189.28314852714539, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 189.28314852714539, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 27.394444444444442, "ram_util_percent": 18.63888888888889}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.9576450528209, "episode_reward_min": 146.52969310542343, "episode_reward_mean": 325.7482167317904, "episode_len_mean": 744.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.1891051678732, 229.18045812793247, 350.5776964373118, 269.32459494271404, 454.4736653135753, 242.50946359405185, 272.8296734866668, 265.31266410854084, 227.0986840010898, 299.2173471574512, 408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6674798295397197, "mean_inference_ms": 0.8019946753254088, "mean_action_processing_ms": 0.0747025785318061, "mean_env_wait_ms": 5.329577772671908, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 112500, "agent_timesteps_total": 112500, "timers": {"sample_time_ms": 7515.437, "sample_throughput": 997.946, "learn_time_ms": 5547.27, "learn_throughput": 1352.016, "update_time_ms": 2.099}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 300.87085943706967, "policy_loss": -0.008707369657991043, "vf_loss": 300.87954864501955, "vf_explained_var": 0.2885983884334564, "kl": 0.011871511114313948, "entropy": 6.311223178798869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 112500, "num_agent_steps_sampled": 112500, "num_steps_trained": 112500}, "done": false, "episodes_total": 150, "training_iteration": 15, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-56-05", "timestamp": 1693792565, "time_this_iter_s": 12.37270474433899, "time_total_s": 201.65585327148438, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 201.65585327148438, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 27.594444444444445, "ram_util_percent": 18.65}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 146.52969310542343, "episode_reward_mean": 341.1233782447279, "episode_len_mean": 744.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [408.63989756605764, 309.04479956709304, 256.5471250955455, 242.95782934619422, 202.43537813471417, 166.98946233047062, 231.49167352817878, 273.1022452079, 340.1942757900983, 288.5308685122528, 279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6747673830183367, "mean_inference_ms": 0.7979784606699074, "mean_action_processing_ms": 0.07435715530904306, "mean_env_wait_ms": 5.238868824199613, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 120000, "agent_timesteps_total": 120000, "timers": {"sample_time_ms": 7481.19, "sample_throughput": 1002.514, "learn_time_ms": 5544.153, "learn_throughput": 1352.777, "update_time_ms": 2.08}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 338.28257262666347, "policy_loss": -0.005963800775708031, "vf_loss": 338.2885178646799, "vf_explained_var": 0.24473488330841064, "kl": 0.011361084665433343, "entropy": 5.974860140428705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 120000, "num_agent_steps_sampled": 120000, "num_steps_trained": 120000}, "done": false, "episodes_total": 160, "training_iteration": 16, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-56-18", "timestamp": 1693792578, "time_this_iter_s": 12.925706624984741, "time_total_s": 214.58155989646912, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 214.58155989646912, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 29.100000000000005, "ram_util_percent": 18.66111111111111}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 146.52969310542343, "episode_reward_mean": 358.1744079725151, "episode_len_mean": 744.53, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.6359917974833, 273.2861051096126, 519.6223004282457, 327.3099592686965, 387.2876149458681, 276.87164104831004, 260.17426998450856, 256.31398440714526, 295.8990936579183, 476.06363299738956, 404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.686324689108129, "mean_inference_ms": 0.7943591676079557, "mean_action_processing_ms": 0.07404491976356843, "mean_env_wait_ms": 5.153552118075641, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 127500, "agent_timesteps_total": 127500, "timers": {"sample_time_ms": 7444.058, "sample_throughput": 1007.515, "learn_time_ms": 5541.373, "learn_throughput": 1353.455, "update_time_ms": 2.085}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 362.49382955260194, "policy_loss": -0.006666253616843941, "vf_loss": 362.5004789449401, "vf_explained_var": 0.2515036463737488, "kl": 0.009925993909946126, "entropy": 5.876571412813866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 127500, "num_agent_steps_sampled": 127500, "num_steps_trained": 127500}, "done": false, "episodes_total": 170, "training_iteration": 17, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-56-30", "timestamp": 1693792590, "time_this_iter_s": 12.469257354736328, "time_total_s": 227.05081725120544, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 227.05081725120544, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 29.62777777777778, "ram_util_percent": 18.655555555555555}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 146.52969310542343, "episode_reward_mean": 368.36435955051036, "episode_len_mean": 744.44, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [404.6036355620085, 146.52969310542343, 509.8758857026748, 478.6144050870059, 465.96656681061154, 152.94070894904024, 499.6198109299888, 235.34412980641628, 441.5993760282764, 477.6421354094184, 227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983], "episode_lengths": [750, 561, 750, 750, 750, 392, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.700804707326867, "mean_inference_ms": 0.7912162695065575, "mean_action_processing_ms": 0.07376708690914632, "mean_env_wait_ms": 5.078265891353035, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 135000, "agent_timesteps_total": 135000, "timers": {"sample_time_ms": 7468.933, "sample_throughput": 1004.16, "learn_time_ms": 5550.494, "learn_throughput": 1351.231, "update_time_ms": 1.999}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 410.79834535243145, "policy_loss": -0.010037356783178146, "vf_loss": 410.80837472172107, "vf_explained_var": 0.2912743389606476, "kl": 0.013439554614064902, "entropy": 5.944309124704135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 135000, "num_agent_steps_sampled": 135000, "num_steps_trained": 135000}, "done": false, "episodes_total": 180, "training_iteration": 18, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-56-43", "timestamp": 1693792603, "time_this_iter_s": 12.618210554122925, "time_total_s": 239.66902780532837, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 239.66902780532837, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 26.422222222222224, "ram_util_percent": 18.63888888888889}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 180.89344103254146, "episode_reward_mean": 375.55583361274023, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.08737484549312, 389.032324418976, 265.7361655679799, 219.19931592177326, 316.79473384349785, 471.7188012580653, 387.9505692350146, 487.0550046005068, 299.9887363164683, 303.40558410258205, 219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.716706198232904, "mean_inference_ms": 0.7884883426035411, "mean_action_processing_ms": 0.07352660569075431, "mean_env_wait_ms": 5.015126051641274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 142500, "agent_timesteps_total": 142500, "timers": {"sample_time_ms": 7556.824, "sample_throughput": 992.48, "learn_time_ms": 5548.569, "learn_throughput": 1351.7, "update_time_ms": 2.001}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 431.25378861508125, "policy_loss": -0.007291082586398569, "vf_loss": 431.2610709497484, "vf_explained_var": 0.17924611270427704, "kl": 0.01225886629173936, "entropy": 5.831157117778972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 142500, "num_agent_steps_sampled": 142500, "num_steps_trained": 142500}, "done": false, "episodes_total": 190, "training_iteration": 19, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-56-56", "timestamp": 1693792616, "time_this_iter_s": 13.28403377532959, "time_total_s": 252.95306158065796, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 252.95306158065796, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.157894736842106, "ram_util_percent": 18.621052631578948}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 180.89344103254146, "episode_reward_mean": 384.4192487584041, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [219.25460156804795, 214.54422275451603, 245.41728939490562, 239.45617070817974, 359.8210807615334, 214.9811449753697, 271.21885974836545, 274.2533503696903, 313.84113304362694, 490.62115192917895, 499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7315373668150467, "mean_inference_ms": 0.7862149497646613, "mean_action_processing_ms": 0.073320175190961, "mean_env_wait_ms": 4.9580239489558355, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 150000, "agent_timesteps_total": 150000, "timers": {"sample_time_ms": 7537.78, "sample_throughput": 994.988, "learn_time_ms": 5549.506, "learn_throughput": 1351.472, "update_time_ms": 2.003}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 432.8168118234408, "policy_loss": -0.008406151282616844, "vf_loss": 432.8252063557253, "vf_explained_var": 0.3417580723762512, "kl": 0.012666546516045553, "entropy": 5.930831345057084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 150000, "num_agent_steps_sampled": 150000, "num_steps_trained": 150000}, "done": false, "episodes_total": 200, "training_iteration": 20, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-57-10", "timestamp": 1693792630, "time_this_iter_s": 13.190136432647705, "time_total_s": 266.14319801330566, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 266.14319801330566, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 27.578947368421048, "ram_util_percent": 18.631578947368425}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 180.89344103254146, "episode_reward_mean": 402.4936885890885, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [499.3270514113894, 227.62352524629114, 245.69481519239125, 232.73425949169535, 242.07657687258188, 232.83771966618855, 235.24004266928137, 480.6982413320733, 234.10362891867962, 293.2746470347776, 180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.740683611436321, "mean_inference_ms": 0.7841291608945161, "mean_action_processing_ms": 0.07312912720465163, "mean_env_wait_ms": 4.901006587856112, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 157500, "agent_timesteps_total": 157500, "timers": {"sample_time_ms": 7312.727, "sample_throughput": 1025.609, "learn_time_ms": 5549.314, "learn_throughput": 1351.518, "update_time_ms": 2.001}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 493.71182757878705, "policy_loss": -0.00639617733767856, "vf_loss": 493.71821586479575, "vf_explained_var": 0.2705810070037842, "kl": 0.011193868299058992, "entropy": 5.661576397136106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 157500, "num_agent_steps_sampled": 157500, "num_steps_trained": 157500}, "done": false, "episodes_total": 210, "training_iteration": 21, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-57-23", "timestamp": 1693792643, "time_this_iter_s": 12.849525213241577, "time_total_s": 278.99272322654724, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 278.99272322654724, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 27.336842105263162, "ram_util_percent": 18.642105263157898}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.658909136444, "episode_reward_min": 180.89344103254146, "episode_reward_mean": 415.2471439790505, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.89344103254146, 272.2642970645145, 293.6914025970986, 403.0588996461996, 279.1778631681924, 206.60753581619733, 291.96139687332044, 189.72246677596704, 471.8117163571852, 293.4325813543741, 246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7540728643379877, "mean_inference_ms": 0.7822054499071815, "mean_action_processing_ms": 0.07295454737343002, "mean_env_wait_ms": 4.844693151673799, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 165000, "agent_timesteps_total": 165000, "timers": {"sample_time_ms": 7257.25, "sample_throughput": 1033.449, "learn_time_ms": 5555.26, "learn_throughput": 1350.072, "update_time_ms": 2.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 481.9767170792919, "policy_loss": -0.008661676858851717, "vf_loss": 481.9853688385527, "vf_explained_var": 0.4873458743095398, "kl": 0.013227142508277875, "entropy": 5.959326883089744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 165000, "num_agent_steps_sampled": 165000, "num_steps_trained": 165000}, "done": false, "episodes_total": 220, "training_iteration": 22, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-57-35", "timestamp": 1693792655, "time_this_iter_s": 12.73426365852356, "time_total_s": 291.7269868850708, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 291.7269868850708, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.305555555555557, "ram_util_percent": 18.63333333333334}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.6757597589049, "episode_reward_min": 225.75071602828103, "episode_reward_mean": 432.74343970279676, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.68393378642438, 312.8617460488877, 378.03277992684207, 456.6490360562916, 435.51684941727177, 520.9576450528209, 496.74116441185186, 500.70987815267057, 246.59379228886434, 462.99317741369595, 271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7712575537284296, "mean_inference_ms": 0.7801324125573059, "mean_action_processing_ms": 0.0727600090759511, "mean_env_wait_ms": 4.7864169634377625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 172500, "agent_timesteps_total": 172500, "timers": {"sample_time_ms": 7366.54, "sample_throughput": 1018.117, "learn_time_ms": 5558.234, "learn_throughput": 1349.349, "update_time_ms": 2.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 517.4589002706236, "policy_loss": -0.005799893113011021, "vf_loss": 517.464690696587, "vf_explained_var": 0.4618271589279175, "kl": 0.010282591956741817, "entropy": 5.776157288632151, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 172500, "num_agent_steps_sampled": 172500, "num_steps_trained": 172500}, "done": false, "episodes_total": 230, "training_iteration": 23, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-57-50", "timestamp": 1693792670, "time_this_iter_s": 14.310779571533203, "time_total_s": 306.037766456604, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 306.037766456604, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 24.740000000000002, "ram_util_percent": 18.650000000000006}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.6757597589049, "episode_reward_min": 225.75071602828103, "episode_reward_mean": 437.54321646016695, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [271.23664911072103, 258.1309562497179, 426.0721487087748, 492.3418593620831, 226.0548010542491, 327.2167447311214, 503.55640239841165, 333.342076286813, 336.843653991143, 505.8288063939209, 262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.7886624032348846, "mean_inference_ms": 0.7781608397034213, "mean_action_processing_ms": 0.07257774020873481, "mean_env_wait_ms": 4.732587800024294, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 180000, "agent_timesteps_total": 180000, "timers": {"sample_time_ms": 7342.102, "sample_throughput": 1021.506, "learn_time_ms": 5551.57, "learn_throughput": 1350.969, "update_time_ms": 2.126}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 555.4103427434371, "policy_loss": -0.006630577399569042, "vf_loss": 555.4169658854856, "vf_explained_var": 0.3864422142505646, "kl": 0.010907850575762596, "entropy": 5.595536218255253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 180000, "num_agent_steps_sampled": 180000, "num_steps_trained": 180000}, "done": false, "episodes_total": 240, "training_iteration": 24, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-58-02", "timestamp": 1693792682, "time_this_iter_s": 12.262649059295654, "time_total_s": 318.30041551589966, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 318.30041551589966, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 25.388888888888893, "ram_util_percent": 18.62777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.4103434687786, "episode_reward_min": 225.75071602828103, "episode_reward_mean": 450.28976065122015, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [262.3960393361297, 456.62524955819197, 509.3910022290321, 522.658909136444, 481.2296977418034, 493.38332147555053, 518.1330285110824, 505.4347759400805, 496.22676367436617, 225.75071602828103, 489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8073614276936025, "mean_inference_ms": 0.7762988908735129, "mean_action_processing_ms": 0.07240101379365792, "mean_env_wait_ms": 4.680871297478178, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 187500, "agent_timesteps_total": 187500, "timers": {"sample_time_ms": 7327.093, "sample_throughput": 1023.598, "learn_time_ms": 5549.345, "learn_throughput": 1351.511, "update_time_ms": 2.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 655.2839009430448, "policy_loss": -0.008257580191780954, "vf_loss": 655.2921432236494, "vf_explained_var": 0.16432511806488037, "kl": 0.01689950805743127, "entropy": 5.414209447472783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 187500, "num_agent_steps_sampled": 187500, "num_steps_trained": 187500}, "done": false, "episodes_total": 250, "training_iteration": 25, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-58-14", "timestamp": 1693792694, "time_this_iter_s": 12.20007610321045, "time_total_s": 330.5004916191101, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 330.5004916191101, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 29.252941176470586, "ram_util_percent": 18.647058823529417}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.4103434687786, "episode_reward_min": 258.942598577598, "episode_reward_mean": 453.7224002666135, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [489.9660282239179, 442.8713783289471, 501.1661041342664, 326.3115511717914, 496.75390401165134, 486.69164001250977, 466.7002562587815, 477.5256830760236, 337.5063326992689, 399.543649940063, 478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.823025630578875, "mean_inference_ms": 0.7746208165472881, "mean_action_processing_ms": 0.07223889571503884, "mean_env_wait_ms": 4.632398406682681, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 195000, "agent_timesteps_total": 195000, "timers": {"sample_time_ms": 7299.767, "sample_throughput": 1027.43, "learn_time_ms": 5548.832, "learn_throughput": 1351.636, "update_time_ms": 2.133}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 675.5731212809934, "policy_loss": -0.006212235182934141, "vf_loss": 675.5793171769482, "vf_explained_var": 0.28220561146736145, "kl": 0.014759270082396515, "entropy": 5.396077530262834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 195000, "num_agent_steps_sampled": 195000, "num_steps_trained": 195000}, "done": false, "episodes_total": 260, "training_iteration": 26, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-58-27", "timestamp": 1693792707, "time_this_iter_s": 12.647871255874634, "time_total_s": 343.14836287498474, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 343.14836287498474, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.92105263157895, "ram_util_percent": 18.65789473684211}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.3895410562959, "episode_reward_min": 258.942598577598, "episode_reward_mean": 458.963276839959, "episode_len_mean": 749.91, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.00820998122225, 327.58195876694515, 258.942598577598, 471.7178770167958, 508.8005500942371, 423.36157624485213, 516.8665955946528, 493.9819167738008, 498.5601074263912, 393.6383609681983, 493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 741, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.840724842294988, "mean_inference_ms": 0.7728872439763778, "mean_action_processing_ms": 0.07207890336468181, "mean_env_wait_ms": 4.586895626392828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 202500, "agent_timesteps_total": 202500, "timers": {"sample_time_ms": 7344.669, "sample_throughput": 1021.149, "learn_time_ms": 5552.47, "learn_throughput": 1350.75, "update_time_ms": 2.06}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 736.2038194818011, "policy_loss": -0.005959511330445944, "vf_loss": 736.2097744699252, "vf_explained_var": 0.21932047605514526, "kl": 0.011466305197931695, "entropy": 5.4047220440234165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 202500, "num_agent_steps_sampled": 202500, "num_steps_trained": 202500}, "done": false, "episodes_total": 270, "training_iteration": 27, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-58-40", "timestamp": 1693792720, "time_this_iter_s": 12.953515768051147, "time_total_s": 356.1018786430359, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 356.1018786430359, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.49444444444445, "ram_util_percent": 18.62777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.3895410562959, "episode_reward_min": 309.1359986682926, "episode_reward_mean": 464.98871838464964, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [493.9863464648311, 486.6504499965363, 430.36417886970696, 387.2670162378201, 443.25334757490424, 493.63349586546684, 492.8009477459552, 476.90153808941153, 466.32617387177265, 360.7002588974554, 507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.86103004007246, "mean_inference_ms": 0.7710109979192141, "mean_action_processing_ms": 0.07191762839118725, "mean_env_wait_ms": 4.543870182238833, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 210000, "agent_timesteps_total": 210000, "timers": {"sample_time_ms": 7361.909, "sample_throughput": 1018.757, "learn_time_ms": 5543.029, "learn_throughput": 1353.051, "update_time_ms": 2.109}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 743.9734107324632, "policy_loss": -0.005584518152873142, "vf_loss": 743.9789851560431, "vf_explained_var": 0.290853887796402, "kl": 0.01153353092865586, "entropy": 5.419230280084125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 210000, "num_agent_steps_sampled": 210000, "num_steps_trained": 210000}, "done": false, "episodes_total": 280, "training_iteration": 28, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-58-53", "timestamp": 1693792733, "time_this_iter_s": 12.696810245513916, "time_total_s": 368.7986888885498, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 368.7986888885498, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 26.977777777777774, "ram_util_percent": 18.62777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.3895410562959, "episode_reward_min": 309.1359986682926, "episode_reward_mean": 467.38935485526, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [507.785373192975, 443.82343186551645, 461.9662130985311, 374.7746528969457, 419.48118533735635, 358.54440360436035, 313.0364875666672, 397.98665531140955, 513.7955113893171, 463.1162104136543, 309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8739835850097406, "mean_inference_ms": 0.769355432216975, "mean_action_processing_ms": 0.07177557137421658, "mean_env_wait_ms": 4.503527467278639, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 217500, "agent_timesteps_total": 217500, "timers": {"sample_time_ms": 7231.589, "sample_throughput": 1037.116, "learn_time_ms": 5547.044, "learn_throughput": 1352.071, "update_time_ms": 2.141}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 799.0426907814156, "policy_loss": -0.007210872583564813, "vf_loss": 799.0498885849775, "vf_explained_var": 0.4228211045265198, "kl": 0.01312320631509083, "entropy": 5.699015781434916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 217500, "num_agent_steps_sampled": 217500, "num_steps_trained": 217500}, "done": false, "episodes_total": 290, "training_iteration": 29, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-59-05", "timestamp": 1693792745, "time_this_iter_s": 12.020224571228027, "time_total_s": 380.81891345977783, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 380.81891345977783, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 28.16111111111111, "ram_util_percent": 18.67777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.3895410562959, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 468.22649562394633, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.1359986682926, 501.61138989570867, 485.0955955587409, 495.9101149685117, 476.191588958151, 373.9772635261784, 501.9983701372624, 515.9601612040731, 475.6108528661745, 515.3616525387694, 499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8823994750723267, "mean_inference_ms": 0.7678022915127243, "mean_action_processing_ms": 0.07164038697111154, "mean_env_wait_ms": 4.465631475009861, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 225000, "agent_timesteps_total": 225000, "timers": {"sample_time_ms": 7189.632, "sample_throughput": 1043.169, "learn_time_ms": 5548.82, "learn_throughput": 1351.639, "update_time_ms": 2.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 815.7958310919292, "policy_loss": -0.010036820598278132, "vf_loss": 815.8058534783833, "vf_explained_var": 0.45028185844421387, "kl": 0.016828770701029196, "entropy": 5.927390238390131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 225000, "num_agent_steps_sampled": 225000, "num_steps_trained": 225000}, "done": false, "episodes_total": 300, "training_iteration": 30, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-59-18", "timestamp": 1693792758, "time_this_iter_s": 12.788514852523804, "time_total_s": 393.60742831230164, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 393.60742831230164, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 29.983333333333334, "ram_util_percent": 18.65555555555556}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 471.53499246417516, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [499.1449032068399, 459.5532754953582, 403.92780407861846, 492.06565766006975, 491.8372382102864, 460.04188832943566, 316.2842537770246, 342.73079910622386, 326.7950241624605, 406.57520280522215, 498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.891321010095639, "mean_inference_ms": 0.7662617994846552, "mean_action_processing_ms": 0.07151003589857499, "mean_env_wait_ms": 4.42976315251673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 232500, "agent_timesteps_total": 232500, "timers": {"sample_time_ms": 7137.792, "sample_throughput": 1050.745, "learn_time_ms": 5550.551, "learn_throughput": 1351.217, "update_time_ms": 2.168}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 811.7442588418216, "policy_loss": -0.007011854793813269, "vf_loss": 811.7512578156035, "vf_explained_var": 0.2615662217140198, "kl": 0.014706314851193456, "entropy": 5.50877644167108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 232500, "num_agent_steps_sampled": 232500, "num_steps_trained": 232500}, "done": false, "episodes_total": 310, "training_iteration": 31, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-59-30", "timestamp": 1693792770, "time_this_iter_s": 12.348993062973022, "time_total_s": 405.95642137527466, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 405.95642137527466, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 26.75, "ram_util_percent": 18.666666666666668}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 477.5897191954201, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [498.9437962946653, 515.4180178666118, 472.4403030600034, 326.377098754984, 517.7239120909092, 342.3603943209025, 423.2443815338464, 499.25422463076444, 513.8132847486406, 522.6757597589049, 483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.8992538504714918, "mean_inference_ms": 0.7649186206051424, "mean_action_processing_ms": 0.07139142858886123, "mean_env_wait_ms": 4.395586532329021, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 240000, "agent_timesteps_total": 240000, "timers": {"sample_time_ms": 7085.231, "sample_throughput": 1058.54, "learn_time_ms": 5548.663, "learn_throughput": 1351.677, "update_time_ms": 2.053}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 862.7074527287888, "policy_loss": -0.007022477015537225, "vf_loss": 862.7144610130181, "vf_explained_var": 0.4359499216079712, "kl": 0.015056583787224862, "entropy": 5.5221709946454585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 240000, "num_agent_steps_sampled": 240000, "num_steps_trained": 240000}, "done": false, "episodes_total": 320, "training_iteration": 32, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-59-42", "timestamp": 1693792782, "time_this_iter_s": 12.18960165977478, "time_total_s": 418.14602303504944, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 418.14602303504944, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 26.97647058823529, "ram_util_percent": 18.64117647058824}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 478.9779951563152, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.7883803996976, 497.8036609892194, 459.8355173197702, 498.24170630570575, 440.19718889621714, 346.0728913916709, 406.8734519412839, 483.5334791513257, 423.0225618576025, 498.34884004014833, 517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9039378328909193, "mean_inference_ms": 0.7636598239089328, "mean_action_processing_ms": 0.07128749957546683, "mean_env_wait_ms": 4.363474226166207, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 247500, "agent_timesteps_total": 247500, "timers": {"sample_time_ms": 6886.091, "sample_throughput": 1089.152, "learn_time_ms": 5544.77, "learn_throughput": 1352.626, "update_time_ms": 2.06}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 929.0512145996094, "policy_loss": -0.004366896523289004, "vf_loss": 929.0555702856032, "vf_explained_var": 0.39621782302856445, "kl": 0.011894144777662926, "entropy": 5.473474048355879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 247500, "num_agent_steps_sampled": 247500, "num_steps_trained": 247500}, "done": false, "episodes_total": 330, "training_iteration": 33, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_21-59-55", "timestamp": 1693792795, "time_this_iter_s": 12.280800342559814, "time_total_s": 430.42682337760925, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 430.42682337760925, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 26.444444444444443, "ram_util_percent": 18.705555555555552}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 479.38693368839535, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [517.8912342616691, 505.3179791954279, 525.4103434687786, 508.3630626442389, 405.76614119161593, 474.01872429834964, 490.7875238897131, 497.5884455898672, 521.7534641609953, 508.38159869160563, 487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9069038072781717, "mean_inference_ms": 0.7624769592606273, "mean_action_processing_ms": 0.07118968540694343, "mean_env_wait_ms": 4.333755623771138, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 255000, "agent_timesteps_total": 255000, "timers": {"sample_time_ms": 6883.083, "sample_throughput": 1089.628, "learn_time_ms": 5548.227, "learn_throughput": 1351.783, "update_time_ms": 2.104}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 856.8818761275986, "policy_loss": -0.005467900759303721, "vf_loss": 856.8873308084779, "vf_explained_var": 0.5121245384216309, "kl": 0.011611336593652983, "entropy": 5.6101790048308295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 255000, "num_agent_steps_sampled": 255000, "num_steps_trained": 255000}, "done": false, "episodes_total": 340, "training_iteration": 34, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-00-07", "timestamp": 1693792807, "time_this_iter_s": 12.268292903900146, "time_total_s": 442.6951162815094, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 442.6951162815094, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 27.170588235294115, "ram_util_percent": 18.688235294117646}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 479.7807842323892, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [487.7880457927749, 521.1354432533194, 524.2645934597075, 506.089848118494, 434.61507845859313, 517.1835233234073, 521.7559610586541, 410.11980450245363, 379.4135479766722, 512.1276192262297, 507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.908312019078082, "mean_inference_ms": 0.7613684330433428, "mean_action_processing_ms": 0.0711005662138661, "mean_env_wait_ms": 4.305939581755535, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 262500, "agent_timesteps_total": 262500, "timers": {"sample_time_ms": 6858.25, "sample_throughput": 1093.573, "learn_time_ms": 5549.722, "learn_throughput": 1351.419, "update_time_ms": 2.184}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 929.993811966201, "policy_loss": -0.0063017986115005056, "vf_loss": 930.0001100184554, "vf_explained_var": 0.3020800054073334, "kl": 0.01484934391462932, "entropy": 5.089612064523212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 262500, "num_agent_steps_sampled": 262500, "num_steps_trained": 262500}, "done": false, "episodes_total": 350, "training_iteration": 35, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-00-19", "timestamp": 1693792819, "time_this_iter_s": 11.967748403549194, "time_total_s": 454.6628646850586, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 454.6628646850586, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 28.58823529411765, "ram_util_percent": 18.64117647058824}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 479.13427306432243, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [507.1996426902686, 491.9660901089342, 355.8121235694031, 506.4939738964074, 523.7538503450472, 522.5625096415386, 528.3895410562959, 502.16693131727476, 515.7473974236902, 495.03212514290726, 523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9080752871707007, "mean_inference_ms": 0.7603921830485527, "mean_action_processing_ms": 0.07102313832079371, "mean_env_wait_ms": 4.28046207784914, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 270000, "agent_timesteps_total": 270000, "timers": {"sample_time_ms": 6780.483, "sample_throughput": 1106.116, "learn_time_ms": 5551.722, "learn_throughput": 1350.932, "update_time_ms": 2.218}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 896.0824145042291, "policy_loss": -0.005291073702244182, "vf_loss": 896.0876969676907, "vf_explained_var": 0.4900710880756378, "kl": 0.010168035736172547, "entropy": 5.302105104317099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 270000, "num_agent_steps_sampled": 270000, "num_steps_trained": 270000}, "done": false, "episodes_total": 360, "training_iteration": 36, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-00-31", "timestamp": 1693792831, "time_this_iter_s": 11.891079187393188, "time_total_s": 466.5539438724518, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 466.5539438724518, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 29.02941176470588, "ram_util_percent": 18.66470588235294}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 480.07165427986524, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [523.4311623654233, 524.748741083377, 360.3566428437311, 520.8573650511146, 512.3874906911182, 499.0682820157268, 500.51835426451595, 509.35256342639786, 509.60775901643837, 513.6755451559161, 510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9067204640862268, "mean_inference_ms": 0.7595224191391872, "mean_action_processing_ms": 0.07095390550254903, "mean_env_wait_ms": 4.256511354179733, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 277500, "agent_timesteps_total": 277500, "timers": {"sample_time_ms": 6878.316, "sample_throughput": 1090.383, "learn_time_ms": 5543.995, "learn_throughput": 1352.815, "update_time_ms": 2.381}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1104.876917072878, "policy_loss": -0.008151241701680346, "vf_loss": 1104.8850592144465, "vf_explained_var": 0.13134227693080902, "kl": 0.017346677129934544, "entropy": 5.096575902680219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 277500, "num_agent_steps_sampled": 277500, "num_steps_trained": 277500}, "done": false, "episodes_total": 370, "training_iteration": 37, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-00-45", "timestamp": 1693792845, "time_this_iter_s": 13.856294631958008, "time_total_s": 480.4102385044098, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 480.4102385044098, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 21.270000000000003, "ram_util_percent": 18.655000000000005}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 477.25600859681583, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.9933962241389, 518.4620511783843, 513.4524986943661, 525.1106815251891, 432.94736660295786, 421.3361038962847, 352.47219473891914, 498.9387222938235, 487.40690829276195, 510.82747722807386, 286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9047879114087714, "mean_inference_ms": 0.7587396896710478, "mean_action_processing_ms": 0.07089065664444762, "mean_env_wait_ms": 4.234282188442552, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 285000, "agent_timesteps_total": 285000, "timers": {"sample_time_ms": 7002.708, "sample_throughput": 1071.014, "learn_time_ms": 5543.085, "learn_throughput": 1353.037, "update_time_ms": 2.351}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1090.1188424320544, "policy_loss": -0.007065519790749176, "vf_loss": 1090.1258923546743, "vf_explained_var": 0.3517628312110901, "kl": 0.013195812590304999, "entropy": 5.344986120320983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 285000, "num_agent_steps_sampled": 285000, "num_steps_trained": 285000}, "done": false, "episodes_total": 380, "training_iteration": 38, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-00-59", "timestamp": 1693792859, "time_this_iter_s": 13.932630062103271, "time_total_s": 494.34286856651306, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 494.34286856651306, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 23.674999999999997, "ram_util_percent": 18.665000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 286.5880568262835, "episode_reward_mean": 479.04282780694024, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.5880568262835, 478.2017806872968, 342.41330563727877, 517.8652773529715, 387.3747065339793, 522.0286967150471, 521.2525383788684, 476.51941222718233, 334.9945998511534, 470.78582733529686, 514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9066809900751878, "mean_inference_ms": 0.7578644315825736, "mean_action_processing_ms": 0.07082303890037124, "mean_env_wait_ms": 4.212815173467096, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 292500, "agent_timesteps_total": 292500, "timers": {"sample_time_ms": 7082.393, "sample_throughput": 1058.964, "learn_time_ms": 5543.654, "learn_throughput": 1352.898, "update_time_ms": 2.277}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1067.5428640591897, "policy_loss": -0.0064811649779647085, "vf_loss": 1067.5493353892182, "vf_explained_var": 0.19934909045696259, "kl": 0.013549431037109491, "entropy": 5.117922417592194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 292500, "num_agent_steps_sampled": 292500, "num_steps_trained": 292500}, "done": false, "episodes_total": 390, "training_iteration": 39, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-01-12", "timestamp": 1693792872, "time_this_iter_s": 12.82182240486145, "time_total_s": 507.1646909713745, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 507.1646909713745, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.742105263157892, "ram_util_percent": 18.69473684210526}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 530.9859798301113, "episode_reward_min": 340.4142939893545, "episode_reward_mean": 482.7912956468434, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.577211672542, 485.88230362238505, 472.17985722979677, 530.9859798301113, 509.3119651831842, 506.29725331053936, 527.590615650966, 466.0089203349126, 469.67067939091424, 499.1978861194077, 417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.907739006704835, "mean_inference_ms": 0.757071321674261, "mean_action_processing_ms": 0.07076217501637469, "mean_env_wait_ms": 4.191722595628343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 300000, "agent_timesteps_total": 300000, "timers": {"sample_time_ms": 7003.293, "sample_throughput": 1070.925, "learn_time_ms": 5543.722, "learn_throughput": 1352.882, "update_time_ms": 2.384}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1045.3139892060879, "policy_loss": -0.006033806257754943, "vf_loss": 1045.320015651897, "vf_explained_var": 0.3281243145465851, "kl": 0.011194100129066563, "entropy": 5.313115840039011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 300000, "num_agent_steps_sampled": 300000, "num_steps_trained": 300000}, "done": false, "episodes_total": 400, "training_iteration": 40, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-01-24", "timestamp": 1693792884, "time_this_iter_s": 11.99885869026184, "time_total_s": 519.1635496616364, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 519.1635496616364, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 26.670588235294115, "ram_util_percent": 18.741176470588233}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 480.95709232493755, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [417.0404203694803, 480.437757571225, 496.0085524274194, 503.4605864133849, 340.4142939893545, 523.5206283079397, 508.6356988338106, 519.0756416458643, 508.4388648068618, 507.3962755906909, 529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9078123689542603, "mean_inference_ms": 0.7563955929917485, "mean_action_processing_ms": 0.07071064202305914, "mean_env_wait_ms": 4.172090854754862, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 307500, "agent_timesteps_total": 307500, "timers": {"sample_time_ms": 6998.831, "sample_throughput": 1071.608, "learn_time_ms": 5550.202, "learn_throughput": 1351.302, "update_time_ms": 2.34}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1235.894259747004, "policy_loss": -0.0055053876278827255, "vf_loss": 1235.8997539455609, "vf_explained_var": 0.38051360845565796, "kl": 0.013224683814588297, "entropy": 5.339608609474311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 307500, "num_agent_steps_sampled": 307500, "num_steps_trained": 307500}, "done": false, "episodes_total": 410, "training_iteration": 41, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-01-36", "timestamp": 1693792896, "time_this_iter_s": 12.36865782737732, "time_total_s": 531.5322074890137, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 531.5322074890137, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 26.000000000000004, "ram_util_percent": 18.738888888888887}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 482.34397081388016, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [529.519467241522, 516.3229404730048, 342.24150703677, 467.58537522845893, 515.6791301008764, 498.51871450543155, 393.78796272165766, 475.935046684539, 515.0188653904091, 516.4697597670728, 427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9101345297422405, "mean_inference_ms": 0.755629571734008, "mean_action_processing_ms": 0.0706554095573217, "mean_env_wait_ms": 4.153269346456688, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 315000, "agent_timesteps_total": 315000, "timers": {"sample_time_ms": 7179.092, "sample_throughput": 1044.7, "learn_time_ms": 5549.575, "learn_throughput": 1351.455, "update_time_ms": 2.358}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1131.5454448635296, "policy_loss": -0.005977379379920282, "vf_loss": 1131.5514114638506, "vf_explained_var": 0.33679094910621643, "kl": 0.01327948303707862, "entropy": 5.163357495453398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 315000, "num_agent_steps_sampled": 315000, "num_steps_trained": 315000}, "done": false, "episodes_total": 420, "training_iteration": 42, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-01-50", "timestamp": 1693792910, "time_this_iter_s": 13.986134767532349, "time_total_s": 545.518342256546, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 545.518342256546, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 23.07, "ram_util_percent": 18.699999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 483.32394681182353, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [427.506958429244, 499.4957437722441, 479.0110394725015, 512.7518640543201, 428.27487929623396, 393.3458178548624, 503.7442408056587, 463.75664631217495, 500.4839706003267, 370.2403709030835, 519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.913250031630982, "mean_inference_ms": 0.7548777295558289, "mean_action_processing_ms": 0.07060111241660554, "mean_env_wait_ms": 4.1354684176976, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 322500, "agent_timesteps_total": 322500, "timers": {"sample_time_ms": 7266.472, "sample_throughput": 1032.138, "learn_time_ms": 5550.226, "learn_throughput": 1351.296, "update_time_ms": 2.366}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1076.2129246598583, "policy_loss": -0.007633501696163568, "vf_loss": 1076.220545985335, "vf_explained_var": 0.437056303024292, "kl": 0.016091362378426625, "entropy": 5.157395261020984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 322500, "num_agent_steps_sampled": 322500, "num_steps_trained": 322500}, "done": false, "episodes_total": 430, "training_iteration": 43, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-02-04", "timestamp": 1693792924, "time_this_iter_s": 13.162213802337646, "time_total_s": 558.6805560588837, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 558.6805560588837, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 27.08888888888889, "ram_util_percent": 18.722222222222218}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 484.906734537975, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [519.0813963371512, 516.1063980852635, 516.2144780568683, 523.3220044486311, 519.052559358317, 494.1955910702633, 516.8517638817361, 495.6271024647549, 385.6159927669415, 508.5962853217106, 468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9164910571265574, "mean_inference_ms": 0.7540592205920724, "mean_action_processing_ms": 0.07054105650456671, "mean_env_wait_ms": 4.1182553396888055, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 330000, "agent_timesteps_total": 330000, "timers": {"sample_time_ms": 7278.349, "sample_throughput": 1030.454, "learn_time_ms": 5552.331, "learn_throughput": 1350.784, "update_time_ms": 2.297}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1147.7719233626026, "policy_loss": -0.008420878681906704, "vf_loss": 1147.7803377830376, "vf_explained_var": 0.43758121132850647, "kl": 0.013529698139452352, "entropy": 5.239000993663982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 330000, "num_agent_steps_sampled": 330000, "num_steps_trained": 330000}, "done": false, "episodes_total": 440, "training_iteration": 44, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-02-16", "timestamp": 1693792936, "time_this_iter_s": 12.407642841339111, "time_total_s": 571.0881989002228, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 571.0881989002228, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 25.188888888888886, "ram_util_percent": 18.738888888888887}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 482.6784319888372, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.43009857520093, 528.136930284421, 396.98236376746706, 416.51051408128376, 469.19922151495234, 441.4958449621093, 513.2493203144458, 511.9817336760756, 489.5696850399428, 514.2866361477332, 507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.920383992777245, "mean_inference_ms": 0.753299732500546, "mean_action_processing_ms": 0.07048568158157593, "mean_env_wait_ms": 4.102272634692242, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 337500, "agent_timesteps_total": 337500, "timers": {"sample_time_ms": 7316.424, "sample_throughput": 1025.091, "learn_time_ms": 5552.935, "learn_throughput": 1350.637, "update_time_ms": 2.208}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1178.2005533509334, "policy_loss": -0.007770059549375989, "vf_loss": 1178.2083079709846, "vf_explained_var": 0.3755718171596527, "kl": 0.015909958417537663, "entropy": 5.091184242701126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 337500, "num_agent_steps_sampled": 337500, "num_steps_trained": 337500}, "done": false, "episodes_total": 450, "training_iteration": 45, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-02-28", "timestamp": 1693792948, "time_this_iter_s": 12.352905511856079, "time_total_s": 583.4411044120789, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 583.4411044120789, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.64444444444444, "ram_util_percent": 18.727777777777774}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 483.6778807367722, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [507.4699184094999, 514.1738065724154, 505.0583528596537, 490.47664447765817, 518.6288578380096, 445.29949032606675, 515.6846528687275, 517.3234309721535, 499.9163240254294, 528.8308283964451, 518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.940899565419129, "mean_inference_ms": 0.7525884785188333, "mean_action_processing_ms": 0.07043318907387443, "mean_env_wait_ms": 4.087320528497416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 345000, "agent_timesteps_total": 345000, "timers": {"sample_time_ms": 7987.119, "sample_throughput": 939.012, "learn_time_ms": 5549.399, "learn_throughput": 1351.498, "update_time_ms": 2.186}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1117.170884782177, "policy_loss": -0.005902685960596901, "vf_loss": 1117.1767762264963, "vf_explained_var": 0.4267156422138214, "kl": 0.013186731367755403, "entropy": 4.915620270421949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 345000, "num_agent_steps_sampled": 345000, "num_steps_trained": 345000}, "done": false, "episodes_total": 460, "training_iteration": 46, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-02-47", "timestamp": 1693792967, "time_this_iter_s": 18.562771558761597, "time_total_s": 602.0038759708405, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 602.0038759708405, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 20.43846153846154, "ram_util_percent": 18.599999999999998}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 529.7779848440831, "episode_reward_min": 339.1989037112497, "episode_reward_mean": 482.6776133819631, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.486210905987, 522.6213315108697, 368.9201010949611, 412.56819746500423, 469.10871382261325, 428.71995970211697, 529.7779848440831, 478.3542125978653, 445.7774686367743, 518.1051570285375, 515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9602193348378143, "mean_inference_ms": 0.7519420601758212, "mean_action_processing_ms": 0.0703865754315456, "mean_env_wait_ms": 4.073414897858254, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 352500, "agent_timesteps_total": 352500, "timers": {"sample_time_ms": 7817.632, "sample_throughput": 959.37, "learn_time_ms": 5554.902, "learn_throughput": 1350.159, "update_time_ms": 2.107}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1241.6839979268736, "policy_loss": -0.005598092563766039, "vf_loss": 1241.6895876092426, "vf_explained_var": 0.3482305705547333, "kl": 0.012320933532443033, "entropy": 4.804652575315055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 352500, "num_agent_steps_sampled": 352500, "num_steps_trained": 352500}, "done": false, "episodes_total": 470, "training_iteration": 47, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-02-59", "timestamp": 1693792979, "time_this_iter_s": 12.215662479400635, "time_total_s": 614.2195384502411, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 614.2195384502411, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.588888888888892, "ram_util_percent": 18.73333333333333}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 482.236863083469, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.7083032099908, 492.75697759822305, 452.6956033755028, 517.3742499757606, 490.5385890346881, 500.6324230942834, 528.080257005526, 452.6794148556469, 478.6351321289118, 521.5283714088118, 443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.976913245284382, "mean_inference_ms": 0.7513079010262875, "mean_action_processing_ms": 0.07034120961640909, "mean_env_wait_ms": 4.060186026671004, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 360000, "agent_timesteps_total": 360000, "timers": {"sample_time_ms": 7613.684, "sample_throughput": 985.068, "learn_time_ms": 5560.365, "learn_throughput": 1348.832, "update_time_ms": 2.097}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1190.2971933138572, "policy_loss": -0.00426671764245099, "vf_loss": 1190.3014492228879, "vf_explained_var": 0.49014055728912354, "kl": 0.01034909368507961, "entropy": 4.997806814161398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 360000, "num_agent_steps_sampled": 360000, "num_steps_trained": 360000}, "done": false, "episodes_total": 480, "training_iteration": 48, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-03-11", "timestamp": 1693792991, "time_this_iter_s": 11.946645259857178, "time_total_s": 626.1661837100983, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 626.1661837100983, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 26.841176470588238, "ram_util_percent": 18.764705882352942}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 482.012712141506, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.0928189217252, 490.37244469952367, 480.50979123819076, 388.2435542835403, 521.4007107873206, 447.85429843283254, 520.6408447574722, 512.0302626270935, 503.9802331479722, 404.7460266400035, 518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.9910898868358764, "mean_inference_ms": 0.7507381570211037, "mean_action_processing_ms": 0.07030067587919495, "mean_env_wait_ms": 4.0479196350163225, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 367500, "agent_timesteps_total": 367500, "timers": {"sample_time_ms": 7562.683, "sample_throughput": 991.712, "learn_time_ms": 5559.34, "learn_throughput": 1349.081, "update_time_ms": 2.097}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1311.965165477688, "policy_loss": -0.00813302271525865, "vf_loss": 1311.9732833086434, "vf_explained_var": 0.22833497822284698, "kl": 0.01488216790608721, "entropy": 4.844435246516082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 367500, "num_agent_steps_sampled": 367500, "num_steps_trained": 367500}, "done": false, "episodes_total": 490, "training_iteration": 49, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-03-24", "timestamp": 1693793004, "time_this_iter_s": 12.301370620727539, "time_total_s": 638.4675543308258, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 638.4675543308258, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 28.76666666666667, "ram_util_percent": 18.755555555555553}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 484.6787079741756, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.9450551972709, 495.91656866235877, 510.83838624394, 382.4172086744321, 519.538254228762, 508.4554403613744, 481.79484720424284, 519.9017168130883, 521.2759590574501, 339.1989037112497, 514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.005620173874633, "mean_inference_ms": 0.7501850493906145, "mean_action_processing_ms": 0.07026175910841778, "mean_env_wait_ms": 4.036057262457262, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 375000, "agent_timesteps_total": 375000, "timers": {"sample_time_ms": 7569.756, "sample_throughput": 990.785, "learn_time_ms": 5559.545, "learn_throughput": 1349.031, "update_time_ms": 1.985}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1150.6813551563328, "policy_loss": -0.006259836685563579, "vf_loss": 1150.687601949401, "vf_explained_var": 0.3578840494155884, "kl": 0.01459143694537494, "entropy": 4.659279919478853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 375000, "num_agent_steps_sampled": 375000, "num_steps_trained": 375000}, "done": false, "episodes_total": 500, "training_iteration": 50, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-03-36", "timestamp": 1693793016, "time_this_iter_s": 12.070120334625244, "time_total_s": 650.537674665451, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 650.537674665451, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 25.952941176470592, "ram_util_percent": 18.764705882352942}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 484.7163566890511, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.7281010154368, 525.3913601541992, 515.8526246999651, 517.7385677349347, 384.90155627347656, 464.010305828011, 527.7045307358169, 508.9506309321348, 456.5888090588214, 527.2500824174895, 470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0200490969676475, "mean_inference_ms": 0.7496199864381851, "mean_action_processing_ms": 0.07022160499473318, "mean_env_wait_ms": 4.024549843934048, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 382500, "agent_timesteps_total": 382500, "timers": {"sample_time_ms": 7568.968, "sample_throughput": 990.888, "learn_time_ms": 5554.435, "learn_throughput": 1350.272, "update_time_ms": 2.019}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1315.640242185431, "policy_loss": -0.006801036371991543, "vf_loss": 1315.6470274327164, "vf_explained_var": 0.28131192922592163, "kl": 0.015027689869051735, "entropy": 4.761831684435828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 382500, "num_agent_steps_sampled": 382500, "num_steps_trained": 382500}, "done": false, "episodes_total": 510, "training_iteration": 51, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-03-48", "timestamp": 1693793028, "time_this_iter_s": 12.310929775238037, "time_total_s": 662.8486044406891, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 662.8486044406891, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 25.866666666666664, "ram_util_percent": 18.738888888888887}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 484.5350850031006, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0846707246291, 494.85546202457834, 518.8060406366068, 455.3857802804031, 510.67932865741864, 523.8854214772396, 407.6410336943785, 514.0155140885876, 514.2638780557807, 459.4592393044596, 506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.032877372470422, "mean_inference_ms": 0.749062617293057, "mean_action_processing_ms": 0.07018123813481905, "mean_env_wait_ms": 4.013710861473453, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 390000, "agent_timesteps_total": 390000, "timers": {"sample_time_ms": 7408.036, "sample_throughput": 1012.414, "learn_time_ms": 5552.577, "learn_throughput": 1350.724, "update_time_ms": 2.026}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1360.2754524360269, "policy_loss": -0.005797682075082498, "vf_loss": 1360.2812372239969, "vf_explained_var": 0.2329217493534088, "kl": 0.014176915572340035, "entropy": 4.52784368304883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 390000, "num_agent_steps_sampled": 390000, "num_steps_trained": 390000}, "done": false, "episodes_total": 520, "training_iteration": 52, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-04-01", "timestamp": 1693793041, "time_this_iter_s": 12.357003211975098, "time_total_s": 675.2056076526642, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 675.2056076526642, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 28.935294117647054, "ram_util_percent": 18.735294117647054}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.5932407466325, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 484.7107375931402, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.5077590594246, 528.5932407466325, 428.96451392764766, 515.2543840718965, 448.0789467942441, 459.57364419807385, 480.3125480359148, 354.51785848257845, 523.5858670040002, 491.501541795389, 457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.044776537911738, "mean_inference_ms": 0.7485222534311384, "mean_action_processing_ms": 0.0701420566559503, "mean_env_wait_ms": 4.0033145323739285, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 397500, "agent_timesteps_total": 397500, "timers": {"sample_time_ms": 7379.216, "sample_throughput": 1016.368, "learn_time_ms": 5552.29, "learn_throughput": 1350.794, "update_time_ms": 2.035}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1292.633476748709, "policy_loss": -0.00578640418963791, "vf_loss": 1292.639254967641, "vf_explained_var": 0.45977598428726196, "kl": 0.012668649828647561, "entropy": 4.5439113818993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 397500, "num_agent_steps_sampled": 397500, "num_steps_trained": 397500}, "done": false, "episodes_total": 530, "training_iteration": 53, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-04-14", "timestamp": 1693793054, "time_this_iter_s": 12.871090412139893, "time_total_s": 688.0766980648041, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 688.0766980648041, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 28.668421052631583, "ram_util_percent": 18.72631578947368}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.2692750800692, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 485.789156526536, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [457.41523757045275, 430.4155514090912, 489.1482923354632, 386.0075742610213, 520.5333509066529, 503.0811969225678, 448.5940958378288, 493.70967732042743, 521.6234668643666, 521.304873449988, 461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.056139269299038, "mean_inference_ms": 0.7479979614550587, "mean_action_processing_ms": 0.0701024625649273, "mean_env_wait_ms": 3.993269654254939, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 405000, "agent_timesteps_total": 405000, "timers": {"sample_time_ms": 7347.456, "sample_throughput": 1020.761, "learn_time_ms": 5553.948, "learn_throughput": 1350.391, "update_time_ms": 2.135}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1524.2837701312567, "policy_loss": -0.005330089395234393, "vf_loss": 1524.2890933279264, "vf_explained_var": 0.22669954597949982, "kl": 0.014662071390903053, "entropy": 4.413384580612183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 405000, "num_agent_steps_sampled": 405000, "num_steps_trained": 405000}, "done": false, "episodes_total": 540, "training_iteration": 54, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-04-26", "timestamp": 1693793066, "time_this_iter_s": 12.107323169708252, "time_total_s": 700.1840212345123, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 700.1840212345123, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 28.01764705882353, "ram_util_percent": 18.77647058823529}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 528.2692750800692, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 487.4507356797126, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [461.40192022093265, 428.44406088815, 470.535144237874, 485.80527015538433, 528.2692750800692, 485.66945199230236, 506.0931717914122, 500.28121153534283, 512.6907036646376, 470.59701359102564, 522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.067427771642503, "mean_inference_ms": 0.7474764658576573, "mean_action_processing_ms": 0.07006351413305141, "mean_env_wait_ms": 3.9834313027849935, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 412500, "agent_timesteps_total": 412500, "timers": {"sample_time_ms": 7372.446, "sample_throughput": 1017.301, "learn_time_ms": 5552.298, "learn_throughput": 1350.792, "update_time_ms": 2.118}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1415.8715388411183, "policy_loss": -0.005442164146925433, "vf_loss": 1415.8769654354808, "vf_explained_var": 0.17628233134746552, "kl": 0.014715944774175416, "entropy": 4.238573019383318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 412500, "num_agent_steps_sampled": 412500, "num_steps_trained": 412500}, "done": false, "episodes_total": 550, "training_iteration": 55, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-04-38", "timestamp": 1693793078, "time_this_iter_s": 12.586330652236938, "time_total_s": 712.7703518867493, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 712.7703518867493, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 27.766666666666666, "ram_util_percent": 18.738888888888887}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 487.39618092430436, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [522.192995201513, 486.8451324363043, 513.8550525979371, 491.49554902020384, 519.4644624241489, 520.3826089976145, 397.60411384517954, 472.76606698947205, 510.44142786629374, 507.7881618864848, 472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.064589272952016, "mean_inference_ms": 0.7469632289552288, "mean_action_processing_ms": 0.07002538749579451, "mean_env_wait_ms": 3.973581129122981, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 420000, "agent_timesteps_total": 420000, "timers": {"sample_time_ms": 6908.353, "sample_throughput": 1085.642, "learn_time_ms": 5553.009, "learn_throughput": 1350.619, "update_time_ms": 2.126}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1525.4833645578158, "policy_loss": -0.006766002146937585, "vf_loss": 1525.4901270979542, "vf_explained_var": 0.20815010368824005, "kl": 0.016483436470975138, "entropy": 4.311052711131209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 420000, "num_agent_steps_sampled": 420000, "num_steps_trained": 420000}, "done": false, "episodes_total": 560, "training_iteration": 56, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-04-52", "timestamp": 1693793092, "time_this_iter_s": 13.927951574325562, "time_total_s": 726.6983034610748, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 726.6983034610748, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 22.14, "ram_util_percent": 18.74}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 312.8491757597445, "episode_reward_mean": 486.7881789731515, "episode_len_mean": 748.5, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [472.3587050425647, 417.7086173026277, 514.9554151196663, 505.71040961939485, 471.90375269365967, 475.63068926728744, 465.4295524304704, 511.36295794402724, 500.45503257996705, 312.8491757597445, 524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 600, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.0614374935442115, "mean_inference_ms": 0.7465029741118383, "mean_action_processing_ms": 0.06999040554588501, "mean_env_wait_ms": 3.964236489085098, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 427500, "agent_timesteps_total": 427500, "timers": {"sample_time_ms": 6928.121, "sample_throughput": 1082.545, "learn_time_ms": 5552.372, "learn_throughput": 1350.774, "update_time_ms": 2.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1194.522198693227, "policy_loss": -0.007006812280328092, "vf_loss": 1194.52919921875, "vf_explained_var": 0.37177208065986633, "kl": 0.014397619131578809, "entropy": 4.154205220028506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 427500, "num_agent_steps_sampled": 427500, "num_steps_trained": 427500}, "done": false, "episodes_total": 570, "training_iteration": 57, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-05-05", "timestamp": 1693793105, "time_this_iter_s": 12.407409906387329, "time_total_s": 739.1057133674622, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 739.1057133674622, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 26.200000000000003, "ram_util_percent": 18.75555555555555}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 317.3518395403352, "episode_reward_mean": 489.39989543630827, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [524.0486795509053, 455.470714599136, 446.4233793640522, 425.149327109062, 477.3504813303012, 527.0475080013637, 521.6561402784791, 516.7834584631115, 523.9181141991411, 510.36642459547414, 512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.059030575624093, "mean_inference_ms": 0.7460419109495899, "mean_action_processing_ms": 0.06995459642551738, "mean_env_wait_ms": 3.9550689553773974, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 435000, "agent_timesteps_total": 435000, "timers": {"sample_time_ms": 6958.943, "sample_throughput": 1077.75, "learn_time_ms": 5550.542, "learn_throughput": 1351.219, "update_time_ms": 2.155}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1391.8022047657078, "policy_loss": -0.006826699522750105, "vf_loss": 1391.8090143236063, "vf_explained_var": 0.2810317873954773, "kl": 0.01312744653179409, "entropy": 4.183080955279076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 435000, "num_agent_steps_sampled": 435000, "num_steps_trained": 435000}, "done": false, "episodes_total": 580, "training_iteration": 58, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-05-17", "timestamp": 1693793117, "time_this_iter_s": 12.235934972763062, "time_total_s": 751.3416483402252, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 751.3416483402252, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 18.79444444444444}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 317.3518395403352, "episode_reward_mean": 487.87167267382034, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [512.8205042345661, 510.516919173789, 512.6686776649481, 469.59511936302374, 489.6846376152057, 503.9941713237337, 504.4055206733643, 459.0787206831447, 510.9392897090414, 505.7670083618268, 335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.068217685244349, "mean_inference_ms": 0.745624418758092, "mean_action_processing_ms": 0.06992218361940235, "mean_env_wait_ms": 3.9461530501590287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 442500, "agent_timesteps_total": 442500, "timers": {"sample_time_ms": 7458.599, "sample_throughput": 1005.551, "learn_time_ms": 5545.81, "learn_throughput": 1352.372, "update_time_ms": 2.18}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1372.52896128509, "policy_loss": -0.004639473216513456, "vf_loss": 1372.5335849567996, "vf_explained_var": 0.2645765244960785, "kl": 0.011841838194922646, "entropy": 4.19706856759928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 442500, "num_agent_steps_sampled": 442500, "num_steps_trained": 442500}, "done": false, "episodes_total": 590, "training_iteration": 59, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-05-35", "timestamp": 1693793135, "time_this_iter_s": 17.251258373260498, "time_total_s": 768.5929067134857, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 768.5929067134857, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.6, "ram_util_percent": 18.625}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 317.3518395403352, "episode_reward_mean": 483.56131745226486, "episode_len_mean": 747.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.8349051372077, 480.14545698463803, 476.59446391463473, 522.2726952123389, 504.9120616149809, 474.7492879779853, 487.0303803825705, 499.81135451501007, 499.9537285289317, 520.7428773734075, 516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.077251276759816, "mean_inference_ms": 0.7452417814617643, "mean_action_processing_ms": 0.06989149200885968, "mean_env_wait_ms": 3.9377210970550056, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 450000, "agent_timesteps_total": 450000, "timers": {"sample_time_ms": 7469.046, "sample_throughput": 1004.144, "learn_time_ms": 5543.007, "learn_throughput": 1353.056, "update_time_ms": 2.196}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1395.9167746333753, "policy_loss": -0.0064964020155149245, "vf_loss": 1395.9232611187433, "vf_explained_var": 0.25485101342201233, "kl": 0.014568881957687118, "entropy": 4.218396514149036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 450000, "num_agent_steps_sampled": 450000, "num_steps_trained": 450000}, "done": false, "episodes_total": 600, "training_iteration": 60, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-05-47", "timestamp": 1693793147, "time_this_iter_s": 12.147805452346802, "time_total_s": 780.7407121658325, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 780.7407121658325, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.26111111111111, "ram_util_percent": 18.766666666666666}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 482.2093051528591, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [516.886033540548, 520.5289551063497, 497.46726694880664, 503.1082675269646, 449.8224193834672, 422.40043322276597, 494.7908075390928, 475.21489861198387, 521.7643558447564, 523.0059625305004, 499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.085271295319774, "mean_inference_ms": 0.7447452939952628, "mean_action_processing_ms": 0.069851704600442, "mean_env_wait_ms": 3.9291716162968293, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 457500, "agent_timesteps_total": 457500, "timers": {"sample_time_ms": 7450.608, "sample_throughput": 1006.629, "learn_time_ms": 5543.265, "learn_throughput": 1352.993, "update_time_ms": 2.177}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1380.8287478172174, "policy_loss": -0.0031956927803487092, "vf_loss": 1380.8319409903834, "vf_explained_var": 0.22694513201713562, "kl": 0.012408318030824357, "entropy": 4.043808065430593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 457500, "num_agent_steps_sampled": 457500, "num_steps_trained": 457500}, "done": false, "episodes_total": 610, "training_iteration": 61, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-05-59", "timestamp": 1693793159, "time_this_iter_s": 12.128847122192383, "time_total_s": 792.8695592880249, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 792.8695592880249, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 25.123529411764707, "ram_util_percent": 18.747058823529407}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 480.0895547297634, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [499.28832619165314, 497.4437045318589, 518.3902124373328, 503.8972963548379, 504.7466606161999, 376.24062808220634, 507.80298892224084, 461.7911973154581, 504.25086072407635, 512.7897527722112, 511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.091875127593976, "mean_inference_ms": 0.7441853672866118, "mean_action_processing_ms": 0.06980786707248945, "mean_env_wait_ms": 3.9206533979695526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 465000, "agent_timesteps_total": 465000, "timers": {"sample_time_ms": 7428.608, "sample_throughput": 1009.61, "learn_time_ms": 5544.615, "learn_throughput": 1352.664, "update_time_ms": 2.169}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1408.2002097954185, "policy_loss": -0.007375833180622529, "vf_loss": 1408.2075670662573, "vf_explained_var": 0.4682447910308838, "kl": 0.015766391460041614, "entropy": 4.1974944490497395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 465000, "num_agent_steps_sampled": 465000, "num_steps_trained": 465000}, "done": false, "episodes_total": 620, "training_iteration": 62, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-06-11", "timestamp": 1693793171, "time_this_iter_s": 12.15048098564148, "time_total_s": 805.0200402736664, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 805.0200402736664, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 25.572222222222223, "ram_util_percent": 18.777777777777775}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 480.7046898496668, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [511.7957377786366, 498.3408652684712, 516.5801900392454, 511.1915705913467, 467.4795481601175, 491.20937249204684, 514.7413003700558, 521.2452346134646, 494.7965386016388, 317.3518395403352, 525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.098462127137838, "mean_inference_ms": 0.7436441192238911, "mean_action_processing_ms": 0.06976733077656677, "mean_env_wait_ms": 3.9120973079073837, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 472500, "agent_timesteps_total": 472500, "timers": {"sample_time_ms": 7354.625, "sample_throughput": 1019.766, "learn_time_ms": 5547.956, "learn_throughput": 1351.849, "update_time_ms": 2.143}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1313.327459147825, "policy_loss": -0.007127435242173152, "vf_loss": 1313.3345755366956, "vf_explained_var": 0.3337085545063019, "kl": 0.015019419719736474, "entropy": 3.924789884534933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 472500, "num_agent_steps_sampled": 472500, "num_steps_trained": 472500}, "done": false, "episodes_total": 630, "training_iteration": 63, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-06-23", "timestamp": 1693793183, "time_this_iter_s": 12.162904977798462, "time_total_s": 817.1829452514648, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 817.1829452514648, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 25.93529411764706, "ram_util_percent": 18.741176470588233}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 480.59899254348346, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [525.8886873358794, 511.04514029868653, 518.4844045825218, 523.2458673272741, 368.36105057510616, 492.79711829091707, 469.65079338601635, 517.1562863490915, 513.5125614584306, 497.8493225915903, 498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.106429869024634, "mean_inference_ms": 0.7431173984537733, "mean_action_processing_ms": 0.06972805429626037, "mean_env_wait_ms": 3.9036882010638925, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 480000, "agent_timesteps_total": 480000, "timers": {"sample_time_ms": 7419.629, "sample_throughput": 1010.832, "learn_time_ms": 5545.201, "learn_throughput": 1352.521, "update_time_ms": 2.054}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1354.1933534783832, "policy_loss": -0.006035014226148694, "vf_loss": 1354.1993842690679, "vf_explained_var": 0.3796195983886719, "kl": 0.01521996223998917, "entropy": 3.9416241625608026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 480000, "num_agent_steps_sampled": 480000, "num_steps_trained": 480000}, "done": false, "episodes_total": 640, "training_iteration": 64, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-06-36", "timestamp": 1693793196, "time_this_iter_s": 12.729250192642212, "time_total_s": 829.912195444107, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 829.912195444107, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 23.83888888888889, "ram_util_percent": 18.749999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 534.1377573434725, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 478.5102370215427, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [498.6715669742406, 510.26412252607025, 336.92346348921535, 520.3516334389534, 534.1377573434725, 515.8209488245825, 430.6272860654957, 501.7178835307903, 512.7250693404345, 483.0920160830586, 488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.123395808974827, "mean_inference_ms": 0.742575368156033, "mean_action_processing_ms": 0.0696870017765517, "mean_env_wait_ms": 3.8955553378992636, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 487500, "agent_timesteps_total": 487500, "timers": {"sample_time_ms": 7879.987, "sample_throughput": 951.778, "learn_time_ms": 5547.325, "learn_throughput": 1352.003, "update_time_ms": 2.063}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1464.055830409163, "policy_loss": -0.005977837997883306, "vf_loss": 1464.0617957680913, "vf_explained_var": 0.24514517188072205, "kl": 0.01407401640883302, "entropy": 4.006068045001919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 487500, "num_agent_steps_sampled": 487500, "num_steps_trained": 487500}, "done": false, "episodes_total": 650, "training_iteration": 65, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-06-54", "timestamp": 1693793214, "time_this_iter_s": 17.211400985717773, "time_total_s": 847.1235964298248, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 847.1235964298248, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 20.156, "ram_util_percent": 18.676}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.1993718382411, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 475.67503395445476, "episode_len_mean": 742.31, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [488.0318567956075, 495.3287724799044, 471.84754520360957, 492.276275089101, 512.154002066722, 485.2865611955602, 516.4162774500526, 516.5655335391007, 438.28595581923514, 465.84259651098563, 515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.139232704370947, "mean_inference_ms": 0.7420077677808732, "mean_action_processing_ms": 0.06964359391614386, "mean_env_wait_ms": 3.887679370985625, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 495000, "agent_timesteps_total": 495000, "timers": {"sample_time_ms": 7760.91, "sample_throughput": 966.382, "learn_time_ms": 5549.511, "learn_throughput": 1351.47, "update_time_ms": 2.055}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1525.4033056226826, "policy_loss": -0.007530464799640605, "vf_loss": 1525.4108198262877, "vf_explained_var": 0.17796917259693146, "kl": 0.01347312963239895, "entropy": 4.04387095459437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 495000, "num_agent_steps_sampled": 495000, "num_steps_trained": 495000}, "done": false, "episodes_total": 660, "training_iteration": 66, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-07-06", "timestamp": 1693793226, "time_this_iter_s": 12.759167671203613, "time_total_s": 859.8827641010284, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 859.8827641010284, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 24.461111111111112, "ram_util_percent": 18.816666666666663}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.1993718382411, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 471.5294432284945, "episode_len_mean": 739.37, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.7563828439091, 470.2968404180332, 487.54438506162944, 459.0958056549915, 510.362829975244, 494.57713601660004, 458.96588774611575, 523.1993718382411, 492.3822891238791, 497.3550253964352, 485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.155493045356758, "mean_inference_ms": 0.7413680868179178, "mean_action_processing_ms": 0.06959514461628834, "mean_env_wait_ms": 3.879856557465686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 502500, "agent_timesteps_total": 502500, "timers": {"sample_time_ms": 7791.984, "sample_throughput": 962.528, "learn_time_ms": 5545.39, "learn_throughput": 1352.475, "update_time_ms": 2.035}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1466.0411801095736, "policy_loss": -0.007871545837813262, "vf_loss": 1466.0490304720604, "vf_explained_var": 0.1559893637895584, "kl": 0.01577938550533696, "entropy": 3.9907979589397624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 502500, "num_agent_steps_sampled": 502500, "num_steps_trained": 502500}, "done": false, "episodes_total": 670, "training_iteration": 67, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-07-19", "timestamp": 1693793239, "time_this_iter_s": 12.677720069885254, "time_total_s": 872.5604841709137, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 872.5604841709137, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 24.28421052631579, "ram_util_percent": 18.805263157894736}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.6315575194321, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 465.9313762683131, "episode_len_mean": 737.84, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [485.80344777667716, 456.3484253223076, 486.3898238380572, 483.92867017739394, 499.79979826394134, 476.8945742959825, 429.86203558039756, 515.0764317284825, 449.1022242131817, 492.18652004580895, 450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.173359836396302, "mean_inference_ms": 0.7407449598220309, "mean_action_processing_ms": 0.06954815540335513, "mean_env_wait_ms": 3.8724734413176436, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 510000, "agent_timesteps_total": 510000, "timers": {"sample_time_ms": 7861.678, "sample_throughput": 953.995, "learn_time_ms": 5546.089, "learn_throughput": 1352.304, "update_time_ms": 2.009}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1472.0592901714776, "policy_loss": -0.006642513059205928, "vf_loss": 1472.0659235550186, "vf_explained_var": 0.30870938301086426, "kl": 0.013002836776273865, "entropy": 4.249622207576945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 510000, "num_agent_steps_sampled": 510000, "num_steps_trained": 510000}, "done": false, "episodes_total": 680, "training_iteration": 68, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-07-32", "timestamp": 1693793252, "time_this_iter_s": 12.939894676208496, "time_total_s": 885.5003788471222, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 885.5003788471222, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 25.716666666666665, "ram_util_percent": 18.749999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.6315575194321, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 461.2118792485656, "episode_len_mean": 735.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.3909311809805, 456.84801095986245, 511.1097822025503, 470.71860963259013, 324.32707428829514, 499.1213119769943, 496.1914694589775, 490.71562067866154, 471.03371872729974, 377.97851754088555, 139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204], "episode_lengths": [750, 750, 750, 750, 530, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.180391381075669, "mean_inference_ms": 0.740077423698359, "mean_action_processing_ms": 0.0694984301836357, "mean_env_wait_ms": 3.8653363339169493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 517500, "agent_timesteps_total": 517500, "timers": {"sample_time_ms": 7414.201, "sample_throughput": 1011.572, "learn_time_ms": 5547.743, "learn_throughput": 1351.901, "update_time_ms": 2.079}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1326.026712346481, "policy_loss": -0.005078174718418869, "vf_loss": 1326.0317778506521, "vf_explained_var": 0.3498392105102539, "kl": 0.013475104169444143, "entropy": 4.131759789030431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 517500, "num_agent_steps_sampled": 517500, "num_steps_trained": 517500}, "done": false, "episodes_total": 690, "training_iteration": 69, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-07-45", "timestamp": 1693793265, "time_this_iter_s": 12.793375730514526, "time_total_s": 898.2937545776367, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 898.2937545776367, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 26.973684210526315, "ram_util_percent": 18.826315789473682}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.6315575194321, "episode_reward_min": 139.65247377835098, "episode_reward_mean": 460.3327870329181, "episode_len_mean": 738.18, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [139.65247377835098, 504.1402065090566, 489.7612799819974, 504.1205001313489, 507.00819287718986, 471.9250695638926, 507.3764432941427, 518.1925166808941, 520.6315575194321, 504.03774136481564, 514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643], "episode_lengths": [201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.189110476295017, "mean_inference_ms": 0.7392666984984585, "mean_action_processing_ms": 0.06943815070605326, "mean_env_wait_ms": 3.858084106284392, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 525000, "agent_timesteps_total": 525000, "timers": {"sample_time_ms": 7562.365, "sample_throughput": 991.753, "learn_time_ms": 5569.792, "learn_throughput": 1346.549, "update_time_ms": 2.1}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1267.7343232235667, "policy_loss": -0.006815922729102737, "vf_loss": 1267.741130712477, "vf_explained_var": 0.28912755846977234, "kl": 0.013086141375668273, "entropy": 4.1411305686174815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 525000, "num_agent_steps_sampled": 525000, "num_steps_trained": 525000}, "done": false, "episodes_total": 700, "training_iteration": 70, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-07-59", "timestamp": 1693793279, "time_this_iter_s": 13.848308086395264, "time_total_s": 912.142062664032, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 912.142062664032, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 24.544999999999998, "ram_util_percent": 18.825}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.6139790320102, "episode_reward_min": 209.86872175373125, "episode_reward_mean": 458.50072938153863, "episode_len_mean": 739.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.833536603546, 440.86051823264387, 519.6139790320102, 480.0458714952622, 492.74714182184357, 497.86834090890824, 346.0121710508782, 498.8985649269457, 440.5522496507744, 481.58198422285886, 501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.1990357128542, "mean_inference_ms": 0.7384451802608639, "mean_action_processing_ms": 0.06937676628106641, "mean_env_wait_ms": 3.8511925331481116, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 532500, "agent_timesteps_total": 532500, "timers": {"sample_time_ms": 7723.256, "sample_throughput": 971.093, "learn_time_ms": 5571.554, "learn_throughput": 1346.124, "update_time_ms": 2.1}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1299.9762445999404, "policy_loss": -0.008433915903570793, "vf_loss": 1299.9846596410719, "vf_explained_var": 0.37438932061195374, "kl": 0.017857008296075224, "entropy": 3.923645619214591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 532500, "num_agent_steps_sampled": 532500, "num_steps_trained": 532500}, "done": false, "episodes_total": 710, "training_iteration": 71, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-08-13", "timestamp": 1693793293, "time_this_iter_s": 13.754733085632324, "time_total_s": 925.8967957496643, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 925.8967957496643, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 24.726315789473688, "ram_util_percent": 18.836842105263155}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4507629067704, "episode_reward_min": 209.86872175373125, "episode_reward_mean": 456.03959233546084, "episode_len_mean": 739.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [501.0467190907942, 486.1505614524366, 514.4302519722775, 513.5259373006993, 504.6863698363184, 510.74954032344925, 517.4507629067704, 471.1401433294133, 476.2991964483307, 452.6756572779303, 514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.217215449220898, "mean_inference_ms": 0.7376044015014578, "mean_action_processing_ms": 0.06931302324012925, "mean_env_wait_ms": 3.844369530557305, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 540000, "agent_timesteps_total": 540000, "timers": {"sample_time_ms": 8217.07, "sample_throughput": 912.734, "learn_time_ms": 5568.594, "learn_throughput": 1346.839, "update_time_ms": 2.108}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1382.5729736845371, "policy_loss": -0.00655896564377314, "vf_loss": 1382.579522032657, "vf_explained_var": 0.24322830140590668, "kl": 0.013240991116587057, "entropy": 4.04770245511653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 540000, "num_agent_steps_sampled": 540000, "num_steps_trained": 540000}, "done": false, "episodes_total": 720, "training_iteration": 72, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-08-30", "timestamp": 1693793310, "time_this_iter_s": 17.060935735702515, "time_total_s": 942.9577314853668, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 942.9577314853668, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.164, "ram_util_percent": 18.712}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 514.4347530926476, "episode_reward_min": 209.86872175373125, "episode_reward_mean": 452.9191310384588, "episode_len_mean": 739.27, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.4347530926476, 494.43377741300924, 499.3008473259808, 455.03267238329414, 409.82304669347667, 469.92771587316554, 510.2100656095026, 486.7567622529638, 498.3926027456003, 495.85022344738195, 489.5534909617566, 437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.234815164976655, "mean_inference_ms": 0.7367092139305292, "mean_action_processing_ms": 0.06924337568873265, "mean_env_wait_ms": 3.837650224533728, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 547500, "agent_timesteps_total": 547500, "timers": {"sample_time_ms": 8249.686, "sample_throughput": 909.125, "learn_time_ms": 5563.815, "learn_throughput": 1347.996, "update_time_ms": 2.097}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1384.0464662713518, "policy_loss": -0.005293372322379027, "vf_loss": 1384.0517441054521, "vf_explained_var": 0.2099212259054184, "kl": 0.0134011417326154, "entropy": 3.893561608508482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 547500, "num_agent_steps_sampled": 547500, "num_steps_trained": 547500}, "done": false, "episodes_total": 730, "training_iteration": 73, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-08-42", "timestamp": 1693793322, "time_this_iter_s": 12.441412448883057, "time_total_s": 955.3991439342499, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 955.3991439342499, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 23.927777777777774, "ram_util_percent": 18.855555555555554}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 513.4280213859261, "episode_reward_min": 178.85595777796746, "episode_reward_mean": 447.9093440401603, "episode_len_mean": 734.53, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [437.0985188365669, 464.45004300111714, 499.974530290239, 476.29092541056264, 473.8904490336995, 429.91470726984176, 481.18198412838814, 483.3975001987828, 493.3635308704822, 486.0713693781044, 457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.2555276619210485, "mean_inference_ms": 0.7355329518062511, "mean_action_processing_ms": 0.06915163790110145, "mean_env_wait_ms": 3.829866612431805, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 555000, "agent_timesteps_total": 555000, "timers": {"sample_time_ms": 8644.173, "sample_throughput": 867.636, "learn_time_ms": 5565.349, "learn_throughput": 1347.624, "update_time_ms": 2.11}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1519.5663014557401, "policy_loss": -0.006573547277662714, "vf_loss": 1519.5728563728978, "vf_explained_var": 0.2118358016014099, "kl": 0.014774007741942787, "entropy": 3.7881983138747133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 555000, "num_agent_steps_sampled": 555000, "num_steps_trained": 555000}, "done": false, "episodes_total": 741, "training_iteration": 74, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-08-59", "timestamp": 1693793339, "time_this_iter_s": 16.689648151397705, "time_total_s": 972.0887920856476, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 972.0887920856476, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 19.291666666666668, "ram_util_percent": 18.845833333333335}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 513.4280213859261, "episode_reward_min": 178.85595777796746, "episode_reward_mean": 447.30397313664434, "episode_len_mean": 734.1, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [457.6654424889364, 508.5817758141336, 452.8324086427364, 449.70688366605987, 434.25565911614734, 478.2416762346979, 386.6375514154534, 480.50745792794464, 426.3112162232998, 502.3914696853077, 404.5522524683406, 505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.272288300369355, "mean_inference_ms": 0.7345571054512783, "mean_action_processing_ms": 0.06907561549622648, "mean_env_wait_ms": 3.823295783790273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 562500, "agent_timesteps_total": 562500, "timers": {"sample_time_ms": 8623.744, "sample_throughput": 869.692, "learn_time_ms": 5563.94, "learn_throughput": 1347.966, "update_time_ms": 2.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1474.0165726483879, "policy_loss": -0.006380485035321217, "vf_loss": 1474.022943373858, "vf_explained_var": 0.2007196843624115, "kl": 0.016218194540734927, "entropy": 3.8067158206034515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 562500, "num_agent_steps_sampled": 562500, "num_steps_trained": 562500}, "done": false, "episodes_total": 751, "training_iteration": 75, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-09-16", "timestamp": 1693793356, "time_this_iter_s": 16.993772745132446, "time_total_s": 989.08256483078, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 989.08256483078, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 21.058333333333334, "ram_util_percent": 18.683333333333334}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 513.4290451144714, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 444.34141201572004, "episode_len_mean": 727.89, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [505.8671298341525, 433.5178451298211, 502.7163558605649, 493.94522223781024, 385.6095986595206, 508.0930270099535, 456.6381232621669, 274.1452794062224, 477.104896447557, 365.9990874920439, 483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 456, 750, 597, 750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.287961924958756, "mean_inference_ms": 0.7337947564127674, "mean_action_processing_ms": 0.06902079569236612, "mean_env_wait_ms": 3.816730327579407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 570000, "agent_timesteps_total": 570000, "timers": {"sample_time_ms": 8854.035, "sample_throughput": 847.071, "learn_time_ms": 5559.9, "learn_throughput": 1348.945, "update_time_ms": 2.13}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1580.3519044003244, "policy_loss": -0.007383004369971863, "vf_loss": 1580.3592723264533, "vf_explained_var": 0.11742887645959854, "kl": 0.016562070913494074, "entropy": 3.676781019517931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 570000, "num_agent_steps_sampled": 570000, "num_steps_trained": 570000}, "done": false, "episodes_total": 762, "training_iteration": 76, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-09-31", "timestamp": 1693793371, "time_this_iter_s": 15.02112078666687, "time_total_s": 1004.1036856174469, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1004.1036856174469, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 21.147619047619052, "ram_util_percent": 18.823809523809523}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 513.4290451144714, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 446.91352417523325, "episode_len_mean": 732.36, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.6899425221174, 451.6405061175345, 431.25576327698036, 378.1508493456671, 419.39603901411425, 391.49041745048083, 481.34866698977174, 469.6530894006821, 299.68014565634746, 481.6149217992033, 488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 564, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.305649015514902, "mean_inference_ms": 0.7328208702519317, "mean_action_processing_ms": 0.06894411529989078, "mean_env_wait_ms": 3.8103304110300025, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 577500, "agent_timesteps_total": 577500, "timers": {"sample_time_ms": 8858.694, "sample_throughput": 846.626, "learn_time_ms": 5561.978, "learn_throughput": 1348.441, "update_time_ms": 2.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1321.6000267933991, "policy_loss": -0.006416063586849783, "vf_loss": 1321.6064262778073, "vf_explained_var": 0.249794602394104, "kl": 0.01510564564178231, "entropy": 3.5232731540324322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 577500, "num_agent_steps_sampled": 577500, "num_steps_trained": 577500}, "done": false, "episodes_total": 772, "training_iteration": 77, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-09-44", "timestamp": 1693793384, "time_this_iter_s": 12.744142770767212, "time_total_s": 1016.8478283882141, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1016.8478283882141, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 25.036842105263162, "ram_util_percent": 18.836842105263155}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 513.4290451144714, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 451.2865251603205, "episode_len_mean": 734.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [488.8361532551661, 485.2804348465328, 396.64835716973175, 368.98550640878307, 474.7223821424938, 372.30840563026544, 458.0349436624249, 477.33099869652204, 479.7524997357434, 483.3053564021625, 475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.322614462307289, "mean_inference_ms": 0.7318325371298734, "mean_action_processing_ms": 0.06886690834984184, "mean_env_wait_ms": 3.8038770998102223, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 585000, "agent_timesteps_total": 585000, "timers": {"sample_time_ms": 8839.462, "sample_throughput": 848.468, "learn_time_ms": 5561.489, "learn_throughput": 1348.56, "update_time_ms": 2.104}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1418.4335132146286, "policy_loss": -0.004643049935605061, "vf_loss": 1418.4381451622914, "vf_explained_var": 0.18611504137516022, "kl": 0.012505056211952277, "entropy": 3.524219253103612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 585000, "num_agent_steps_sampled": 585000, "num_steps_trained": 585000}, "done": false, "episodes_total": 782, "training_iteration": 78, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-09-57", "timestamp": 1693793397, "time_this_iter_s": 12.743634939193726, "time_total_s": 1029.5914633274078, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1029.5914633274078, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 26.577777777777776, "ram_util_percent": 18.827777777777776}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 516.8459180505818, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 455.30933601222654, "episode_len_mean": 734.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [475.19880041333295, 485.7520289753553, 356.8861861276652, 464.73641482719495, 363.36513524982735, 415.15219105795234, 451.7677059122584, 484.60950638085643, 466.1359680112564, 496.4263882629719, 468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.338949274380952, "mean_inference_ms": 0.7308680338651595, "mean_action_processing_ms": 0.06879131663111247, "mean_env_wait_ms": 3.797395813503348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 592500, "agent_timesteps_total": 592500, "timers": {"sample_time_ms": 8822.932, "sample_throughput": 850.058, "learn_time_ms": 5565.451, "learn_throughput": 1347.6, "update_time_ms": 2.023}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1272.9408215021683, "policy_loss": -0.0072521638547433384, "vf_loss": 1272.948058771683, "vf_explained_var": 0.3293779492378235, "kl": 0.018212911941612064, "entropy": 3.5523453073986504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 592500, "num_agent_steps_sampled": 592500, "num_steps_trained": 592500}, "done": false, "episodes_total": 792, "training_iteration": 79, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-10-10", "timestamp": 1693793410, "time_this_iter_s": 12.667956352233887, "time_total_s": 1042.2594196796417, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1042.2594196796417, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 26.01111111111111, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 516.8459180505818, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 456.418013031047, "episode_len_mean": 734.22, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [468.09815559501783, 495.42197601135547, 501.1660491721137, 452.4279820618094, 497.870038635455, 209.86872175373125, 403.94551249747434, 492.2794245619794, 408.8780590626847, 360.10348255428977, 497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285], "episode_lengths": [750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354347544650613, "mean_inference_ms": 0.7299954250930004, "mean_action_processing_ms": 0.06872270055379646, "mean_env_wait_ms": 3.7911743706417314, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 600000, "agent_timesteps_total": 600000, "timers": {"sample_time_ms": 8714.081, "sample_throughput": 860.676, "learn_time_ms": 5546.93, "learn_throughput": 1352.099, "update_time_ms": 1.973}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1465.6054721638309, "policy_loss": -0.008062556563576653, "vf_loss": 1465.6135275113381, "vf_explained_var": 0.17896541953086853, "kl": 0.015029188715941087, "entropy": 3.654604544882047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 600000, "num_agent_steps_sampled": 600000, "num_steps_trained": 600000}, "done": false, "episodes_total": 802, "training_iteration": 80, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-10-23", "timestamp": 1693793423, "time_this_iter_s": 12.574478387832642, "time_total_s": 1054.8338980674744, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1054.8338980674744, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 24.744444444444447, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.8116315963501, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 462.7108493099849, "episode_len_mean": 738.62, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [497.66679010597716, 390.8708634857954, 489.04205736694445, 485.52950874966916, 392.99495690595984, 512.6800819068515, 450.2692394192228, 478.8656137805019, 498.34928002724854, 398.9651355275113, 487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.369096147575873, "mean_inference_ms": 0.7292463805714108, "mean_action_processing_ms": 0.06866002290659291, "mean_env_wait_ms": 3.785103779214339, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 607500, "agent_timesteps_total": 607500, "timers": {"sample_time_ms": 8612.274, "sample_throughput": 870.85, "learn_time_ms": 5541.768, "learn_throughput": 1353.359, "update_time_ms": 1.988}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1318.1499314130363, "policy_loss": -0.0072646543959755516, "vf_loss": 1318.1571795964644, "vf_explained_var": 0.27445343136787415, "kl": 0.020331821384191404, "entropy": 3.1947556928052743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 607500, "num_agent_steps_sampled": 607500, "num_steps_trained": 607500}, "done": false, "episodes_total": 812, "training_iteration": 81, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-10-35", "timestamp": 1693793435, "time_this_iter_s": 12.685630083084106, "time_total_s": 1067.5195281505585, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1067.5195281505585, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 25.242105263157892, "ram_util_percent": 18.847368421052632}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.8116315963501, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 465.615683929474, "episode_len_mean": 738.62, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [487.5851785657142, 425.72095177409807, 436.56379604338514, 495.48676335701873, 474.8207616295289, 480.3834914098336, 478.2001153667636, 460.0335365371172, 481.1125721117652, 178.85595777796746, 418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 276, 750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.376467740470311, "mean_inference_ms": 0.7285626120813474, "mean_action_processing_ms": 0.06860278796213864, "mean_env_wait_ms": 3.7793027690053673, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 615000, "agent_timesteps_total": 615000, "timers": {"sample_time_ms": 8157.424, "sample_throughput": 919.408, "learn_time_ms": 5540.084, "learn_throughput": 1353.77, "update_time_ms": 2.003}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1326.0456342794128, "policy_loss": -0.007056168890637109, "vf_loss": 1326.0526817192465, "vf_explained_var": 0.32281431555747986, "kl": 0.014999990381317318, "entropy": 3.3119380708468165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 615000, "num_agent_steps_sampled": 615000, "num_steps_trained": 615000}, "done": false, "episodes_total": 822, "training_iteration": 82, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-10-48", "timestamp": 1693793448, "time_this_iter_s": 12.493995666503906, "time_total_s": 1080.0135238170624, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1080.0135238170624, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 27.28888888888889, "ram_util_percent": 18.84444444444445}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.8116315963501, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 470.6153845263928, "episode_len_mean": 743.36, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [418.01810538674755, 434.16041171055696, 478.0947186671194, 439.06008245985436, 497.2669767615167, 486.1970272192499, 513.4280213859261, 422.7890469927684, 473.75433749546033, 445.1886052710663, 461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 707, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.385271290504135, "mean_inference_ms": 0.7279576289460162, "mean_action_processing_ms": 0.0685518677704562, "mean_env_wait_ms": 3.7737481307963674, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 622500, "agent_timesteps_total": 622500, "timers": {"sample_time_ms": 8142.428, "sample_throughput": 921.101, "learn_time_ms": 5538.609, "learn_throughput": 1354.131, "update_time_ms": 2.054}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1457.4087900969942, "policy_loss": -0.003336492771977338, "vf_loss": 1457.4121187371722, "vf_explained_var": 0.286539226770401, "kl": 0.014431509048511846, "entropy": 3.300041258133064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 622500, "num_agent_steps_sampled": 622500, "num_steps_trained": 622500}, "done": false, "episodes_total": 832, "training_iteration": 83, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-11-00", "timestamp": 1693793460, "time_this_iter_s": 12.276851892471313, "time_total_s": 1092.2903757095337, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1092.2903757095337, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 25.35294117647059, "ram_util_percent": 18.852941176470587}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 473.26969828000637, "episode_len_mean": 743.79, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [461.52419567240196, 510.43002637635976, 452.22216478543316, 420.92010588847273, 415.0286248054066, 438.3538491960866, 509.3555883938527, 500.91567537631715, 511.1576323007897, 486.47405947067983, 389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3904574767917985, "mean_inference_ms": 0.7274049192870616, "mean_action_processing_ms": 0.06850457159611627, "mean_env_wait_ms": 3.7681835971048567, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 630000, "agent_timesteps_total": 630000, "timers": {"sample_time_ms": 7669.232, "sample_throughput": 977.934, "learn_time_ms": 5536.312, "learn_throughput": 1354.692, "update_time_ms": 2.023}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1383.4828437934489, "policy_loss": -0.00678922605100956, "vf_loss": 1383.4896205061573, "vf_explained_var": 0.2457987666130066, "kl": 0.019121517917844125, "entropy": 3.0901070954435963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 630000, "num_agent_steps_sampled": 630000, "num_steps_trained": 630000}, "done": false, "episodes_total": 842, "training_iteration": 84, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-11-12", "timestamp": 1693793472, "time_this_iter_s": 11.93366289138794, "time_total_s": 1104.2240386009216, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1104.2240386009216, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 27.647058823529413, "ram_util_percent": 18.852941176470587}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 87.60591381524047, "episode_reward_mean": 475.2918855578358, "episode_len_mean": 743.79, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.90033877988094, 454.11642903551325, 491.71360743152934, 513.4290451144714, 87.60591381524047, 450.5314775760862, 386.82933726511817, 440.4234978807455, 480.6856969181158, 503.71827830325094, 482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437], "episode_lengths": [750, 750, 750, 750, 129, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3876769435130525, "mean_inference_ms": 0.7268904466803164, "mean_action_processing_ms": 0.06846058539365173, "mean_env_wait_ms": 3.7626580852571077, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 637500, "agent_timesteps_total": 637500, "timers": {"sample_time_ms": 7177.427, "sample_throughput": 1044.943, "learn_time_ms": 5535.097, "learn_throughput": 1354.99, "update_time_ms": 2.019}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1428.8694865598518, "policy_loss": -0.005924891256648353, "vf_loss": 1428.8753962629933, "vf_explained_var": 0.3132067024707794, "kl": 0.016305925728744945, "entropy": 3.248699516765142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 637500, "num_agent_steps_sampled": 637500, "num_steps_trained": 637500}, "done": false, "episodes_total": 852, "training_iteration": 85, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-11-24", "timestamp": 1693793484, "time_this_iter_s": 12.06374192237854, "time_total_s": 1116.2877805233002, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1116.2877805233002, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 24.205555555555556, "ram_util_percent": 18.866666666666667}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 349.1451564772887, "episode_reward_mean": 482.3782283832877, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [482.9091650569364, 475.32584300461804, 489.4467028325987, 467.23607649190814, 469.179889966905, 477.1222914792364, 498.8201968059289, 447.20294162275417, 443.2150910773226, 410.38958295292207, 504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.385552936343104, "mean_inference_ms": 0.7260837122487007, "mean_action_processing_ms": 0.06838981640038723, "mean_env_wait_ms": 3.756548977825288, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 645000, "agent_timesteps_total": 645000, "timers": {"sample_time_ms": 6909.181, "sample_throughput": 1085.512, "learn_time_ms": 5539.735, "learn_throughput": 1353.855, "update_time_ms": 2.081}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1462.936147916115, "policy_loss": -0.005235983222975569, "vf_loss": 1462.9413736117087, "vf_explained_var": 0.23594820499420166, "kl": 0.016163032413141654, "entropy": 3.193313811189037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 645000, "num_agent_steps_sampled": 645000, "num_steps_trained": 645000}, "done": false, "episodes_total": 862, "training_iteration": 86, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-11-37", "timestamp": 1693793497, "time_this_iter_s": 12.385907411575317, "time_total_s": 1128.6736879348755, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1128.6736879348755, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 26.938888888888886, "ram_util_percent": 18.844444444444445}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 349.1451564772887, "episode_reward_mean": 484.91709193761375, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.91015824498953, 494.5593431948648, 477.31685132450446, 392.96323777031375, 389.4322894095968, 492.3685077794819, 504.13128716015524, 503.8374034652537, 471.70943822744533, 493.9919235050081, 513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.381731638476865, "mean_inference_ms": 0.7256130091866702, "mean_action_processing_ms": 0.06834851486387722, "mean_env_wait_ms": 3.7510807153148686, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 652500, "agent_timesteps_total": 652500, "timers": {"sample_time_ms": 6918.696, "sample_throughput": 1084.019, "learn_time_ms": 5537.45, "learn_throughput": 1354.414, "update_time_ms": 2.082}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1375.9536398677503, "policy_loss": -0.003866670015504805, "vf_loss": 1375.9574959447827, "vf_explained_var": 0.29925331473350525, "kl": 0.01561163201938264, "entropy": 2.990452731261819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 652500, "num_agent_steps_sampled": 652500, "num_steps_trained": 652500}, "done": false, "episodes_total": 872, "training_iteration": 87, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-11-50", "timestamp": 1693793510, "time_this_iter_s": 12.816656589508057, "time_total_s": 1141.4903445243835, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1141.4903445243835, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 26.133333333333336, "ram_util_percent": 18.816666666666663}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 349.1451564772887, "episode_reward_mean": 486.25644494684957, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [513.4088193571141, 508.64422275924386, 495.3854831854345, 494.70124918353656, 467.8799704991992, 486.70985978583496, 457.55417963012417, 463.48938346294955, 482.8670372264269, 516.8459180505818, 509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.377860209661887, "mean_inference_ms": 0.7251730414938536, "mean_action_processing_ms": 0.0683097435640276, "mean_env_wait_ms": 3.745721349497781, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 660000, "agent_timesteps_total": 660000, "timers": {"sample_time_ms": 6919.507, "sample_throughput": 1083.892, "learn_time_ms": 5550.392, "learn_throughput": 1351.256, "update_time_ms": 2.137}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1516.3813990188858, "policy_loss": -0.005229444535803326, "vf_loss": 1516.3866193351098, "vf_explained_var": 0.22533215582370758, "kl": 0.013239496349461328, "entropy": 3.1094792240757054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 660000, "num_agent_steps_sampled": 660000, "num_steps_trained": 660000}, "done": false, "episodes_total": 882, "training_iteration": 88, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-12-03", "timestamp": 1693793523, "time_this_iter_s": 12.880338907241821, "time_total_s": 1154.3706834316254, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1154.3706834316254, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 29.205555555555552, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 349.1451564772887, "episode_reward_mean": 484.0014188989392, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [509.5728953955664, 507.70957131851225, 422.3409216929478, 459.7588953381171, 389.7119578196373, 452.0674641445724, 487.0982305969016, 477.04099052238155, 477.55298034147813, 388.04411993060285, 425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.374013148893615, "mean_inference_ms": 0.7247706509969547, "mean_action_processing_ms": 0.06827228493101203, "mean_env_wait_ms": 3.7405985686575343, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 667500, "agent_timesteps_total": 667500, "timers": {"sample_time_ms": 6942.672, "sample_throughput": 1080.276, "learn_time_ms": 5546.946, "learn_throughput": 1352.095, "update_time_ms": 2.123}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1480.890694621458, "policy_loss": -0.006134604365501742, "vf_loss": 1480.8968231201172, "vf_explained_var": 0.2543834149837494, "kl": 0.015477634973970145, "entropy": 3.308602857993821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 667500, "num_agent_steps_sampled": 667500, "num_steps_trained": 667500}, "done": false, "episodes_total": 892, "training_iteration": 89, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-12-16", "timestamp": 1693793536, "time_this_iter_s": 12.864261150360107, "time_total_s": 1167.2349445819855, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1167.2349445819855, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 25.952631578947365, "ram_util_percent": 18.857894736842102}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 349.1451564772887, "episode_reward_mean": 480.67411075375526, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [425.95318010995555, 518.4021649659466, 497.48020344858054, 520.8116315963501, 470.2376132173845, 494.378638536174, 506.1139538391537, 500.73556130671295, 485.6681143214218, 499.56196845801605, 511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.370240006105003, "mean_inference_ms": 0.7244100601354702, "mean_action_processing_ms": 0.06823723691132312, "mean_env_wait_ms": 3.7357277149475503, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 675000, "agent_timesteps_total": 675000, "timers": {"sample_time_ms": 6957.306, "sample_throughput": 1078.004, "learn_time_ms": 5547.339, "learn_throughput": 1352.0, "update_time_ms": 2.159}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1540.0940474687995, "policy_loss": -0.009667642817090628, "vf_loss": 1540.1036890579483, "vf_explained_var": 0.0716053918004036, "kl": 0.02097816963689226, "entropy": 3.2669907864877734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 675000, "num_agent_steps_sampled": 675000, "num_steps_trained": 675000}, "done": false, "episodes_total": 902, "training_iteration": 90, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-12-29", "timestamp": 1693793549, "time_this_iter_s": 12.725936651229858, "time_total_s": 1179.9608812332153, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1179.9608812332153, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 27.43888888888889, "ram_util_percent": 18.894444444444446}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 474.4305104404324, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [511.69385441292826, 509.27032583329583, 435.3012296459027, 512.2471663491409, 484.69220765245507, 488.1058097459309, 496.83787007976446, 464.8145816938475, 509.1172065377275, 473.63673727360543, 475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3661023867297, "mean_inference_ms": 0.7240414322932308, "mean_action_processing_ms": 0.06820588001110978, "mean_env_wait_ms": 3.731092637334044, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 682500, "agent_timesteps_total": 682500, "timers": {"sample_time_ms": 6890.058, "sample_throughput": 1088.525, "learn_time_ms": 5564.256, "learn_throughput": 1347.889, "update_time_ms": 2.161}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1460.2736330193989, "policy_loss": -0.006426857595758165, "vf_loss": 1460.280047607422, "vf_explained_var": 0.11158625781536102, "kl": 0.019040996430303, "entropy": 3.126844797296039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 682500, "num_agent_steps_sampled": 682500, "num_steps_trained": 682500}, "done": false, "episodes_total": 912, "training_iteration": 91, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-12-41", "timestamp": 1693793561, "time_this_iter_s": 12.18247652053833, "time_total_s": 1192.1433577537537, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1192.1433577537537, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 26.183333333333334, "ram_util_percent": 18.855555555555558}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 471.1830476190961, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [475.62854372805236, 507.41630571800823, 512.6017808523981, 486.81644267346803, 461.7645542978356, 506.99788205598674, 465.82023600987134, 493.3068505363115, 471.5749154570297, 516.8056729361003, 486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.361783255578813, "mean_inference_ms": 0.723683095149867, "mean_action_processing_ms": 0.06817532052651357, "mean_env_wait_ms": 3.7265980644212204, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 690000, "agent_timesteps_total": 690000, "timers": {"sample_time_ms": 6879.143, "sample_throughput": 1090.252, "learn_time_ms": 5563.264, "learn_throughput": 1348.129, "update_time_ms": 2.141}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1418.351586810613, "policy_loss": -0.004686913842935178, "vf_loss": 1418.3562656208621, "vf_explained_var": 0.12564308941364288, "kl": 0.01598731440360987, "entropy": 3.147055036334668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 690000, "num_agent_steps_sampled": 690000, "num_steps_trained": 690000}, "done": false, "episodes_total": 922, "training_iteration": 92, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-12-53", "timestamp": 1693793573, "time_this_iter_s": 12.374523878097534, "time_total_s": 1204.5178816318512, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1204.5178816318512, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 25.666666666666668, "ram_util_percent": 18.87777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8967240122955, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 467.0665855768353, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [486.57403493656534, 481.3880780955282, 522.2019647980653, 487.86720241954606, 523.0938870630908, 502.92410959575074, 523.8967240122955, 484.75386002381583, 349.1451564772887, 511.54369128967255, 520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.357562654553156, "mean_inference_ms": 0.7233517357177369, "mean_action_processing_ms": 0.06814731432825889, "mean_env_wait_ms": 3.722390839997319, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 697500, "agent_timesteps_total": 697500, "timers": {"sample_time_ms": 6893.205, "sample_throughput": 1088.028, "learn_time_ms": 5567.099, "learn_throughput": 1347.201, "update_time_ms": 2.104}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1456.0427613339182, "policy_loss": -0.004068943852621873, "vf_loss": 1456.0468256546278, "vf_explained_var": 0.058892872184515, "kl": 0.013989701497953668, "entropy": 3.1657560724323077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 697500, "num_agent_steps_sampled": 697500, "num_steps_trained": 697500}, "done": false, "episodes_total": 932, "training_iteration": 93, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-13-06", "timestamp": 1693793586, "time_this_iter_s": 12.456067323684692, "time_total_s": 1216.973948955536, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1216.973948955536, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 26.66666666666667, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 520.3256164444626, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 462.29021279986415, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.3256164444626, 423.5930978482193, 486.9903328082955, 484.50849898746765, 500.79505167367836, 487.3365467106809, 506.3587625546028, 510.56740668247505, 502.098238221962, 486.02709811690437, 519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354412028619528, "mean_inference_ms": 0.7230368189620766, "mean_action_processing_ms": 0.06812105784874255, "mean_env_wait_ms": 3.7184406324199597, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 705000, "agent_timesteps_total": 705000, "timers": {"sample_time_ms": 6958.644, "sample_throughput": 1077.796, "learn_time_ms": 5568.037, "learn_throughput": 1346.974, "update_time_ms": 2.127}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1383.4124260336666, "policy_loss": -0.006161847230741533, "vf_loss": 1383.4185764636024, "vf_explained_var": 0.1026511937379837, "kl": 0.014981788868218847, "entropy": 3.0927565025070964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 705000, "num_agent_steps_sampled": 705000, "num_steps_trained": 705000}, "done": false, "episodes_total": 942, "training_iteration": 94, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-13-19", "timestamp": 1693793599, "time_this_iter_s": 12.598174571990967, "time_total_s": 1229.5721235275269, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1229.5721235275269, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 26.98333333333333, "ram_util_percent": 18.87777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.9304815322769, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 457.76287985678835, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [519.9304815322769, 501.0308231895136, 452.11017271659557, 513.4968142861645, 507.63930728225495, 474.42610598827963, 443.3506339285359, 497.774880702971, 507.91326224958345, 489.9154227889681, 496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.3509993043829605, "mean_inference_ms": 0.7227392173062726, "mean_action_processing_ms": 0.06809651175927522, "mean_env_wait_ms": 3.714746339293248, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 712500, "agent_timesteps_total": 712500, "timers": {"sample_time_ms": 6951.506, "sample_throughput": 1078.903, "learn_time_ms": 5571.068, "learn_throughput": 1346.241, "update_time_ms": 2.139}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1338.3490423946057, "policy_loss": -0.006635789685267008, "vf_loss": 1338.3556670883954, "vf_explained_var": 0.12896718084812164, "kl": 0.016578784659059816, "entropy": 2.994988516225653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 712500, "num_agent_steps_sampled": 712500, "num_steps_trained": 712500}, "done": false, "episodes_total": 952, "training_iteration": 95, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-13-31", "timestamp": 1693793611, "time_this_iter_s": 12.022376537322998, "time_total_s": 1241.5945000648499, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1241.5945000648499, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 27.158823529411762, "ram_util_percent": 18.86470588235294}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 510.9901259102529, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 454.07820967315376, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.4632067963649, 504.5645809258784, 481.9542538466707, 490.1729698269129, 510.1910739431974, 479.62456128513617, 488.01120945025315, 494.27924779240647, 472.2417606933079, 497.2312721636005, 510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.354053321314027, "mean_inference_ms": 0.7224191184096341, "mean_action_processing_ms": 0.06807024314154905, "mean_env_wait_ms": 3.7110822221090274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 720000, "agent_timesteps_total": 720000, "timers": {"sample_time_ms": 7407.241, "sample_throughput": 1012.523, "learn_time_ms": 5571.013, "learn_throughput": 1346.254, "update_time_ms": 2.096}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1399.7164150432004, "policy_loss": -0.00469344756802765, "vf_loss": 1399.721098508673, "vf_explained_var": 0.1048535481095314, "kl": 0.01756617885938946, "entropy": 2.8746454238891603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 720000, "num_agent_steps_sampled": 720000, "num_steps_trained": 720000}, "done": false, "episodes_total": 962, "training_iteration": 96, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-13-48", "timestamp": 1693793628, "time_this_iter_s": 16.941813707351685, "time_total_s": 1258.5363137722015, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1258.5363137722015, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.400000000000002, "ram_util_percent": 18.733333333333334}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 510.9901259102529, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 449.7316959636085, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.9901259102529, 484.3835645265338, 481.9578675269735, 506.4589517848379, 486.67489122362974, 500.8212541688159, 410.4473246246464, 497.05988647584127, 480.56003658816456, 499.801838175504, 480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.356531396322041, "mean_inference_ms": 0.7221008342207489, "mean_action_processing_ms": 0.06804521794076823, "mean_env_wait_ms": 3.7076203461766086, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 727500, "agent_timesteps_total": 727500, "timers": {"sample_time_ms": 7350.091, "sample_throughput": 1020.396, "learn_time_ms": 5570.588, "learn_throughput": 1346.357, "update_time_ms": 2.141}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1384.3109880350403, "policy_loss": -0.0024123242235411023, "vf_loss": 1384.3133887339447, "vf_explained_var": 0.08263001590967178, "kl": 0.014246553439543551, "entropy": 2.9363375873888953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 727500, "num_agent_steps_sampled": 727500, "num_steps_trained": 727500}, "done": false, "episodes_total": 972, "training_iteration": 97, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-14-00", "timestamp": 1693793640, "time_this_iter_s": 12.240849256515503, "time_total_s": 1270.777163028717, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1270.777163028717, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.322222222222223, "ram_util_percent": 18.833333333333332}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 493.55087881497894, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 445.58622018942043, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.7332101017333, 485.4314480431245, 474.8661164431952, 476.0306703147109, 488.87188442509495, 413.948001054322, 439.7578135419023, 477.121331474374, 438.6274978687065, 486.5955450822442, 477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.365394398100413, "mean_inference_ms": 0.7217702373534118, "mean_action_processing_ms": 0.06801892451870631, "mean_env_wait_ms": 3.704229143237348, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 735000, "agent_timesteps_total": 735000, "timers": {"sample_time_ms": 7779.817, "sample_throughput": 964.033, "learn_time_ms": 5555.117, "learn_throughput": 1350.107, "update_time_ms": 2.099}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1341.4161663508012, "policy_loss": -0.006950480688237033, "vf_loss": 1341.4231119964081, "vf_explained_var": 0.14164669811725616, "kl": 0.013502754743067558, "entropy": 2.9711237450777475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 735000, "num_agent_steps_sampled": 735000, "num_steps_trained": 735000}, "done": false, "episodes_total": 982, "training_iteration": 98, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-14-17", "timestamp": 1693793657, "time_this_iter_s": 17.02316379547119, "time_total_s": 1287.8003268241882, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1287.8003268241882, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.34166666666667, "ram_util_percent": 18.795833333333334}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 509.5648860726069, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 442.7952047539056, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [477.26198142565727, 389.5082718719381, 410.93658386480234, 444.6200046611151, 443.8182068994388, 375.7283577466288, 393.23223881963526, 425.8554727064378, 485.28504521752143, 391.92104936914075, 447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.373512278295685, "mean_inference_ms": 0.721456952492533, "mean_action_processing_ms": 0.06799554027027771, "mean_env_wait_ms": 3.7009684772689413, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 742500, "agent_timesteps_total": 742500, "timers": {"sample_time_ms": 7691.316, "sample_throughput": 975.126, "learn_time_ms": 5559.47, "learn_throughput": 1349.049, "update_time_ms": 2.094}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1376.9724535925914, "policy_loss": -0.006691668865318268, "vf_loss": 1376.9791305800616, "vf_explained_var": 0.05641542747616768, "kl": 0.017672193504755854, "entropy": 3.0753701646449203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 742500, "num_agent_steps_sampled": 742500, "num_steps_trained": 742500}, "done": false, "episodes_total": 992, "training_iteration": 99, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-14-30", "timestamp": 1693793670, "time_this_iter_s": 12.022260665893555, "time_total_s": 1299.8225874900818, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1299.8225874900818, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 26.244444444444444, "ram_util_percent": 18.9}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 509.5648860726069, "episode_reward_min": 267.6512922296247, "episode_reward_mean": 443.03912585433085, "episode_len_mean": 746.67, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [447.88809736032687, 481.8769471965073, 267.6512922296247, 406.67019256882304, 449.3198593855962, 412.50802348027986, 467.88561245523414, 489.0968378185613, 385.8210999727156, 486.2650359997405, 467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825], "episode_lengths": [750, 750, 417, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.388083544484374, "mean_inference_ms": 0.721107851204208, "mean_action_processing_ms": 0.06796996700809355, "mean_env_wait_ms": 3.6975384499264137, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 750000, "agent_timesteps_total": 750000, "timers": {"sample_time_ms": 8230.006, "sample_throughput": 911.3, "learn_time_ms": 5553.664, "learn_throughput": 1350.46, "update_time_ms": 2.084}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1335.9527631598005, "policy_loss": -0.004634521718500024, "vf_loss": 1335.9573892884334, "vf_explained_var": 0.09928641468286514, "kl": 0.016608607331786086, "entropy": 2.942264987250506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 750000, "num_agent_steps_sampled": 750000, "num_steps_trained": 750000}, "done": false, "episodes_total": 1002, "training_iteration": 100, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-14-48", "timestamp": 1693793688, "time_this_iter_s": 18.053796529769897, "time_total_s": 1317.8763840198517, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1317.8763840198517, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.250000000000004, "ram_util_percent": 18.726923076923075}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 509.5648860726069, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 444.86012448774113, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [467.4418424076131, 445.0138556575692, 489.1488526310143, 473.41758070865075, 457.9190163131877, 471.8561309809396, 400.4581161471506, 485.48261900749935, 446.6569257924679, 423.5757674448837, 426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.402115681211441, "mean_inference_ms": 0.7207673814944225, "mean_action_processing_ms": 0.067944660967466, "mean_env_wait_ms": 3.6942359001395273, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 757500, "agent_timesteps_total": 757500, "timers": {"sample_time_ms": 8219.017, "sample_throughput": 912.518, "learn_time_ms": 5542.894, "learn_throughput": 1353.084, "update_time_ms": 2.092}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1313.855907841052, "policy_loss": -0.005870725636733538, "vf_loss": 1313.8617718195512, "vf_explained_var": 0.11334358155727386, "kl": 0.014631700595135294, "entropy": 2.983522555383585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 757500, "num_agent_steps_sampled": 757500, "num_steps_trained": 757500}, "done": false, "episodes_total": 1012, "training_iteration": 101, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-15-00", "timestamp": 1693793700, "time_this_iter_s": 11.9649076461792, "time_total_s": 1329.8412916660309, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1329.8412916660309, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 28.976470588235294, "ram_util_percent": 18.86470588235294}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 509.5648860726069, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 444.35175749206707, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.72018090326696, 458.48077228802504, 422.10155669900024, 474.3189430934396, 475.928706316372, 446.2037778083035, 468.49894040973413, 397.20851164737303, 459.54814518688, 458.07744568658694, 410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.415550558067708, "mean_inference_ms": 0.7204510958325724, "mean_action_processing_ms": 0.06792069040280006, "mean_env_wait_ms": 3.6909807734446822, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 765000, "agent_timesteps_total": 765000, "timers": {"sample_time_ms": 8165.045, "sample_throughput": 918.55, "learn_time_ms": 5544.76, "learn_throughput": 1352.628, "update_time_ms": 2.114}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1327.4500651214082, "policy_loss": -0.0066638532080845435, "vf_loss": 1327.4567055395094, "vf_explained_var": 0.14674954116344452, "kl": 0.019051864717461786, "entropy": 2.8803430371365306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 765000, "num_agent_steps_sampled": 765000, "num_steps_trained": 765000}, "done": false, "episodes_total": 1022, "training_iteration": 102, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-15-12", "timestamp": 1693793712, "time_this_iter_s": 11.853551387786865, "time_total_s": 1341.6948430538177, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1341.6948430538177, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 25.476470588235294, "ram_util_percent": 18.88823529411765}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 512.9178811739631, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 444.8531444208215, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.1096789187563, 396.9888416737108, 399.1070718948441, 485.4165884369299, 434.8750117266245, 426.2410145525718, 482.9949909196361, 384.25417430332215, 484.8191641642472, 490.9448944238717, 479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.434636223965284, "mean_inference_ms": 0.720123987982523, "mean_action_processing_ms": 0.0678951354788835, "mean_env_wait_ms": 3.687689194086081, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 772500, "agent_timesteps_total": 772500, "timers": {"sample_time_ms": 8611.149, "sample_throughput": 870.964, "learn_time_ms": 5541.802, "learn_throughput": 1353.351, "update_time_ms": 2.14}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1363.933596594859, "policy_loss": -0.0064102065149631545, "vf_loss": 1363.9399891481562, "vf_explained_var": 0.10834543406963348, "kl": 0.01638520284399494, "entropy": 2.8447436078120085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 772500, "num_agent_steps_sampled": 772500, "num_steps_trained": 772500}, "done": false, "episodes_total": 1032, "training_iteration": 103, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-15-29", "timestamp": 1693793729, "time_this_iter_s": 16.888092041015625, "time_total_s": 1358.5829350948334, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1358.5829350948334, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.995833333333334, "ram_util_percent": 18.71666666666667}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 512.9178811739631, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 444.70727723705465, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [479.4633095165858, 421.64544169172575, 493.55087881497894, 462.3186719236968, 410.6467784890894, 426.36039718701136, 473.82255287776394, 463.1128202618436, 439.0965058573269, 385.84999912114625, 388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.453028024773244, "mean_inference_ms": 0.7198294153735348, "mean_action_processing_ms": 0.06787203838667595, "mean_env_wait_ms": 3.684481899062963, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 780000, "agent_timesteps_total": 780000, "timers": {"sample_time_ms": 8557.235, "sample_throughput": 876.451, "learn_time_ms": 5544.154, "learn_throughput": 1352.776, "update_time_ms": 2.149}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1326.6636598231428, "policy_loss": -0.003258402937218168, "vf_loss": 1326.6669120659262, "vf_explained_var": 0.14063893258571625, "kl": 0.015743370869079162, "entropy": 2.894955859750004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 780000, "num_agent_steps_sampled": 780000, "num_steps_trained": 780000}, "done": false, "episodes_total": 1042, "training_iteration": 104, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-15-41", "timestamp": 1693793741, "time_this_iter_s": 12.08315372467041, "time_total_s": 1370.6660888195038, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1370.6660888195038, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 25.561111111111114, "ram_util_percent": 18.87777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 447.2988341471056, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.4145946289828, 481.99884275984084, 444.8484285604165, 450.92533987985763, 430.32920110262216, 475.3566785251239, 449.91342010016757, 485.0431026714204, 449.5039755717894, 482.7873025014482, 458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.477746013605873, "mean_inference_ms": 0.7195161271467743, "mean_action_processing_ms": 0.06784718647868497, "mean_env_wait_ms": 3.6811765640503005, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 787500, "agent_timesteps_total": 787500, "timers": {"sample_time_ms": 9052.807, "sample_throughput": 828.472, "learn_time_ms": 5544.85, "learn_throughput": 1352.606, "update_time_ms": 2.134}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1308.7127078816043, "policy_loss": -0.004962761770397172, "vf_loss": 1308.7176469705873, "vf_explained_var": 0.16714756190776825, "kl": 0.016374878660453757, "entropy": 2.673243723885488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 787500, "num_agent_steps_sampled": 787500, "num_steps_trained": 787500}, "done": false, "episodes_total": 1052, "training_iteration": 105, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-15-58", "timestamp": 1693793758, "time_this_iter_s": 16.98510241508484, "time_total_s": 1387.6511912345886, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1387.6511912345886, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 19.379166666666666, "ram_util_percent": 18.7625}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 448.70970377238666, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [458.84612283530055, 413.04802695366124, 471.1268171423538, 401.969156732905, 458.4724339989889, 470.1456904492581, 419.47634987435714, 466.8957854138512, 436.92651815639306, 483.1758642121401, 463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.495241557766806, "mean_inference_ms": 0.7192572200566335, "mean_action_processing_ms": 0.0678270935098205, "mean_env_wait_ms": 3.678077904626188, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 795000, "agent_timesteps_total": 795000, "timers": {"sample_time_ms": 8548.081, "sample_throughput": 877.39, "learn_time_ms": 5545.797, "learn_throughput": 1352.375, "update_time_ms": 2.13}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1314.0374428959217, "policy_loss": -0.005951478846876298, "vf_loss": 1314.0433809442036, "vf_explained_var": 0.1608581244945526, "kl": 0.0182585354311338, "entropy": 2.5554464497808684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 795000, "num_agent_steps_sampled": 795000, "num_steps_trained": 795000}, "done": false, "episodes_total": 1062, "training_iteration": 106, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-16-10", "timestamp": 1693793770, "time_this_iter_s": 11.904186010360718, "time_total_s": 1399.5553772449493, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1399.5553772449493, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 28.294117647058822, "ram_util_percent": 18.900000000000002}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 378.75355301351544, "episode_reward_mean": 451.5080991757206, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.7778383868892, 428.0950527348664, 434.13068914669356, 441.43523933485216, 378.75355301351544, 418.95545054800255, 463.09839632762277, 463.2621246196679, 462.0893639740626, 491.0104555002243, 440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.51203515334831, "mean_inference_ms": 0.7190227395027503, "mean_action_processing_ms": 0.06780888185426066, "mean_env_wait_ms": 3.675083603445888, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 802500, "agent_timesteps_total": 802500, "timers": {"sample_time_ms": 8514.065, "sample_throughput": 880.895, "learn_time_ms": 5546.206, "learn_throughput": 1352.276, "update_time_ms": 2.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1329.3781335863016, "policy_loss": -0.00391754998344044, "vf_loss": 1329.3820351810778, "vf_explained_var": 0.16587910056114197, "kl": 0.015337644534353892, "entropy": 2.5231888092170327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 802500, "num_agent_steps_sampled": 802500, "num_steps_trained": 802500}, "done": false, "episodes_total": 1072, "training_iteration": 107, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-16-22", "timestamp": 1693793782, "time_this_iter_s": 11.905444145202637, "time_total_s": 1411.460821390152, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1411.460821390152, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 27.91764705882353, "ram_util_percent": 18.870588235294118}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 452.8750969830492, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.24735829677786, 424.5236285946791, 446.3276236142929, 464.9371122021302, 409.3722197337675, 413.51396373472846, 395.2939119307492, 434.3142519502722, 444.78701866791516, 509.5648860726069, 437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5287504915091015, "mean_inference_ms": 0.7188500524235107, "mean_action_processing_ms": 0.0677952747315043, "mean_env_wait_ms": 3.672286701872003, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 810000, "agent_timesteps_total": 810000, "timers": {"sample_time_ms": 8555.131, "sample_throughput": 876.667, "learn_time_ms": 5546.551, "learn_throughput": 1352.192, "update_time_ms": 2.089}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1324.3553786455575, "policy_loss": -0.004788498726468218, "vf_loss": 1324.3601567155224, "vf_explained_var": 0.16471321880817413, "kl": 0.016281564810832132, "entropy": 2.5238123000678367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 810000, "num_agent_steps_sampled": 810000, "num_steps_trained": 810000}, "done": false, "episodes_total": 1082, "training_iteration": 108, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-16-40", "timestamp": 1693793800, "time_this_iter_s": 17.436668395996094, "time_total_s": 1428.897489786148, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1428.897489786148, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 19.976000000000003, "ram_util_percent": 18.76}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 456.0760902806324, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [437.520705027237, 420.3917524259723, 389.5081999490376, 429.03428455208615, 456.71359495972456, 404.6383053285608, 433.2462367816136, 428.1738088233158, 404.92026845391575, 458.4121663233825, 484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.545410468927956, "mean_inference_ms": 0.7186762310696294, "mean_action_processing_ms": 0.06778117915642204, "mean_env_wait_ms": 3.66941306465139, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 817500, "agent_timesteps_total": 817500, "timers": {"sample_time_ms": 8549.486, "sample_throughput": 877.246, "learn_time_ms": 5543.514, "learn_throughput": 1352.932, "update_time_ms": 2.127}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1347.1171192751092, "policy_loss": -0.004474990124324873, "vf_loss": 1347.121578462245, "vf_explained_var": 0.1616308093070984, "kl": 0.020223564699477798, "entropy": 2.4667307578911215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 817500, "num_agent_steps_sampled": 817500, "num_steps_trained": 817500}, "done": false, "episodes_total": 1092, "training_iteration": 109, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-16-52", "timestamp": 1693793812, "time_this_iter_s": 11.936163425445557, "time_total_s": 1440.8336532115936, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1440.8336532115936, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 25.66470588235294, "ram_util_percent": 18.941176470588236}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 517.4436689735078, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 460.2688375302325, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [484.89359607945676, 449.6983911604137, 387.5967619065928, 394.25435481716625, 417.0366273325621, 494.1410441452539, 492.6066225126568, 437.6094926205444, 434.02521934031245, 485.2207518934685, 483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.555404567221674, "mean_inference_ms": 0.7185503738056304, "mean_action_processing_ms": 0.06777116227387368, "mean_env_wait_ms": 3.6666917823935403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 825000, "agent_timesteps_total": 825000, "timers": {"sample_time_ms": 7941.671, "sample_throughput": 944.386, "learn_time_ms": 5550.13, "learn_throughput": 1351.32, "update_time_ms": 2.1}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1281.8542696678032, "policy_loss": -0.00479185844897845, "vf_loss": 1281.8590392549158, "vf_explained_var": 0.23523156344890594, "kl": 0.016050207319531936, "entropy": 2.381840676372334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 825000, "num_agent_steps_sampled": 825000, "num_steps_trained": 825000}, "done": false, "episodes_total": 1102, "training_iteration": 110, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-17-04", "timestamp": 1693793824, "time_this_iter_s": 12.041738748550415, "time_total_s": 1452.875391960144, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1452.875391960144, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 24.866666666666667, "ram_util_percent": 18.92777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.971979467467, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 462.9707851602819, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.3302216885494, 408.3282857388093, 405.5954735601522, 491.749115689525, 462.30332672073024, 471.49215914729956, 461.38650357449615, 427.73848355080963, 489.79802374718855, 408.41241410601737, 398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.566411104197688, "mean_inference_ms": 0.7184186423153982, "mean_action_processing_ms": 0.06776053310012746, "mean_env_wait_ms": 3.6639526584770414, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 832500, "agent_timesteps_total": 832500, "timers": {"sample_time_ms": 8040.775, "sample_throughput": 932.746, "learn_time_ms": 5542.539, "learn_throughput": 1353.17, "update_time_ms": 2.093}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1325.1790046303959, "policy_loss": -0.003361213299587874, "vf_loss": 1325.182350701801, "vf_explained_var": 0.21133187413215637, "kl": 0.014189710572238893, "entropy": 2.4519482139813698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 832500, "num_agent_steps_sampled": 832500, "num_steps_trained": 832500}, "done": false, "episodes_total": 1112, "training_iteration": 111, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-17-17", "timestamp": 1693793837, "time_this_iter_s": 12.879967451095581, "time_total_s": 1465.7553594112396, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1465.7553594112396, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 26.616666666666667, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 519.971979467467, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 466.53638706150406, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.44971318887985, 484.04603981565276, 427.79819027385577, 434.47993277601984, 449.9495784540798, 449.7898328331729, 495.12332272731265, 438.47697318954135, 446.1942084819464, 512.9178811739631, 475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.577355091542966, "mean_inference_ms": 0.7182811833409865, "mean_action_processing_ms": 0.06774976553804918, "mean_env_wait_ms": 3.6611620412961896, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 840000, "agent_timesteps_total": 840000, "timers": {"sample_time_ms": 8033.128, "sample_throughput": 933.634, "learn_time_ms": 5548.503, "learn_throughput": 1351.716, "update_time_ms": 2.123}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1265.2953921043268, "policy_loss": -0.006730731845028319, "vf_loss": 1265.302106333587, "vf_explained_var": 0.271438330411911, "kl": 0.019213183678110125, "entropy": 2.2070340803114035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 840000, "num_agent_steps_sampled": 840000, "num_steps_trained": 840000}, "done": false, "episodes_total": 1122, "training_iteration": 112, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-17-29", "timestamp": 1693793849, "time_this_iter_s": 11.838037729263306, "time_total_s": 1477.593397140503, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1477.593397140503, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 24.835294117647063, "ram_util_percent": 18.894117647058824}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.7181304450422, "episode_reward_min": 382.25408242047257, "episode_reward_mean": 469.5705242445922, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [475.1460201483201, 480.19863278335663, 467.4592437455798, 382.25408242047257, 420.4083537410979, 458.83125541025714, 414.4272940176761, 431.80620728306434, 425.42182133166966, 425.2118017563324, 497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5825571575988, "mean_inference_ms": 0.7181511617965229, "mean_action_processing_ms": 0.06774049928276912, "mean_env_wait_ms": 3.6584144621450143, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 847500, "agent_timesteps_total": 847500, "timers": {"sample_time_ms": 7608.923, "sample_throughput": 985.685, "learn_time_ms": 5554.019, "learn_throughput": 1350.374, "update_time_ms": 2.074}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1338.2279319633872, "policy_loss": -0.006693535390846684, "vf_loss": 1338.2346080198126, "vf_explained_var": 0.2487214356660843, "kl": 0.019638335766168316, "entropy": 2.2985106387380827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 847500, "num_agent_steps_sampled": 847500, "num_steps_trained": 847500}, "done": false, "episodes_total": 1132, "training_iteration": 113, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-17-42", "timestamp": 1693793862, "time_this_iter_s": 12.699678182601929, "time_total_s": 1490.2930753231049, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1490.2930753231049, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 24.984210526315792, "ram_util_percent": 18.921052631578952}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.7181304450422, "episode_reward_min": 381.724898056615, "episode_reward_mean": 473.20126358583616, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [497.65704356945156, 498.4705586913334, 474.8415046821814, 422.1649161442334, 443.0484405507469, 506.22729201673724, 508.4099161988234, 407.7596084503522, 439.0000974688885, 517.4436689735078, 479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.587437566759922, "mean_inference_ms": 0.7179863832628333, "mean_action_processing_ms": 0.06772878587084637, "mean_env_wait_ms": 3.6555686074825924, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 855000, "agent_timesteps_total": 855000, "timers": {"sample_time_ms": 7592.695, "sample_throughput": 987.792, "learn_time_ms": 5555.781, "learn_throughput": 1349.945, "update_time_ms": 2.045}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1350.83155098608, "policy_loss": -0.006219422500738401, "vf_loss": 1350.8377564511056, "vf_explained_var": 0.2532690763473511, "kl": 0.017636887524380737, "entropy": 2.206592840663457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 855000, "num_agent_steps_sampled": 855000, "num_steps_trained": 855000}, "done": false, "episodes_total": 1142, "training_iteration": 114, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-17-54", "timestamp": 1693793874, "time_this_iter_s": 11.93745231628418, "time_total_s": 1502.230527639389, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1502.230527639389, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 27.211764705882352, "ram_util_percent": 18.88823529411765}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.7181304450422, "episode_reward_min": 381.724898056615, "episode_reward_mean": 474.99407632474606, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [479.1814066730316, 459.3620958225622, 447.0327902851975, 427.5762289145154, 481.6539861525256, 498.6286301260272, 486.8834899519762, 408.2398901136316, 500.2827513846366, 491.3665794056769, 484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.585983323179769, "mean_inference_ms": 0.717854509985878, "mean_action_processing_ms": 0.06771953027368029, "mean_env_wait_ms": 3.6528775604999826, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 862500, "agent_timesteps_total": 862500, "timers": {"sample_time_ms": 7088.469, "sample_throughput": 1058.056, "learn_time_ms": 5554.508, "learn_throughput": 1350.255, "update_time_ms": 1.999}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1357.812162134203, "policy_loss": -0.006096740604488779, "vf_loss": 1357.8182443909725, "vf_explained_var": 0.24438311159610748, "kl": 0.021012690475630497, "entropy": 2.1184133770102163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 862500, "num_agent_steps_sampled": 862500, "num_steps_trained": 862500}, "done": false, "episodes_total": 1152, "training_iteration": 115, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-18-06", "timestamp": 1693793886, "time_this_iter_s": 11.929533004760742, "time_total_s": 1514.1600606441498, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1514.1600606441498, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 28.164705882352944, "ram_util_percent": 18.952941176470592}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 381.724898056615, "episode_reward_mean": 476.16020824106766, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [484.97355153033243, 465.99219077453023, 487.15185607545834, 480.19506369462965, 466.1923860960647, 467.2531845004036, 491.27595580769935, 496.5957062981438, 451.67426207442213, 468.61814925091494, 484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.585145220840568, "mean_inference_ms": 0.7177229338226335, "mean_action_processing_ms": 0.06771025319086962, "mean_env_wait_ms": 3.650204776010695, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 870000, "agent_timesteps_total": 870000, "timers": {"sample_time_ms": 7121.157, "sample_throughput": 1053.2, "learn_time_ms": 5551.481, "learn_throughput": 1350.991, "update_time_ms": 2.075}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1449.4550022448523, "policy_loss": -0.005641488369428, "vf_loss": 1449.4606222896252, "vf_explained_var": 0.18572330474853516, "kl": 0.01891605896158537, "entropy": 2.07599065566467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 870000, "num_agent_steps_sampled": 870000, "num_steps_trained": 870000}, "done": false, "episodes_total": 1162, "training_iteration": 116, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-18-18", "timestamp": 1693793898, "time_this_iter_s": 12.202285766601562, "time_total_s": 1526.3623464107513, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1526.3623464107513, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 26.8, "ram_util_percent": 18.922222222222228}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 378.46756163513976, "episode_reward_mean": 476.49701874410783, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [484.88694329281225, 419.8554462788806, 496.7429165749531, 493.1588265742395, 503.02273061238054, 415.74255120175263, 424.4850485632019, 468.53652434439215, 468.2803350991661, 406.59662177748754, 491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.584923284880752, "mean_inference_ms": 0.7175855920986649, "mean_action_processing_ms": 0.06770064352064636, "mean_env_wait_ms": 3.6475015462858895, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 877500, "agent_timesteps_total": 877500, "timers": {"sample_time_ms": 7161.173, "sample_throughput": 1047.314, "learn_time_ms": 5551.911, "learn_throughput": 1350.886, "update_time_ms": 2.119}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1391.1892095016221, "policy_loss": -0.004021058476261668, "vf_loss": 1391.1932191493147, "vf_explained_var": 0.21889685094356537, "kl": 0.020486552969521198, "entropy": 1.9469031675387236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 877500, "num_agent_steps_sampled": 877500, "num_steps_trained": 877500}, "done": false, "episodes_total": 1172, "training_iteration": 117, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-18-30", "timestamp": 1693793910, "time_this_iter_s": 12.310612201690674, "time_total_s": 1538.672958612442, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1538.672958612442, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 27.60588235294118, "ram_util_percent": 18.923529411764708}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 372.2091478346163, "episode_reward_mean": 479.28994489081947, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [491.3578362969106, 463.66965647284127, 456.17490783637993, 500.1343465553402, 465.3532574962197, 413.67097671329736, 450.4573264631662, 494.84100972656427, 462.8433417081138, 504.478645287403, 469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5835589699749075, "mean_inference_ms": 0.7174116274378887, "mean_action_processing_ms": 0.06768810540660766, "mean_env_wait_ms": 3.64465731773608, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 885000, "agent_timesteps_total": 885000, "timers": {"sample_time_ms": 7133.616, "sample_throughput": 1051.36, "learn_time_ms": 5549.449, "learn_throughput": 1351.486, "update_time_ms": 2.14}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1355.2125037759038, "policy_loss": -0.0037162997759878635, "vf_loss": 1355.2162012908418, "vf_explained_var": 0.26236411929130554, "kl": 0.01645425456261351, "entropy": 1.884343810606811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 885000, "num_agent_steps_sampled": 885000, "num_steps_trained": 885000}, "done": false, "episodes_total": 1182, "training_iteration": 118, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-18-48", "timestamp": 1693793928, "time_this_iter_s": 17.137263298034668, "time_total_s": 1555.8102219104767, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1555.8102219104767, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 20.684, "ram_util_percent": 18.772000000000002}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 372.2091478346163, "episode_reward_mean": 482.25852686027696, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.9398693899653, 478.356782258801, 515.3441362609343, 495.220313805942, 485.2868383589532, 488.003899797903, 427.6147024504468, 434.58762179376834, 430.2939895895882, 457.1858938785488, 488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.582682207866751, "mean_inference_ms": 0.7172307333565558, "mean_action_processing_ms": 0.06767506945841681, "mean_env_wait_ms": 3.641772680289537, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 892500, "agent_timesteps_total": 892500, "timers": {"sample_time_ms": 7138.756, "sample_throughput": 1050.603, "learn_time_ms": 5550.309, "learn_throughput": 1351.276, "update_time_ms": 2.133}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1432.810616496458, "policy_loss": -0.005952966744198574, "vf_loss": 1432.8165531481727, "vf_explained_var": 0.19453255832195282, "kl": 0.020968050946606524, "entropy": 1.7729509638527692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 892500, "num_agent_steps_sampled": 892500, "num_steps_trained": 892500}, "done": false, "episodes_total": 1192, "training_iteration": 119, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-19-00", "timestamp": 1693793940, "time_this_iter_s": 11.996383428573608, "time_total_s": 1567.8066053390503, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1567.8066053390503, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 24.97647058823529, "ram_util_percent": 18.93529411764706}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 372.2091478346163, "episode_reward_mean": 485.9571201900232, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [488.2390314041521, 493.49783961429944, 412.08334137605783, 439.55812929352146, 486.1090719358761, 439.6260866359652, 491.2625323497771, 482.7853558958981, 494.1442568403595, 519.971979467467, 502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.582064687725369, "mean_inference_ms": 0.7170487217087808, "mean_action_processing_ms": 0.06766159673102369, "mean_env_wait_ms": 3.6389177907667403, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 900000, "agent_timesteps_total": 900000, "timers": {"sample_time_ms": 7178.967, "sample_throughput": 1044.719, "learn_time_ms": 5548.894, "learn_throughput": 1351.621, "update_time_ms": 2.15}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1400.3310724807998, "policy_loss": -0.005501941896548842, "vf_loss": 1400.3365524033368, "vf_explained_var": 0.22891739010810852, "kl": 0.01897439625636116, "entropy": 1.7309738553176492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 900000, "num_agent_steps_sampled": 900000, "num_steps_trained": 900000}, "done": false, "episodes_total": 1202, "training_iteration": 120, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-19-12", "timestamp": 1693793952, "time_this_iter_s": 12.429429769515991, "time_total_s": 1580.2360351085663, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1580.2360351085663, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 25.350000000000005, "ram_util_percent": 18.922222222222224}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 372.2091478346163, "episode_reward_mean": 488.86128885736457, "episode_len_mean": 749.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [502.9938339025786, 497.33670767767364, 484.9521799767628, 511.29399594401474, 515.1088615158016, 514.6864990833557, 504.9734028999228, 495.60066893176446, 382.28740608914995, 457.460641624768, 506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.581206367050992, "mean_inference_ms": 0.7168714367164086, "mean_action_processing_ms": 0.0676484544818246, "mean_env_wait_ms": 3.636061687731068, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 907500, "agent_timesteps_total": 907500, "timers": {"sample_time_ms": 7156.923, "sample_throughput": 1047.936, "learn_time_ms": 5549.77, "learn_throughput": 1351.407, "update_time_ms": 2.132}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1462.3499312061374, "policy_loss": -0.0037119461184020263, "vf_loss": 1462.3536199537375, "vf_explained_var": 0.21285377442836761, "kl": 0.01821370536153313, "entropy": 1.6212428899134619, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 907500, "num_agent_steps_sampled": 907500, "num_steps_trained": 907500}, "done": false, "episodes_total": 1212, "training_iteration": 121, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-19-25", "timestamp": 1693793965, "time_this_iter_s": 12.667486429214478, "time_total_s": 1592.9035215377808, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1592.9035215377808, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 25.378947368421056, "ram_util_percent": 18.873684210526317}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 372.2091478346163, "episode_reward_mean": 490.4277065360839, "episode_len_mean": 749.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.02298269114203, 499.3725538161126, 504.1806949072798, 523.7181304450422, 448.4752722571628, 495.48172093279607, 386.86320782594106, 498.0015702787583, 489.8224400876888, 488.70081798132844, 482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580828599441477, "mean_inference_ms": 0.7166898388701556, "mean_action_processing_ms": 0.06763502207127176, "mean_env_wait_ms": 3.6332756204182797, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 915000, "agent_timesteps_total": 915000, "timers": {"sample_time_ms": 7222.504, "sample_throughput": 1038.421, "learn_time_ms": 5550.025, "learn_throughput": 1351.345, "update_time_ms": 2.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1405.1201965849277, "policy_loss": -0.004302310241411945, "vf_loss": 1405.1244767011221, "vf_explained_var": 0.2428167313337326, "kl": 0.014755942777129381, "entropy": 1.8030536239430055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 915000, "num_agent_steps_sampled": 915000, "num_steps_trained": 915000}, "done": false, "episodes_total": 1222, "training_iteration": 122, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-19-38", "timestamp": 1693793978, "time_this_iter_s": 12.496438264846802, "time_total_s": 1605.3999598026276, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1605.3999598026276, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 24.95555555555556, "ram_util_percent": 18.91666666666667}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 364.5187451034258, "episode_reward_mean": 489.7074800839901, "episode_len_mean": 749.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [482.2494713598419, 491.6154337231085, 482.78335262937304, 512.3285683780398, 445.06394254393797, 381.724898056615, 503.7929896414629, 495.82478148493124, 517.3684824474726, 431.48672649742053, 490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5796774742151936, "mean_inference_ms": 0.7165365013999246, "mean_action_processing_ms": 0.067623861106311, "mean_env_wait_ms": 3.630638548911351, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 922500, "agent_timesteps_total": 922500, "timers": {"sample_time_ms": 7143.178, "sample_throughput": 1049.953, "learn_time_ms": 5548.879, "learn_throughput": 1351.624, "update_time_ms": 2.136}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1448.3836349228682, "policy_loss": -0.004159212264753247, "vf_loss": 1448.3877875376556, "vf_explained_var": 0.2203272134065628, "kl": 0.014941269362600042, "entropy": 1.9046515527418104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 922500, "num_agent_steps_sampled": 922500, "num_steps_trained": 922500}, "done": false, "episodes_total": 1232, "training_iteration": 123, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-19-50", "timestamp": 1693793990, "time_this_iter_s": 11.895643472671509, "time_total_s": 1617.295603275299, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1617.295603275299, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 28.96470588235294, "ram_util_percent": 18.88823529411765}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 364.5187451034258, "episode_reward_mean": 490.28918550567244, "episode_len_mean": 749.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.80742281868584, 486.75151217959245, 507.4978321500814, 490.7824145118505, 457.4613161417892, 490.6040308379676, 483.05277677573326, 503.5932922431506, 504.2765224788167, 479.47720049958514, 451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.579371940922407, "mean_inference_ms": 0.7163737571417724, "mean_action_processing_ms": 0.06761215242209379, "mean_env_wait_ms": 3.6280685861444693, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 930000, "agent_timesteps_total": 930000, "timers": {"sample_time_ms": 7217.277, "sample_throughput": 1039.173, "learn_time_ms": 5547.914, "learn_throughput": 1351.859, "update_time_ms": 2.094}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1373.6789773197497, "policy_loss": -0.004400130324223536, "vf_loss": 1373.6833605232885, "vf_explained_var": 0.28958433866500854, "kl": 0.01577672416188176, "entropy": 1.9388183696795318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 930000, "num_agent_steps_sampled": 930000, "num_steps_trained": 930000}, "done": false, "episodes_total": 1242, "training_iteration": 124, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-20-03", "timestamp": 1693794003, "time_this_iter_s": 12.668659210205078, "time_total_s": 1629.9642624855042, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1629.9642624855042, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 26.72777777777778, "ram_util_percent": 18.85}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.0973979126517, "episode_reward_min": 364.5187451034258, "episode_reward_mean": 488.33777993098687, "episode_len_mean": 748.78, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [451.1448994266902, 526.0973979126517, 502.25377305906454, 513.3461845863982, 513.373528077711, 419.7151287553164, 397.78265239879556, 497.75142111198994, 493.6455880565043, 481.71046707681086, 496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.579715315941749, "mean_inference_ms": 0.7162065204958797, "mean_action_processing_ms": 0.0675993983571565, "mean_env_wait_ms": 3.6254974920979843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 937500, "agent_timesteps_total": 937500, "timers": {"sample_time_ms": 7289.73, "sample_throughput": 1028.845, "learn_time_ms": 5546.814, "learn_throughput": 1352.127, "update_time_ms": 2.159}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1511.1610040179753, "policy_loss": -0.005572257286442791, "vf_loss": 1511.1665542343915, "vf_explained_var": 0.20615889132022858, "kl": 0.016195627494392937, "entropy": 2.0523812415236136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 937500, "num_agent_steps_sampled": 937500, "num_steps_trained": 937500}, "done": false, "episodes_total": 1252, "training_iteration": 125, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-20-15", "timestamp": 1693794015, "time_this_iter_s": 12.6436927318573, "time_total_s": 1642.6079552173615, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1642.6079552173615, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 23.772222222222222, "ram_util_percent": 18.86111111111111}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.412368053306, "episode_reward_min": 214.53924159643995, "episode_reward_mean": 482.5579524745749, "episode_len_mean": 744.38, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.4577807412353, 512.8495336836896, 449.16890350008845, 507.01902641736194, 485.95537156511364, 504.54672278337523, 378.46756163513976, 516.3885631100306, 469.95768858165786, 472.79220438893094, 500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580371699295118, "mean_inference_ms": 0.7160307915874116, "mean_action_processing_ms": 0.06758568538236334, "mean_env_wait_ms": 3.6229666284625153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 945000, "agent_timesteps_total": 945000, "timers": {"sample_time_ms": 7338.11, "sample_throughput": 1022.062, "learn_time_ms": 5553.341, "learn_throughput": 1350.538, "update_time_ms": 2.096}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1503.7971222441074, "policy_loss": -0.004887420254743705, "vf_loss": 1503.8020058842028, "vf_explained_var": 0.11583414673805237, "kl": 0.016039397934114224, "entropy": 2.038924288547645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 945000, "num_agent_steps_sampled": 945000, "num_steps_trained": 945000}, "done": false, "episodes_total": 1262, "training_iteration": 126, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-20-28", "timestamp": 1693794028, "time_this_iter_s": 12.749462127685547, "time_total_s": 1655.357417345047, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1655.357417345047, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 23.28947368421053, "ram_util_percent": 18.884210526315787}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.412368053306, "episode_reward_min": 214.53924159643995, "episode_reward_mean": 481.24606596887384, "episode_len_mean": 744.38, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.28212427288685, 504.48197429035923, 519.595706951497, 503.10370406973726, 372.2091478346163, 513.7876879680102, 513.1595594012229, 482.6393224470041, 460.55669031552736, 490.78464143957495, 510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580824628293697, "mean_inference_ms": 0.715860527504716, "mean_action_processing_ms": 0.06757238803037903, "mean_env_wait_ms": 3.620504645015864, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 952500, "agent_timesteps_total": 952500, "timers": {"sample_time_ms": 7309.841, "sample_throughput": 1026.014, "learn_time_ms": 5555.796, "learn_throughput": 1349.942, "update_time_ms": 2.068}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1366.7817939887614, "policy_loss": -0.007392217454074298, "vf_loss": 1366.7891677080574, "vf_explained_var": 0.19758257269859314, "kl": 0.02124639146657178, "entropy": 2.0439666095426525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 952500, "num_agent_steps_sampled": 952500, "num_steps_trained": 952500}, "done": false, "episodes_total": 1272, "training_iteration": 127, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-20-40", "timestamp": 1693794040, "time_this_iter_s": 12.052028894424438, "time_total_s": 1667.4094462394714, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1667.4094462394714, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 26.129411764705882, "ram_util_percent": 18.923529411764708}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.412368053306, "episode_reward_min": 214.53924159643995, "episode_reward_mean": 479.28814394356255, "episode_len_mean": 744.38, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.2662015659192, 522.6212900357327, 466.06571022383326, 513.927377107099, 401.18325557000134, 512.7814919733448, 511.7084347430949, 525.412368053306, 513.1312787258682, 522.7420935037885, 481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.575441189126889, "mean_inference_ms": 0.7157181247890894, "mean_action_processing_ms": 0.0675613299089099, "mean_env_wait_ms": 3.618227068463621, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 960000, "agent_timesteps_total": 960000, "timers": {"sample_time_ms": 6800.646, "sample_throughput": 1102.836, "learn_time_ms": 5559.471, "learn_throughput": 1349.049, "update_time_ms": 2.089}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1357.219219815529, "policy_loss": -0.0056799603105222776, "vf_loss": 1357.2248953609144, "vf_explained_var": 0.27172642946243286, "kl": 0.014961783532339528, "entropy": 2.0151298322920073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 960000, "num_agent_steps_sampled": 960000, "num_steps_trained": 960000}, "done": false, "episodes_total": 1282, "training_iteration": 128, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-20-53", "timestamp": 1693794053, "time_this_iter_s": 12.082907438278198, "time_total_s": 1679.4923536777496, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1679.4923536777496, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 27.35882352941176, "ram_util_percent": 18.876470588235293}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0013827115819, "episode_reward_min": 214.53924159643995, "episode_reward_mean": 476.5939088494319, "episode_len_mean": 744.38, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [481.49995403955126, 503.44230786694726, 512.8288650031147, 517.4313122139671, 514.2687070303942, 477.41082571082944, 523.8779285715161, 490.91786075438415, 522.4198555091631, 507.5957638596023, 500.0507389654192, 515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.570479375913926, "mean_inference_ms": 0.7156176233686975, "mean_action_processing_ms": 0.06755234612522706, "mean_env_wait_ms": 3.6161329253004526, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 967500, "agent_timesteps_total": 967500, "timers": {"sample_time_ms": 6856.296, "sample_throughput": 1093.885, "learn_time_ms": 5560.555, "learn_throughput": 1348.786, "update_time_ms": 2.06}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1441.8883910098318, "policy_loss": -0.004391003550835332, "vf_loss": 1441.8927670753608, "vf_explained_var": 0.23057855665683746, "kl": 0.018653934872899347, "entropy": 1.8407659112396886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 967500, "num_agent_steps_sampled": 967500, "num_steps_trained": 967500}, "done": false, "episodes_total": 1292, "training_iteration": 129, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-21-05", "timestamp": 1693794065, "time_this_iter_s": 12.56284785270691, "time_total_s": 1692.0552015304565, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1692.0552015304565, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 26.244444444444447, "ram_util_percent": 18.88888888888889}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0013827115819, "episode_reward_min": 137.672907933757, "episode_reward_mean": 468.87358630451394, "episode_len_mean": 738.89, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.3026981285359, 515.2904885172666, 483.52392221477635, 493.78395443837724, 519.4924528519176, 503.38673518751045, 470.50468721822244, 525.0013827115819, 511.3574313139043, 517.3060114703193, 511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476], "episode_lengths": [750, 750, 706, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.564882438236882, "mean_inference_ms": 0.7154662821247016, "mean_action_processing_ms": 0.0675390652624137, "mean_env_wait_ms": 3.6139013515436513, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 975000, "agent_timesteps_total": 975000, "timers": {"sample_time_ms": 6920.161, "sample_throughput": 1083.79, "learn_time_ms": 5557.638, "learn_throughput": 1349.494, "update_time_ms": 2.112}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1564.8350651110634, "policy_loss": -0.0037934655031599735, "vf_loss": 1564.838838221663, "vf_explained_var": 0.22179898619651794, "kl": 0.015863015406870778, "entropy": 1.8103487457259226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 975000, "num_agent_steps_sampled": 975000, "num_steps_trained": 975000}, "done": false, "episodes_total": 1303, "training_iteration": 130, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-21-19", "timestamp": 1693794079, "time_this_iter_s": 13.04044222831726, "time_total_s": 1705.0956437587738, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1705.0956437587738, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 23.984210526315792, "ram_util_percent": 18.878947368421056}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 524.1201587885872, "episode_reward_min": 137.672907933757, "episode_reward_mean": 466.33047333423025, "episode_len_mean": 739.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [511.5480043587053, 521.704626119507, 482.78632459588465, 516.8594362666141, 491.60987608240464, 511.0212925473033, 507.05036666766836, 439.45197004765697, 523.9980573616632, 364.5187451034258, 454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.56405184887124, "mean_inference_ms": 0.7153476017982899, "mean_action_processing_ms": 0.06752914427641737, "mean_env_wait_ms": 3.611939915241944, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 982500, "agent_timesteps_total": 982500, "timers": {"sample_time_ms": 7366.408, "sample_throughput": 1018.135, "learn_time_ms": 5566.162, "learn_throughput": 1347.427, "update_time_ms": 2.156}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1436.2558548749503, "policy_loss": -0.005149579474749833, "vf_loss": 1436.260994345455, "vf_explained_var": 0.21854351460933685, "kl": 0.016645292693924868, "entropy": 1.969951127141209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 982500, "num_agent_steps_sampled": 982500, "num_steps_trained": 982500}, "done": false, "episodes_total": 1313, "training_iteration": 131, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-21-36", "timestamp": 1693794096, "time_this_iter_s": 17.215858697891235, "time_total_s": 1722.311502456665, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1722.311502456665, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.124, "ram_util_percent": 18.732}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 524.1201587885872, "episode_reward_min": 137.672907933757, "episode_reward_mean": 464.5641850815436, "episode_len_mean": 739.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [454.8548186575222, 513.4913999575799, 518.3144093181777, 506.63610561164757, 472.169276270182, 507.39676641044076, 419.5600263051803, 501.313724330445, 510.3614740492634, 510.775412238697, 519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.563480257941555, "mean_inference_ms": 0.7152415187314827, "mean_action_processing_ms": 0.06752014772675921, "mean_env_wait_ms": 3.610109237124442, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 990000, "agent_timesteps_total": 990000, "timers": {"sample_time_ms": 7347.957, "sample_throughput": 1020.692, "learn_time_ms": 5566.464, "learn_throughput": 1347.355, "update_time_ms": 2.109}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1385.5072887355998, "policy_loss": -0.004129153929682354, "vf_loss": 1385.5114025568557, "vf_explained_var": 0.2196434885263443, "kl": 0.018078057001585775, "entropy": 1.7527601714861596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 990000, "num_agent_steps_sampled": 990000, "num_steps_trained": 990000}, "done": false, "episodes_total": 1323, "training_iteration": 132, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-21-48", "timestamp": 1693794108, "time_this_iter_s": 12.31348967552185, "time_total_s": 1734.624992132187, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1734.624992132187, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 27.061111111111114, "ram_util_percent": 18.922222222222224}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 524.1201587885872, "episode_reward_min": 137.672907933757, "episode_reward_mean": 464.0400473687132, "episode_len_mean": 739.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [519.1103805865706, 512.5933026040622, 514.8887286863569, 420.83951557552257, 480.6270428361798, 503.33577268736366, 425.79305150628966, 514.7896798272461, 399.6563023821412, 461.31384021457615, 448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.563675193703775, "mean_inference_ms": 0.7151064643806732, "mean_action_processing_ms": 0.06750806321523256, "mean_env_wait_ms": 3.6081952030220132, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 997500, "agent_timesteps_total": 997500, "timers": {"sample_time_ms": 7444.538, "sample_throughput": 1007.45, "learn_time_ms": 5567.161, "learn_throughput": 1347.186, "update_time_ms": 2.117}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1375.209636158054, "policy_loss": -0.0038178399489340134, "vf_loss": 1375.2134356482554, "vf_explained_var": 0.24655330181121826, "kl": 0.018591697446526622, "entropy": 1.8378625659619348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 997500, "num_agent_steps_sampled": 997500, "num_steps_trained": 997500}, "done": false, "episodes_total": 1333, "training_iteration": 133, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-22-01", "timestamp": 1693794121, "time_this_iter_s": 12.868409633636475, "time_total_s": 1747.4934017658234, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1747.4934017658234, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 25.144444444444442, "ram_util_percent": 18.91666666666667}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 463.845818544668, "episode_len_mean": 739.33, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [448.0066601598558, 480.5785505405421, 506.48257955179236, 501.6498912075898, 427.6819362347677, 423.4457518660884, 516.9283576917181, 512.3366091361821, 420.73958656559853, 384.937961888961, 476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017], "episode_lengths": [750, 750, 750, 750, 672, 750, 750, 750, 750, 750, 750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.563017577583053, "mean_inference_ms": 0.7150037580839546, "mean_action_processing_ms": 0.06749851628906907, "mean_env_wait_ms": 3.606369544507828, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1005000, "agent_timesteps_total": 1005000, "timers": {"sample_time_ms": 7367.003, "sample_throughput": 1018.053, "learn_time_ms": 5570.258, "learn_throughput": 1346.437, "update_time_ms": 2.186}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1404.5238580736063, "policy_loss": -0.006850345680584847, "vf_loss": 1404.5306877524165, "vf_explained_var": 0.24195173382759094, "kl": 0.02180702234313781, "entropy": 1.9380786671476848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1005000, "num_agent_steps_sampled": 1005000, "num_steps_trained": 1005000}, "done": false, "episodes_total": 1343, "training_iteration": 134, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-22-13", "timestamp": 1693794133, "time_this_iter_s": 11.924851894378662, "time_total_s": 1759.418253660202, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1759.418253660202, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 26.866666666666667, "ram_util_percent": 18.961111111111116}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 465.69735263202244, "episode_len_mean": 740.11, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [476.1267631284104, 418.0593013604635, 457.77270875251827, 214.53924159643995, 489.4287762466898, 491.8323039111339, 373.6343288840955, 471.4945117294495, 441.0123973225687, 378.7790643173871, 463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888], "episode_lengths": [750, 750, 750, 310, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.562486151711949, "mean_inference_ms": 0.7148910127567034, "mean_action_processing_ms": 0.06748929428547938, "mean_env_wait_ms": 3.604532731111965, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1012500, "agent_timesteps_total": 1012500, "timers": {"sample_time_ms": 7369.819, "sample_throughput": 1017.664, "learn_time_ms": 5578.548, "learn_throughput": 1344.436, "update_time_ms": 2.13}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1325.2725867837162, "policy_loss": -0.003943324988013354, "vf_loss": 1325.2765244306145, "vf_explained_var": 0.2775001525878906, "kl": 0.016574058370118338, "entropy": 1.8960886460239605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1012500, "num_agent_steps_sampled": 1012500, "num_steps_trained": 1012500}, "done": false, "episodes_total": 1353, "training_iteration": 135, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-22-26", "timestamp": 1693794146, "time_this_iter_s": 12.754638671875, "time_total_s": 1772.172892332077, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1772.172892332077, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 23.816666666666666, "ram_util_percent": 18.922222222222228}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 471.7099218407178, "episode_len_mean": 744.51, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.87600027806417, 401.12495528308597, 460.1632426958561, 514.4277447964225, 515.7481032839285, 494.0380244785527, 489.17480582268206, 477.1556292800018, 467.92713560053, 479.34132904224134, 506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.566101741218183, "mean_inference_ms": 0.714787920708961, "mean_action_processing_ms": 0.06748074896709497, "mean_env_wait_ms": 3.6027196966060955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1020000, "agent_timesteps_total": 1020000, "timers": {"sample_time_ms": 7774.885, "sample_throughput": 964.644, "learn_time_ms": 5590.554, "learn_throughput": 1341.549, "update_time_ms": 2.125}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1379.356414070776, "policy_loss": -0.005433594278391387, "vf_loss": 1379.3618303201965, "vf_explained_var": 0.27572116255760193, "kl": 0.017946530861303725, "entropy": 1.7363808431867827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1020000, "num_agent_steps_sampled": 1020000, "num_steps_trained": 1020000}, "done": false, "episodes_total": 1363, "training_iteration": 136, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-22-43", "timestamp": 1693794163, "time_this_iter_s": 16.921055793762207, "time_total_s": 1789.0939481258392, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1789.0939481258392, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 20.279166666666665, "ram_util_percent": 18.825}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 470.2107143471933, "episode_len_mean": 744.51, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.87716287088506, 400.77717592309347, 419.2117688644226, 478.2541342918654, 450.3961626209457, 505.46433961006227, 470.1844431548329, 481.49772552506107, 472.80411455589655, 485.87976038003126, 496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.57042797193758, "mean_inference_ms": 0.7146540899771651, "mean_action_processing_ms": 0.06747001576249402, "mean_env_wait_ms": 3.600856346045559, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1027500, "agent_timesteps_total": 1027500, "timers": {"sample_time_ms": 7946.806, "sample_throughput": 943.775, "learn_time_ms": 5592.559, "learn_throughput": 1341.068, "update_time_ms": 2.083}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1414.6651247186176, "policy_loss": -0.003673489404431844, "vf_loss": 1414.6687809313757, "vf_explained_var": 0.22869205474853516, "kl": 0.017928410145161784, "entropy": 1.7958691348463802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1027500, "num_agent_steps_sampled": 1027500, "num_steps_trained": 1027500}, "done": false, "episodes_total": 1373, "training_iteration": 137, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-22-57", "timestamp": 1693794177, "time_this_iter_s": 13.790135383605957, "time_total_s": 1802.8840835094452, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1802.8840835094452, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.79, "ram_util_percent": 18.920000000000005}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 469.5545928621969, "episode_len_mean": 741.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.8428682483335, 400.58109382001584, 497.1217948111376, 412.8467017947455, 403.403997121333, 508.02298563955674, 507.9178520602189, 509.0756732614316, 508.7232649521138, 391.99992421336657, 463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.574819763456819, "mean_inference_ms": 0.7145170202673191, "mean_action_processing_ms": 0.06745876843477959, "mean_env_wait_ms": 3.598928751711302, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1035000, "agent_timesteps_total": 1035000, "timers": {"sample_time_ms": 7940.847, "sample_throughput": 944.484, "learn_time_ms": 5600.157, "learn_throughput": 1339.248, "update_time_ms": 2.082}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1308.6985714669954, "policy_loss": -0.004758899164054606, "vf_loss": 1308.7033151917537, "vf_explained_var": 0.33506277203559875, "kl": 0.016549071773193303, "entropy": 1.7286447296708316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1035000, "num_agent_steps_sampled": 1035000, "num_steps_trained": 1035000}, "done": false, "episodes_total": 1383, "training_iteration": 138, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-23-10", "timestamp": 1693794190, "time_this_iter_s": 12.098337650299072, "time_total_s": 1814.9824211597443, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1814.9824211597443, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 24.47222222222222, "ram_util_percent": 18.950000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 137.672907933757, "episode_reward_mean": 471.49786224687807, "episode_len_mean": 741.56, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [463.7116171161846, 502.8892961014564, 470.04188345290913, 455.9045431933923, 482.9254331862208, 137.672907933757, 424.8651204038459, 501.9601134080797, 487.0986853460404, 460.6423406778476, 478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485], "episode_lengths": [750, 750, 750, 750, 750, 201, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.580945869874359, "mean_inference_ms": 0.7143585417800147, "mean_action_processing_ms": 0.0674470437143178, "mean_env_wait_ms": 3.596997010190952, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1042500, "agent_timesteps_total": 1042500, "timers": {"sample_time_ms": 8104.528, "sample_throughput": 925.409, "learn_time_ms": 5605.909, "learn_throughput": 1337.874, "update_time_ms": 2.093}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1372.2753422623973, "policy_loss": -0.003238293572015255, "vf_loss": 1372.2785646082991, "vf_explained_var": 0.27634507417678833, "kl": 0.02145546905043306, "entropy": 1.752111262992277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1042500, "num_agent_steps_sampled": 1042500, "num_steps_trained": 1042500}, "done": false, "episodes_total": 1393, "training_iteration": 139, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-23-24", "timestamp": 1693794204, "time_this_iter_s": 14.25731897354126, "time_total_s": 1829.2397401332855, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1829.2397401332855, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 22.63, "ram_util_percent": 18.875000000000007}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 473.2506463804465, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.10849291146934, 461.74180644085453, 463.1587560417595, 477.6766719153902, 485.7521453138027, 446.46885805892697, 503.1598144181286, 487.97197955868734, 524.1201587885872, 472.4797835764503, 375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5873004633523, "mean_inference_ms": 0.7142638185997093, "mean_action_processing_ms": 0.06744087433853173, "mean_env_wait_ms": 3.5952577343398486, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1050000, "agent_timesteps_total": 1050000, "timers": {"sample_time_ms": 8048.038, "sample_throughput": 931.904, "learn_time_ms": 5615.332, "learn_throughput": 1335.629, "update_time_ms": 2.078}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1525.9022207486428, "policy_loss": -0.0031109637578838837, "vf_loss": 1525.9053151276153, "vf_explained_var": 0.14199453592300415, "kl": 0.01716635282651734, "entropy": 2.065932820611081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1050000, "num_agent_steps_sampled": 1050000, "num_steps_trained": 1050000}, "done": false, "episodes_total": 1403, "training_iteration": 140, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-23-37", "timestamp": 1693794217, "time_this_iter_s": 12.569812536239624, "time_total_s": 1841.8095526695251, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1841.8095526695251, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 24.855555555555558, "ram_util_percent": 18.92777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 470.7298927705842, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.33974412925465, 376.54137078010575, 511.3733405224689, 481.6578627083546, 513.8608468847634, 518.834394382073, 517.2585201457721, 430.37043998464145, 477.2064179632145, 491.4769363815105, 506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.589453049765754, "mean_inference_ms": 0.7141574022794722, "mean_action_processing_ms": 0.06743266511087526, "mean_env_wait_ms": 3.5935192355107843, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1057500, "agent_timesteps_total": 1057500, "timers": {"sample_time_ms": 7634.435, "sample_throughput": 982.391, "learn_time_ms": 5616.037, "learn_throughput": 1335.461, "update_time_ms": 2.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1396.7803252139333, "policy_loss": -0.005377407994721148, "vf_loss": 1396.7856801695743, "vf_explained_var": 0.19901582598686218, "kl": 0.021689389251869272, "entropy": 1.7864579479573137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1057500, "num_agent_steps_sampled": 1057500, "num_steps_trained": 1057500}, "done": false, "episodes_total": 1413, "training_iteration": 141, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-23-50", "timestamp": 1693794230, "time_this_iter_s": 13.087504148483276, "time_total_s": 1854.8970568180084, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1854.8970568180084, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 25.30526315789474, "ram_util_percent": 18.931578947368422}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 471.1313348770091, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.79894107953584, 439.6037702107869, 512.1346612784239, 486.8181066744038, 464.41043440055114, 511.8939168897661, 464.3072600860038, 518.8418289997263, 455.0415760983994, 502.6091461484967, 444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.591898032658586, "mean_inference_ms": 0.7140520961976508, "mean_action_processing_ms": 0.06742442419565338, "mean_env_wait_ms": 3.5917751902626405, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1065000, "agent_timesteps_total": 1065000, "timers": {"sample_time_ms": 7681.778, "sample_throughput": 976.336, "learn_time_ms": 5618.785, "learn_throughput": 1334.808, "update_time_ms": 2.17}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1298.109323327016, "policy_loss": -0.0049268627870764775, "vf_loss": 1298.1142266225006, "vf_explained_var": 0.29333972930908203, "kl": 0.0167421572434992, "entropy": 1.6511665612964306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1065000, "num_agent_steps_sampled": 1065000, "num_steps_trained": 1065000}, "done": false, "episodes_total": 1423, "training_iteration": 142, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-24-03", "timestamp": 1693794243, "time_this_iter_s": 12.815818786621094, "time_total_s": 1867.7128756046295, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1867.7128756046295, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 25.489473684210534, "ram_util_percent": 18.93684210526316}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 526.8096024027459, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 469.82029370860204, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [444.5592099186451, 512.817838586912, 526.8096024027459, 519.6637485154345, 505.7795425237248, 404.9859664231292, 428.87890303340544, 415.2598082731088, 484.02922975748794, 490.74088506720017, 476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.59438054447204, "mean_inference_ms": 0.7139644713200337, "mean_action_processing_ms": 0.06741767757758517, "mean_env_wait_ms": 3.590100112970563, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1072500, "agent_timesteps_total": 1072500, "timers": {"sample_time_ms": 7669.747, "sample_throughput": 977.868, "learn_time_ms": 5621.824, "learn_throughput": 1334.087, "update_time_ms": 2.182}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1373.6913181110965, "policy_loss": -0.003177479623769552, "vf_loss": 1373.6944835598185, "vf_explained_var": 0.25564610958099365, "kl": 0.019501680708554636, "entropy": 1.6843490689487781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1072500, "num_agent_steps_sampled": 1072500, "num_steps_trained": 1072500}, "done": false, "episodes_total": 1433, "training_iteration": 143, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-24-16", "timestamp": 1693794256, "time_this_iter_s": 12.779816389083862, "time_total_s": 1880.4926919937134, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1880.4926919937134, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 25.45555555555556, "ram_util_percent": 18.92777777777778}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.0302958682948, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 471.05848422856633, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [476.65656159014816, 496.508008668454, 457.3962209225815, 477.74671135660475, 444.97968712913445, 518.675651860453, 466.0401521158452, 510.2348969236495, 471.6096088747898, 488.093794136888, 445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.596925274171595, "mean_inference_ms": 0.7138841727288832, "mean_action_processing_ms": 0.06741129700666329, "mean_env_wait_ms": 3.5884019542698717, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1080000, "agent_timesteps_total": 1080000, "timers": {"sample_time_ms": 7672.432, "sample_throughput": 977.526, "learn_time_ms": 5622.065, "learn_throughput": 1334.029, "update_time_ms": 2.206}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1331.1691811254468, "policy_loss": -0.0051030472118281205, "vf_loss": 1331.1742599745928, "vf_explained_var": 0.28930214047431946, "kl": 0.020941569573083144, "entropy": 1.2987658000598519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1080000, "num_agent_steps_sampled": 1080000, "num_steps_trained": 1080000}, "done": false, "episodes_total": 1443, "training_iteration": 144, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-24-28", "timestamp": 1693794268, "time_this_iter_s": 11.954694509506226, "time_total_s": 1892.4473865032196, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1892.4473865032196, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 26.84705882352941, "ram_util_percent": 18.964705882352945}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 522.0302958682948, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 473.0636115511719, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0230701483602, 462.74723496241586, 492.86837475742357, 505.7208494531078, 482.9047944805752, 511.27156636613375, 514.8012460449297, 498.4547856097454, 466.5147363188377, 433.62965997714747, 453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.598879216559251, "mean_inference_ms": 0.7138258717175752, "mean_action_processing_ms": 0.06740621830848946, "mean_env_wait_ms": 3.5867770345657743, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1087500, "agent_timesteps_total": 1087500, "timers": {"sample_time_ms": 7602.356, "sample_throughput": 986.536, "learn_time_ms": 5623.629, "learn_throughput": 1333.658, "update_time_ms": 2.266}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1368.5408065020029, "policy_loss": -0.005051090601452831, "vf_loss": 1368.5458383851133, "vf_explained_var": 0.2783730924129486, "kl": 0.021465362735823907, "entropy": 1.4272245635420588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1087500, "num_agent_steps_sampled": 1087500, "num_steps_trained": 1087500}, "done": false, "episodes_total": 1453, "training_iteration": 145, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-24-40", "timestamp": 1693794280, "time_this_iter_s": 12.06948447227478, "time_total_s": 1904.5168709754944, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1904.5168709754944, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 25.438888888888894, "ram_util_percent": 18.950000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 472.702180576398, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [453.38937634628826, 386.6214460275422, 448.62003586455893, 503.06746993154223, 436.33433150289943, 452.573384991298, 387.82034881979365, 512.7409961517859, 511.50396583041373, 520.3848657428043, 488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.596125817383767, "mean_inference_ms": 0.7137845055177966, "mean_action_processing_ms": 0.06740220019582786, "mean_env_wait_ms": 3.5851698356260853, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1095000, "agent_timesteps_total": 1095000, "timers": {"sample_time_ms": 7118.01, "sample_throughput": 1053.665, "learn_time_ms": 5613.068, "learn_throughput": 1336.168, "update_time_ms": 2.301}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1390.2031021376788, "policy_loss": -0.001896371942613337, "vf_loss": 1390.2049881240068, "vf_explained_var": 0.2469940185546875, "kl": 0.018100791268416044, "entropy": 1.1510449871168298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1095000, "num_agent_steps_sampled": 1095000, "num_steps_trained": 1095000}, "done": false, "episodes_total": 1463, "training_iteration": 146, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-24-52", "timestamp": 1693794292, "time_this_iter_s": 11.972862720489502, "time_total_s": 1916.489733695984, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1916.489733695984, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 26.38823529411765, "ram_util_percent": 18.95882352941177}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 274.3184678897267, "episode_reward_mean": 476.7508432680513, "episode_len_mean": 747.05, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [488.71903363569743, 500.05647872197636, 487.09672326173006, 274.3184678897267, 459.3287581554961, 522.0302958682948, 440.289850938155, 497.8734921718184, 454.932054713124, 481.0894839414226, 475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377], "episode_lengths": [750, 750, 750, 455, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5940882942574754, "mean_inference_ms": 0.7137522883843671, "mean_action_processing_ms": 0.06739869386129127, "mean_env_wait_ms": 3.5835514365317866, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1102500, "agent_timesteps_total": 1102500, "timers": {"sample_time_ms": 7131.42, "sample_throughput": 1051.684, "learn_time_ms": 5620.466, "learn_throughput": 1334.409, "update_time_ms": 2.385}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1426.7561395160224, "policy_loss": -0.003494497638795588, "vf_loss": 1426.7596226061805, "vf_explained_var": 0.2809599041938782, "kl": 0.019788329942266578, "entropy": 1.203284734790608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1102500, "num_agent_steps_sampled": 1102500, "num_steps_trained": 1102500}, "done": false, "episodes_total": 1473, "training_iteration": 147, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-25-06", "timestamp": 1693794306, "time_this_iter_s": 13.999043941497803, "time_total_s": 1930.4887776374817, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1930.4887776374817, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 22.31, "ram_util_percent": 18.890000000000004}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 384.4565896821081, "episode_reward_mean": 479.02477558036014, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [475.2789205790164, 518.5406865717189, 469.2192997802246, 509.0167797573575, 467.3995587685588, 497.65855868405924, 500.9957363844731, 447.5063881104345, 445.288281092489, 499.9588846620485, 469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.591999326355977, "mean_inference_ms": 0.7137256018909277, "mean_action_processing_ms": 0.06739574640974831, "mean_env_wait_ms": 3.5819682796651677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1110000, "agent_timesteps_total": 1110000, "timers": {"sample_time_ms": 7121.132, "sample_throughput": 1053.203, "learn_time_ms": 5616.839, "learn_throughput": 1335.271, "update_time_ms": 2.403}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1429.4358676199186, "policy_loss": -0.0032348993668427405, "vf_loss": 1429.4390863450908, "vf_explained_var": 0.2394893914461136, "kl": 0.018117700903888787, "entropy": 1.3290836177640042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1110000, "num_agent_steps_sampled": 1110000, "num_steps_trained": 1110000}, "done": false, "episodes_total": 1483, "training_iteration": 148, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-25-19", "timestamp": 1693794319, "time_this_iter_s": 11.9603431224823, "time_total_s": 1942.449120759964, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1942.449120759964, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 24.522222222222222, "ram_util_percent": 18.961111111111116}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 384.4565896821081, "episode_reward_mean": 479.8315353603026, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.02814683296054, 466.6649326445117, 457.7463134415301, 441.9720752770933, 509.25523925507423, 433.4866982940638, 430.1721504230639, 431.6948032329079, 434.24729645046824, 488.72269832489786, 411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.587676838948683, "mean_inference_ms": 0.7137102322419874, "mean_action_processing_ms": 0.0673936620400508, "mean_env_wait_ms": 3.5803926770289394, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1117500, "agent_timesteps_total": 1117500, "timers": {"sample_time_ms": 6890.401, "sample_throughput": 1088.471, "learn_time_ms": 5616.831, "learn_throughput": 1335.272, "update_time_ms": 2.397}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1360.3530183436508, "policy_loss": -0.0037119388509289186, "vf_loss": 1360.3567140740863, "vf_explained_var": 0.3062154948711395, "kl": 0.01901811130105154, "entropy": 1.1782607166443841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1117500, "num_agent_steps_sampled": 1117500, "num_steps_trained": 1117500}, "done": false, "episodes_total": 1493, "training_iteration": 149, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-25-31", "timestamp": 1693794331, "time_this_iter_s": 11.951467037200928, "time_total_s": 1954.400587797165, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1954.400587797165, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 25.629411764705882, "ram_util_percent": 18.952941176470592}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 481.8943536364846, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [411.37232265954754, 471.3544618254047, 393.3062730991205, 492.7288331331659, 512.556083887393, 407.65729329711974, 461.0927846723253, 492.62681146280295, 457.69668113946585, 448.1715608614766, 473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.583449221996825, "mean_inference_ms": 0.7136780864888931, "mean_action_processing_ms": 0.06739026633473558, "mean_env_wait_ms": 3.57870085907595, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1125000, "agent_timesteps_total": 1125000, "timers": {"sample_time_ms": 6876.85, "sample_throughput": 1090.616, "learn_time_ms": 5614.826, "learn_throughput": 1335.749, "update_time_ms": 2.354}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1475.1100630937997, "policy_loss": -0.0037027216745319507, "vf_loss": 1475.113748427569, "vf_explained_var": 0.19628454744815826, "kl": 0.02231096267399685, "entropy": 1.0159799435381163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1125000, "num_agent_steps_sampled": 1125000, "num_steps_trained": 1125000}, "done": false, "episodes_total": 1503, "training_iteration": 150, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-25-43", "timestamp": 1693794343, "time_this_iter_s": 12.413062334060669, "time_total_s": 1966.8136501312256, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1966.8136501312256, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 24.022222222222226, "ram_util_percent": 18.94444444444445}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 485.3481102708361, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [473.85551351382446, 504.04947725589614, 499.6049368120978, 478.1785942297701, 428.0188559763088, 496.4363475645996, 457.0307307279321, 425.39373364272626, 468.5606714863988, 502.9352233151138, 437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.579226459801445, "mean_inference_ms": 0.7136337397681233, "mean_action_processing_ms": 0.06738614728104574, "mean_env_wait_ms": 3.576886282252986, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1132500, "agent_timesteps_total": 1132500, "timers": {"sample_time_ms": 6820.599, "sample_throughput": 1099.61, "learn_time_ms": 5619.482, "learn_throughput": 1334.643, "update_time_ms": 2.221}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1365.288750341383, "policy_loss": -0.002357232823999504, "vf_loss": 1365.2910911947995, "vf_explained_var": 0.2650054395198822, "kl": 0.021311797551989545, "entropy": 0.9173358297449047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1132500, "num_agent_steps_sampled": 1132500, "num_steps_trained": 1132500}, "done": false, "episodes_total": 1513, "training_iteration": 151, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-25-56", "timestamp": 1693794356, "time_this_iter_s": 12.569599628448486, "time_total_s": 1979.383249759674, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1979.383249759674, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 24.038888888888888, "ram_util_percent": 18.950000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 486.65543974603474, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [437.9421278639592, 499.2235086262237, 479.0769106580023, 414.1184181229946, 496.90628235566066, 462.46598914556796, 460.9969240180136, 500.6576562278319, 482.158388554328, 497.8093194527916, 408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.575671013667812, "mean_inference_ms": 0.7135494775924687, "mean_action_processing_ms": 0.06737867861262829, "mean_env_wait_ms": 3.5749504606576306, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1140000, "agent_timesteps_total": 1140000, "timers": {"sample_time_ms": 6913.374, "sample_throughput": 1084.854, "learn_time_ms": 5618.822, "learn_throughput": 1334.799, "update_time_ms": 2.204}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1383.5715872037208, "policy_loss": -0.0036372299290309516, "vf_loss": 1383.5752147092658, "vf_explained_var": 0.28708481788635254, "kl": 0.017639826682063, "entropy": 1.1362672143063304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1140000, "num_agent_steps_sampled": 1140000, "num_steps_trained": 1140000}, "done": false, "episodes_total": 1523, "training_iteration": 152, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-26-10", "timestamp": 1693794370, "time_this_iter_s": 13.735984563827515, "time_total_s": 1993.1192343235016, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 1993.1192343235016, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 22.725, "ram_util_percent": 18.920000000000005}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 485.0813828022924, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [408.53031240592713, 494.28301521751064, 512.9674008296661, 463.46340044592813, 502.9000632562722, 521.7246473974488, 492.4828906541827, 463.0015601213125, 511.6020848562716, 486.3884113137099, 517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.571679020423699, "mean_inference_ms": 0.7134669257206415, "mean_action_processing_ms": 0.06737164612435972, "mean_env_wait_ms": 3.57315953181308, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1147500, "agent_timesteps_total": 1147500, "timers": {"sample_time_ms": 6849.807, "sample_throughput": 1094.921, "learn_time_ms": 5624.276, "learn_throughput": 1333.505, "update_time_ms": 2.176}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1475.3131271620928, "policy_loss": -0.004689364330211686, "vf_loss": 1475.3177917480468, "vf_explained_var": 0.18104419112205505, "kl": 0.02099790210941469, "entropy": 1.0068956456699614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1147500, "num_agent_steps_sampled": 1147500, "num_steps_trained": 1147500}, "done": false, "episodes_total": 1533, "training_iteration": 153, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-26-22", "timestamp": 1693794382, "time_this_iter_s": 12.196343898773193, "time_total_s": 2005.3155782222748, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2005.3155782222748, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 29.405882352941177, "ram_util_percent": 18.98823529411765}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 484.11434646252644, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [517.7475330704889, 494.09950412250674, 519.0601782312169, 482.57497381816813, 484.60625901431894, 503.788758805931, 485.6981303239232, 507.60494184590306, 495.440112619603, 517.8336339870503, 384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.568447664780145, "mean_inference_ms": 0.7133742831206892, "mean_action_processing_ms": 0.06736362004767688, "mean_env_wait_ms": 3.5714121096084135, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1155000, "agent_timesteps_total": 1155000, "timers": {"sample_time_ms": 6940.785, "sample_throughput": 1080.569, "learn_time_ms": 5629.915, "learn_throughput": 1332.169, "update_time_ms": 2.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1447.63096680722, "policy_loss": -0.00196156564042351, "vf_loss": 1447.6329124321371, "vf_explained_var": 0.2171603888273239, "kl": 0.018712578143631687, "entropy": 0.8472575886269748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1155000, "num_agent_steps_sampled": 1155000, "num_steps_trained": 1155000}, "done": false, "episodes_total": 1543, "training_iteration": 154, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-26-35", "timestamp": 1693794395, "time_this_iter_s": 12.921043395996094, "time_total_s": 2018.2366216182709, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2018.2366216182709, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 25.563157894736847, "ram_util_percent": 18.973684210526322}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.9665386013161, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 483.0440609808499, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.4565896821081, 519.2134850731231, 523.9098789531674, 394.18605962830895, 501.6490824132169, 525.2107452769471, 525.9665386013161, 515.0024258119976, 499.1057460392614, 389.0926691618306, 507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.565578067856002, "mean_inference_ms": 0.7132714172354756, "mean_action_processing_ms": 0.06735487370152442, "mean_env_wait_ms": 3.569655277532383, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1162500, "agent_timesteps_total": 1162500, "timers": {"sample_time_ms": 6973.486, "sample_throughput": 1075.502, "learn_time_ms": 5631.304, "learn_throughput": 1331.841, "update_time_ms": 2.168}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1414.3164844060348, "policy_loss": -0.0036479635539038453, "vf_loss": 1414.3201131012481, "vf_explained_var": 0.21021027863025665, "kl": 0.02417632631140676, "entropy": 0.6456697505788278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1162500, "num_agent_steps_sampled": 1162500, "num_steps_trained": 1162500}, "done": false, "episodes_total": 1553, "training_iteration": 155, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-26-48", "timestamp": 1693794408, "time_this_iter_s": 12.409728288650513, "time_total_s": 2030.6463499069214, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2030.6463499069214, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 24.4, "ram_util_percent": 18.961111111111116}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8538225089143, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 484.07235741297836, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [507.3326972567266, 508.25379362312964, 475.67017913764596, 460.8994450967349, 502.89624792353425, 501.7607948243404, 514.7923882783584, 520.9467465736953, 515.3357579497105, 510.03443971038377, 442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.563063310897657, "mean_inference_ms": 0.713149984945903, "mean_action_processing_ms": 0.06734454461700011, "mean_env_wait_ms": 3.5678895590088087, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1170000, "agent_timesteps_total": 1170000, "timers": {"sample_time_ms": 7016.449, "sample_throughput": 1068.917, "learn_time_ms": 5638.459, "learn_throughput": 1330.151, "update_time_ms": 2.118}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1391.75524059231, "policy_loss": -0.004135065002493181, "vf_loss": 1391.7593662585243, "vf_explained_var": 0.24726076424121857, "kl": 0.020838845504637517, "entropy": 0.6423210969573613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1170000, "num_agent_steps_sampled": 1170000, "num_steps_trained": 1170000}, "done": false, "episodes_total": 1563, "training_iteration": 156, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-27-00", "timestamp": 1693794420, "time_this_iter_s": 12.472474098205566, "time_total_s": 2043.118824005127, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2043.118824005127, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 24.177777777777777, "ram_util_percent": 18.961111111111116}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.8538225089143, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 482.34916164006916, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [442.38675361522223, 523.8538225089143, 434.14586960960906, 502.1431418782911, 494.02804104149294, 508.40058195963917, 467.5185484416548, 497.4118409368961, 519.2049554840593, 444.0343150525483, 442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.559642190197373, "mean_inference_ms": 0.7130425641785091, "mean_action_processing_ms": 0.06733519437279235, "mean_env_wait_ms": 3.5662051263180894, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1177500, "agent_timesteps_total": 1177500, "timers": {"sample_time_ms": 6894.967, "sample_throughput": 1087.75, "learn_time_ms": 5644.242, "learn_throughput": 1328.788, "update_time_ms": 2.005}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1447.407337563725, "policy_loss": -0.0016697310716292616, "vf_loss": 1447.4089907371392, "vf_explained_var": 0.21625445783138275, "kl": 0.019384578080508738, "entropy": 0.8053249183600232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1177500, "num_agent_steps_sampled": 1177500, "num_steps_trained": 1177500}, "done": false, "episodes_total": 1573, "training_iteration": 157, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-27-13", "timestamp": 1693794433, "time_this_iter_s": 12.84093451499939, "time_total_s": 2055.9597585201263, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2055.9597585201263, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 22.810526315789474, "ram_util_percent": 18.947368421052637}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.5066076286272, "episode_reward_min": 264.7573945316271, "episode_reward_mean": 480.3441974142494, "episode_len_mean": 746.34, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [442.6024623864427, 517.4105395172692, 506.64424656527297, 510.80624570089446, 509.887987133828, 496.74283725385106, 508.0041358845161, 477.8244099936395, 501.15589796796826, 440.46030998092647, 514.1946086698825, 520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.556796701371599, "mean_inference_ms": 0.7129385135994357, "mean_action_processing_ms": 0.06732575470255436, "mean_env_wait_ms": 3.5645818794897703, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1185000, "agent_timesteps_total": 1185000, "timers": {"sample_time_ms": 6933.876, "sample_throughput": 1081.646, "learn_time_ms": 5654.287, "learn_throughput": 1326.427, "update_time_ms": 1.889}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1406.325543005992, "policy_loss": -0.006073044388854908, "vf_loss": 1406.3316037970073, "vf_explained_var": 0.2335565835237503, "kl": 0.02141915477755095, "entropy": 0.7177719763022358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1185000, "num_agent_steps_sampled": 1185000, "num_steps_trained": 1185000}, "done": false, "episodes_total": 1583, "training_iteration": 158, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-27-26", "timestamp": 1693794446, "time_this_iter_s": 12.448703050613403, "time_total_s": 2068.4084615707397, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2068.4084615707397, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 27.216666666666665, "ram_util_percent": 18.950000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.5066076286272, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 475.6483958321172, "episode_len_mean": 742.32, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0281016666769, 264.7573945316271, 447.2988462219646, 482.7757433149974, 521.6734043149894, 489.4996567350197, 513.5544174615826, 516.8668645939475, 498.62314428409223, 501.7215773047277, 492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295], "episode_lengths": [750, 384, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.554441277117792, "mean_inference_ms": 0.7128078762338196, "mean_action_processing_ms": 0.06731363601341916, "mean_env_wait_ms": 3.5628645324129153, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1192500, "agent_timesteps_total": 1192500, "timers": {"sample_time_ms": 7106.059, "sample_throughput": 1055.437, "learn_time_ms": 5661.666, "learn_throughput": 1324.698, "update_time_ms": 1.917}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1535.908278746524, "policy_loss": -0.0022758257397750424, "vf_loss": 1535.9105384438724, "vf_explained_var": 0.25096091628074646, "kl": 0.01981918236483221, "entropy": 0.7473353668163388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1192500, "num_agent_steps_sampled": 1192500, "num_steps_trained": 1192500}, "done": false, "episodes_total": 1594, "training_iteration": 159, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-27-40", "timestamp": 1693794460, "time_this_iter_s": 13.746418476104736, "time_total_s": 2082.1548800468445, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2082.1548800468445, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 25.115789473684217, "ram_util_percent": 18.978947368421057}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.5066076286272, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 477.39161992628084, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [492.68359741032765, 512.8287431182213, 491.6670425621316, 499.1954347129742, 456.79214153236205, 517.607909932381, 506.45048766305973, 453.28976150121605, 461.7020737355691, 512.1910250545509, 456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.555692956675926, "mean_inference_ms": 0.7126586944768833, "mean_action_processing_ms": 0.06730032950499067, "mean_env_wait_ms": 3.561253087269839, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1200000, "agent_timesteps_total": 1200000, "timers": {"sample_time_ms": 7543.113, "sample_throughput": 994.284, "learn_time_ms": 5670.445, "learn_throughput": 1322.648, "update_time_ms": 1.907}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1376.0958920753608, "policy_loss": -0.005615942714483304, "vf_loss": 1376.101492516469, "vf_explained_var": 0.2702576220035553, "kl": 0.02242496496593862, "entropy": 0.7608835893288507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1200000, "num_agent_steps_sampled": 1200000, "num_steps_trained": 1200000}, "done": false, "episodes_total": 1604, "training_iteration": 160, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-27-57", "timestamp": 1693794477, "time_this_iter_s": 16.87194538116455, "time_total_s": 2099.026825428009, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2099.026825428009, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 17.432, "ram_util_percent": 18.848000000000003}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.5066076286272, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 473.7276173352544, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [456.8702328699888, 496.81183138001865, 487.3241764771149, 481.59435800685765, 451.71366400641807, 452.84679977965425, 509.11467582067513, 504.32134850049647, 512.0089201487679, 475.2591822669376, 412.64701795201256, 386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.556532033066427, "mean_inference_ms": 0.7125119334017072, "mean_action_processing_ms": 0.06728747468629279, "mean_env_wait_ms": 3.5597330453868286, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1207500, "agent_timesteps_total": 1207500, "timers": {"sample_time_ms": 7524.13, "sample_throughput": 996.793, "learn_time_ms": 5675.958, "learn_throughput": 1321.363, "update_time_ms": 2.002}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1478.8404578257416, "policy_loss": -0.0056594958751841245, "vf_loss": 1478.8460985603979, "vf_explained_var": 0.18290738761425018, "kl": 0.02087157668737757, "entropy": 0.7109695221976203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1207500, "num_agent_steps_sampled": 1207500, "num_steps_trained": 1207500}, "done": false, "episodes_total": 1614, "training_iteration": 161, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-28-10", "timestamp": 1693794490, "time_this_iter_s": 12.435882806777954, "time_total_s": 2111.462708234787, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2111.462708234787, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 24.16111111111111, "ram_util_percent": 18.961111111111116}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 472.49507680536703, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.05413601548725, 454.4491224065733, 515.5968404812171, 494.51138004956664, 402.79968870419094, 505.0164781495349, 502.15386001312396, 425.4621246125012, 490.0412064255218, 439.4808698889851, 502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.554736442221415, "mean_inference_ms": 0.7123815485799804, "mean_action_processing_ms": 0.06726438865088671, "mean_env_wait_ms": 3.557850442690218, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1215000, "agent_timesteps_total": 1215000, "timers": {"sample_time_ms": 7480.084, "sample_throughput": 1002.663, "learn_time_ms": 5686.155, "learn_throughput": 1318.993, "update_time_ms": 1.943}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1426.1678039033534, "policy_loss": -0.006171801029625585, "vf_loss": 1426.1739515918796, "vf_explained_var": 0.308444619178772, "kl": 0.027423339767107494, "entropy": 0.6052381688760499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1215000, "num_agent_steps_sampled": 1215000, "num_steps_trained": 1215000}, "done": false, "episodes_total": 1625, "training_iteration": 162, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-28-23", "timestamp": 1693794503, "time_this_iter_s": 13.396130323410034, "time_total_s": 2124.858838558197, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2124.858838558197, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 23.336842105263155, "ram_util_percent": 19.042105263157897}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 472.85280305602845, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [502.1209495044183, 468.87487851154407, 480.15106566577737, 400.2521373359094, 481.8778994548627, 506.5603872639285, 490.252947455619, 501.0278110150629, 519.7483217157464, 436.5135985198028, 503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.555724615129461, "mean_inference_ms": 0.7122357320341125, "mean_action_processing_ms": 0.06725156166530065, "mean_env_wait_ms": 3.5562610191912953, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1222500, "agent_timesteps_total": 1222500, "timers": {"sample_time_ms": 7647.949, "sample_throughput": 980.655, "learn_time_ms": 5684.371, "learn_throughput": 1319.407, "update_time_ms": 1.936}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1465.621006231793, "policy_loss": -0.004154970984258768, "vf_loss": 1465.6251418291513, "vf_explained_var": 0.21428537368774414, "kl": 0.022107603976239898, "entropy": 0.5823476160671246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1222500, "num_agent_steps_sampled": 1222500, "num_steps_trained": 1222500}, "done": false, "episodes_total": 1635, "training_iteration": 163, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-28-37", "timestamp": 1693794517, "time_this_iter_s": 13.858389139175415, "time_total_s": 2138.7172276973724, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2138.7172276973724, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 24.110000000000003, "ram_util_percent": 19.014999999999997}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 473.38007971598324, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [503.5691769917097, 514.3109131438631, 523.5066076286272, 496.40967705230474, 430.61154459474614, 493.8755361518518, 479.66755059337515, 503.21255127942044, 399.10337226218326, 510.0484142129902, 495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.556346585427684, "mean_inference_ms": 0.712076483596083, "mean_action_processing_ms": 0.06723781693948751, "mean_env_wait_ms": 3.5545756428823214, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1230000, "agent_timesteps_total": 1230000, "timers": {"sample_time_ms": 7557.923, "sample_throughput": 992.336, "learn_time_ms": 5688.853, "learn_throughput": 1318.368, "update_time_ms": 1.888}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1329.2939835887844, "policy_loss": -0.004408557333399431, "vf_loss": 1329.2983761544956, "vf_explained_var": 0.30407869815826416, "kl": 0.023033285814227256, "entropy": 0.31346666287567654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1230000, "num_agent_steps_sampled": 1230000, "num_steps_trained": 1230000}, "done": false, "episodes_total": 1645, "training_iteration": 164, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-28-49", "timestamp": 1693794529, "time_this_iter_s": 12.064221858978271, "time_total_s": 2150.7814495563507, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2150.7814495563507, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 25.641176470588242, "ram_util_percent": 19.041176470588233}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 472.9241332926286, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [495.5409561651305, 425.83562976090997, 510.1918787778559, 499.96875201842425, 513.2576557215642, 514.7085685005654, 502.04861437472016, 509.91902205977993, 437.5235507741277, 498.788609018214, 448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.55759481138092, "mean_inference_ms": 0.7118995759003741, "mean_action_processing_ms": 0.06722381056779239, "mean_env_wait_ms": 3.5529516595260677, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1237500, "agent_timesteps_total": 1237500, "timers": {"sample_time_ms": 7710.411, "sample_throughput": 972.711, "learn_time_ms": 5691.901, "learn_throughput": 1317.662, "update_time_ms": 1.886}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1438.9343963623046, "policy_loss": -0.004557266828240984, "vf_loss": 1438.9389441021417, "vf_explained_var": 0.21475335955619812, "kl": 0.023257426752487643, "entropy": 0.44136203453891865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1237500, "num_agent_steps_sampled": 1237500, "num_steps_trained": 1237500}, "done": false, "episodes_total": 1655, "training_iteration": 165, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-29-04", "timestamp": 1693794544, "time_this_iter_s": 13.965944290161133, "time_total_s": 2164.747393846512, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2164.747393846512, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 24.876190476190477, "ram_util_percent": 19.023809523809522}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 474.27072031085567, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [448.9675167225471, 504.3983216249466, 484.78146335669254, 509.7987245627819, 443.1980539650681, 509.0265332509418, 509.2959463514711, 499.8241934565422, 443.2134657845218, 514.6403620564876, 422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5596751194042575, "mean_inference_ms": 0.7116964758936801, "mean_action_processing_ms": 0.06720787177497742, "mean_env_wait_ms": 3.5513000371973114, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1245000, "agent_timesteps_total": 1245000, "timers": {"sample_time_ms": 7853.663, "sample_throughput": 954.968, "learn_time_ms": 5695.654, "learn_throughput": 1316.793, "update_time_ms": 1.917}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1376.1325025655456, "policy_loss": -0.0022618686188391204, "vf_loss": 1376.1347452971895, "vf_explained_var": 0.2766765058040619, "kl": 0.027580450721316235, "entropy": 0.3021997212321829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1245000, "num_agent_steps_sampled": 1245000, "num_steps_trained": 1245000}, "done": false, "episodes_total": 1665, "training_iteration": 166, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-29-18", "timestamp": 1693794558, "time_this_iter_s": 13.942911863327026, "time_total_s": 2178.690305709839, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2178.690305709839, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 24.940000000000005, "ram_util_percent": 19.005}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 212.11733457298158, "episode_reward_mean": 473.6340881762065, "episode_len_mean": 741.96, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [422.11039333578174, 416.3433271529693, 497.65517878529306, 433.1256037979667, 518.7161496942341, 501.51301903115706, 416.92666275842623, 468.3872855495152, 453.10896689294196, 212.11733457298158, 503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.561960417908523, "mean_inference_ms": 0.7114612344608412, "mean_action_processing_ms": 0.06718973962216991, "mean_env_wait_ms": 3.5495773165301996, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1252500, "agent_timesteps_total": 1252500, "timers": {"sample_time_ms": 7947.847, "sample_throughput": 943.652, "learn_time_ms": 5696.641, "learn_throughput": 1316.565, "update_time_ms": 2.006}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1448.3734445862851, "policy_loss": -0.0031459699392760707, "vf_loss": 1448.376575276003, "vf_explained_var": 0.23864011466503143, "kl": 0.02291550654779867, "entropy": 0.36434794333684495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1252500, "num_agent_steps_sampled": 1252500, "num_steps_trained": 1252500}, "done": false, "episodes_total": 1675, "training_iteration": 167, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-29-32", "timestamp": 1693794572, "time_this_iter_s": 13.793845415115356, "time_total_s": 2192.484151124954, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2192.484151124954, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 23.115, "ram_util_percent": 19.025}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.0823795021493, "episode_reward_min": 218.79848152789324, "episode_reward_mean": 479.52299847254784, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [503.53368299112316, 510.18326203392337, 470.381391470603, 471.2715755021182, 490.49065728078995, 466.24998679573326, 492.4800419345572, 454.4876575434161, 431.84896582309295, 487.96425888537203, 473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5620651307426465, "mean_inference_ms": 0.7113725487848508, "mean_action_processing_ms": 0.06718521843045192, "mean_env_wait_ms": 3.5481303112445493, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1260000, "agent_timesteps_total": 1260000, "timers": {"sample_time_ms": 7931.932, "sample_throughput": 945.545, "learn_time_ms": 5701.76, "learn_throughput": 1315.383, "update_time_ms": 2.081}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1382.875472660388, "policy_loss": -0.0027984997407549013, "vf_loss": 1382.8782595359673, "vf_explained_var": 0.25732964277267456, "kl": 0.019185252549123125, "entropy": 0.2827165091410279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1260000, "num_agent_steps_sampled": 1260000, "num_steps_trained": 1260000}, "done": false, "episodes_total": 1685, "training_iteration": 168, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-29-44", "timestamp": 1693794584, "time_this_iter_s": 12.340704917907715, "time_total_s": 2204.824856042862, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2204.824856042862, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 24.638888888888893, "ram_util_percent": 19.055555555555557}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 218.79848152789324, "episode_reward_mean": 479.92830368768927, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [473.38563183708004, 508.40573190054596, 514.2306694672211, 429.4005178249105, 483.48957346757686, 508.23095412548867, 500.8791986516519, 513.6297901143561, 511.5052335717859, 425.1097619844408, 512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.564151057680813, "mean_inference_ms": 0.7110870054435142, "mean_action_processing_ms": 0.06716391807007892, "mean_env_wait_ms": 3.54629492797101, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1267500, "agent_timesteps_total": 1267500, "timers": {"sample_time_ms": 7959.584, "sample_throughput": 942.26, "learn_time_ms": 5703.33, "learn_throughput": 1315.021, "update_time_ms": 2.054}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1389.7047876907607, "policy_loss": -0.0022763598876042387, "vf_loss": 1389.7070448535983, "vf_explained_var": 0.29486268758773804, "kl": 0.02366749176203592, "entropy": 0.3884872063615565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1267500, "num_agent_steps_sampled": 1267500, "num_steps_trained": 1267500}, "done": false, "episodes_total": 1695, "training_iteration": 169, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-29-58", "timestamp": 1693794598, "time_this_iter_s": 14.038156986236572, "time_total_s": 2218.8630130290985, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2218.8630130290985, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 25.585, "ram_util_percent": 19.029999999999998}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 218.79848152789324, "episode_reward_mean": 480.7754431617149, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [512.6866592735137, 474.1499023204682, 473.80651715845477, 405.9107510320199, 382.94354328799005, 450.25604508468126, 476.4715677391255, 491.77478574251256, 444.89842449694265, 480.033429578577, 525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.562711221147773, "mean_inference_ms": 0.7108015429945053, "mean_action_processing_ms": 0.06714226503839421, "mean_env_wait_ms": 3.54458108889416, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1275000, "agent_timesteps_total": 1275000, "timers": {"sample_time_ms": 7624.902, "sample_throughput": 983.619, "learn_time_ms": 5706.839, "learn_throughput": 1314.213, "update_time_ms": 2.109}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1351.710220336914, "policy_loss": -0.0056720254287691944, "vf_loss": 1351.715881037308, "vf_explained_var": 0.2951819598674774, "kl": 0.022398290800481516, "entropy": 0.2302581576362126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1275000, "num_agent_steps_sampled": 1275000, "num_steps_trained": 1275000}, "done": false, "episodes_total": 1705, "training_iteration": 170, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-30-12", "timestamp": 1693794612, "time_this_iter_s": 13.559946060180664, "time_total_s": 2232.422959089279, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2232.422959089279, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 26.33157894736842, "ram_util_percent": 19.073684210526316}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 218.79848152789324, "episode_reward_mean": 484.913145052756, "episode_len_mean": 745.98, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [525.0823795021493, 502.387739476903, 507.83026940331615, 494.6296555591451, 504.6243087718213, 456.85419602366517, 505.1555528793913, 465.71973374061673, 456.14240775672755, 218.79848152789324, 394.9984887451781, 495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 348, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.561793131224118, "mean_inference_ms": 0.7105055845153565, "mean_action_processing_ms": 0.06711960623832579, "mean_env_wait_ms": 3.542885243047984, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1282500, "agent_timesteps_total": 1282500, "timers": {"sample_time_ms": 7765.645, "sample_throughput": 965.792, "learn_time_ms": 5708.373, "learn_throughput": 1313.859, "update_time_ms": 2.171}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1445.1643635895293, "policy_loss": -0.004014423526665669, "vf_loss": 1445.1683619095106, "vf_explained_var": 0.2699258029460907, "kl": 0.021663489426245828, "entropy": 0.2675334293269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1282500, "num_agent_steps_sampled": 1282500, "num_steps_trained": 1282500}, "done": false, "episodes_total": 1715, "training_iteration": 171, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-30-26", "timestamp": 1693794626, "time_this_iter_s": 13.859572649002075, "time_total_s": 2246.2825317382812, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2246.2825317382812, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 26.185000000000002, "ram_util_percent": 19.24}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 483.438224247987, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [495.3089396191755, 514.6160804462296, 387.1008413288359, 517.5047329917774, 467.429816928126, 470.9578388563644, 481.4749991688858, 446.1246596217744, 475.8219341064836, 490.4466076516812, 490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5627187788910115, "mean_inference_ms": 0.7101763712287388, "mean_action_processing_ms": 0.06710615894575148, "mean_env_wait_ms": 3.541329465180792, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1290000, "agent_timesteps_total": 1290000, "timers": {"sample_time_ms": 7760.507, "sample_throughput": 966.432, "learn_time_ms": 5705.757, "learn_throughput": 1314.462, "update_time_ms": 2.171}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1676.0305652683064, "policy_loss": -0.0029741754408104944, "vf_loss": 1676.033533025192, "vf_explained_var": 0.17828619480133057, "kl": 0.020275814348528272, "entropy": 0.44467623856044924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1290000, "num_agent_steps_sampled": 1290000, "num_steps_trained": 1290000}, "done": false, "episodes_total": 1726, "training_iteration": 172, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-30-40", "timestamp": 1693794640, "time_this_iter_s": 13.3192880153656, "time_total_s": 2259.601819753647, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2259.601819753647, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 24.855, "ram_util_percent": 19.244999999999997}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 483.04223449975797, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.21179705461645, 497.0861409816977, 464.7414646479373, 463.36629136909266, 467.7873160386319, 510.6305596774737, 454.74012704944437, 489.39107718260635, 511.7062807849812, 456.4064037273964, 431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5612230103541656, "mean_inference_ms": 0.7098774681221682, "mean_action_processing_ms": 0.06708328511387232, "mean_env_wait_ms": 3.5396520224102095, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1297500, "agent_timesteps_total": 1297500, "timers": {"sample_time_ms": 7584.122, "sample_throughput": 988.908, "learn_time_ms": 5713.583, "learn_throughput": 1312.661, "update_time_ms": 2.2}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1445.9299491235765, "policy_loss": -0.0037005380545821736, "vf_loss": 1445.933635776326, "vf_explained_var": 0.22587800025939941, "kl": 0.023599951749596792, "entropy": 0.31624669015754836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1297500, "num_agent_steps_sampled": 1297500, "num_steps_trained": 1297500}, "done": false, "episodes_total": 1736, "training_iteration": 173, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-30-52", "timestamp": 1693794652, "time_this_iter_s": 12.174023389816284, "time_total_s": 2271.775843143463, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2271.775843143463, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 27.852941176470587, "ram_util_percent": 19.235294117647054}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 483.9695159094162, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [431.2681699042686, 498.08694438471167, 446.027629934507, 515.2400558260165, 417.4594759102444, 516.4637257157683, 505.67096959399726, 518.4812511865173, 503.6160753921813, 514.3094818383969, 512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.560549145181216, "mean_inference_ms": 0.7095480547724639, "mean_action_processing_ms": 0.06705754114584754, "mean_env_wait_ms": 3.537881642352934, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1305000, "agent_timesteps_total": 1305000, "timers": {"sample_time_ms": 7758.856, "sample_throughput": 966.637, "learn_time_ms": 5714.726, "learn_throughput": 1312.399, "update_time_ms": 2.206}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1335.2090916520458, "policy_loss": -0.006095942394744794, "vf_loss": 1335.2151685811705, "vf_explained_var": 0.30316299200057983, "kl": 0.023838333887841567, "entropy": 0.2628709495651646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1305000, "num_agent_steps_sampled": 1305000, "num_steps_trained": 1305000}, "done": false, "episodes_total": 1746, "training_iteration": 174, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-31-06", "timestamp": 1693794666, "time_this_iter_s": 13.823832035064697, "time_total_s": 2285.599675178528, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2285.599675178528, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 21.725, "ram_util_percent": 19.199999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 482.75347979065936, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [512.8050330777169, 484.9581437158667, 502.26190492980703, 498.38884600507777, 471.22056895148, 517.6433929873901, 507.01498800611256, 511.5404419438707, 522.2991375382769, 478.9263857667165, 441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.560137392682496, "mean_inference_ms": 0.7091818879249768, "mean_action_processing_ms": 0.06702798534584549, "mean_env_wait_ms": 3.535938408900396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1312500, "agent_timesteps_total": 1312500, "timers": {"sample_time_ms": 7745.671, "sample_throughput": 968.283, "learn_time_ms": 5718.793, "learn_throughput": 1311.465, "update_time_ms": 2.195}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1430.3640543792208, "policy_loss": -0.004171064002360454, "vf_loss": 1430.3682145458156, "vf_explained_var": 0.2203356772661209, "kl": 0.02277226924498677, "entropy": 0.42185763391287273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1312500, "num_agent_steps_sampled": 1312500, "num_steps_trained": 1312500}, "done": false, "episodes_total": 1756, "training_iteration": 175, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-31-20", "timestamp": 1693794680, "time_this_iter_s": 13.874320268630981, "time_total_s": 2299.473995447159, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2299.473995447159, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 19.47, "ram_util_percent": 19.194999999999993}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.4376143764133, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 481.3104296902743, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [441.49781864228333, 480.9793857419118, 461.92625479772875, 456.4460411108854, 511.02668868288873, 504.36371420227255, 441.23943619359653, 511.6981813865635, 515.3774611422411, 510.750748408895, 500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.558652217109116, "mean_inference_ms": 0.7088483705380141, "mean_action_processing_ms": 0.06700053562431803, "mean_env_wait_ms": 3.534049465146916, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1320000, "agent_timesteps_total": 1320000, "timers": {"sample_time_ms": 7539.179, "sample_throughput": 994.803, "learn_time_ms": 5716.289, "learn_throughput": 1312.04, "update_time_ms": 2.184}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1421.5074657892776, "policy_loss": -0.0028423220448006515, "vf_loss": 1421.510289234226, "vf_explained_var": 0.21307514607906342, "kl": 0.02413168505043353, "entropy": 0.37063637286172074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1320000, "num_agent_steps_sampled": 1320000, "num_steps_trained": 1320000}, "done": false, "episodes_total": 1766, "training_iteration": 176, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-31-32", "timestamp": 1693794692, "time_this_iter_s": 11.854358196258545, "time_total_s": 2311.3283536434174, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2311.3283536434174, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 26.44117647058824, "ram_util_percent": 19.264705882352942}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 480.90411566012006, "episode_len_mean": 745.59, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.65673967432275, 483.5614656010318, 515.0112450343291, 514.4155337447505, 513.4851472550644, 461.21383288198564, 432.6063632252841, 492.6067212717547, 504.5871541079771, 498.0157381296195, 439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.557065129609679, "mean_inference_ms": 0.7085142158327271, "mean_action_processing_ms": 0.06697293091531828, "mean_env_wait_ms": 3.5321689410151396, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1327500, "agent_timesteps_total": 1327500, "timers": {"sample_time_ms": 7521.884, "sample_throughput": 997.091, "learn_time_ms": 5716.142, "learn_throughput": 1312.074, "update_time_ms": 2.167}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1450.0828407934157, "policy_loss": -0.002947628894284115, "vf_loss": 1450.085770791264, "vf_explained_var": 0.1864750236272812, "kl": 0.017979154553781632, "entropy": 0.5818396116306974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1327500, "num_agent_steps_sampled": 1327500, "num_steps_trained": 1327500}, "done": false, "episodes_total": 1776, "training_iteration": 177, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-31-46", "timestamp": 1693794706, "time_this_iter_s": 13.620248556137085, "time_total_s": 2324.9486021995544, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2324.9486021995544, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 20.25, "ram_util_percent": 19.224999999999994}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 478.7652472602174, "episode_len_mean": 744.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [439.8371671349739, 503.0617171778638, 438.2078747512334, 510.0429681214611, 489.8710981880538, 527.4376143764133, 424.3999792319084, 509.9075612359214, 478.6402834274102, 504.30472685417743, 506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.555757385836557, "mean_inference_ms": 0.7081835771692954, "mean_action_processing_ms": 0.06694548732728331, "mean_env_wait_ms": 3.53038860017635, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1335000, "agent_timesteps_total": 1335000, "timers": {"sample_time_ms": 7649.076, "sample_throughput": 980.511, "learn_time_ms": 5717.553, "learn_throughput": 1311.75, "update_time_ms": 2.187}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1373.1477543717724, "policy_loss": -0.003986790130640996, "vf_loss": 1373.1517211914063, "vf_explained_var": 0.25979670882225037, "kl": 0.023030158996587745, "entropy": 0.5114166989575251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1335000, "num_agent_steps_sampled": 1335000, "num_steps_trained": 1335000}, "done": false, "episodes_total": 1786, "training_iteration": 178, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-32-00", "timestamp": 1693794720, "time_this_iter_s": 13.626938581466675, "time_total_s": 2338.575540781021, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2338.575540781021, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 26.950000000000006, "ram_util_percent": 19.229999999999997}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 480.09708715075016, "episode_len_mean": 744.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [506.16612944534614, 507.7536154448601, 517.3589204515546, 448.47398168459875, 497.9410406458807, 498.4855902990366, 467.3552768354757, 501.54655635641603, 503.59517233028805, 518.3685994179334, 491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.554068675378432, "mean_inference_ms": 0.707867708762754, "mean_action_processing_ms": 0.06691920507295956, "mean_env_wait_ms": 3.528562426225287, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1342500, "agent_timesteps_total": 1342500, "timers": {"sample_time_ms": 7506.041, "sample_throughput": 999.195, "learn_time_ms": 5721.784, "learn_throughput": 1310.78, "update_time_ms": 2.179}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1370.4326392739506, "policy_loss": -0.0033103048832992376, "vf_loss": 1370.435932017181, "vf_explained_var": 0.27592453360557556, "kl": 0.024171178788020994, "entropy": 0.2651248615898066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1342500, "num_agent_steps_sampled": 1342500, "num_steps_trained": 1342500}, "done": false, "episodes_total": 1796, "training_iteration": 179, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-32-12", "timestamp": 1693794732, "time_this_iter_s": 12.649705410003662, "time_total_s": 2351.225246191025, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2351.225246191025, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 23.561111111111114, "ram_util_percent": 19.222222222222218}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 476.80477373420763, "episode_len_mean": 744.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [491.51360286192823, 506.44384835113965, 518.0905529371087, 501.0164356552423, 516.0377842635916, 446.74792998201406, 502.3253210774493, 497.76497319086576, 508.39276708112703, 486.1703480948709, 515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.552210194466987, "mean_inference_ms": 0.7075546132537254, "mean_action_processing_ms": 0.0668940115169222, "mean_env_wait_ms": 3.5267474616855434, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1350000, "agent_timesteps_total": 1350000, "timers": {"sample_time_ms": 7367.753, "sample_throughput": 1017.949, "learn_time_ms": 5726.304, "learn_throughput": 1309.745, "update_time_ms": 2.157}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1436.1188126903469, "policy_loss": -0.004884332170615257, "vf_loss": 1436.123679157839, "vf_explained_var": 0.2324536293745041, "kl": 0.022956483148904933, "entropy": 0.4607964079937566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1350000, "num_agent_steps_sampled": 1350000, "num_steps_trained": 1350000}, "done": false, "episodes_total": 1806, "training_iteration": 180, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-32-25", "timestamp": 1693794745, "time_this_iter_s": 12.22168779373169, "time_total_s": 2363.4469339847565, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2363.4469339847565, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 28.688888888888886, "ram_util_percent": 19.255555555555553}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 213.44946090016182, "episode_reward_mean": 475.93219512568686, "episode_len_mean": 744.8, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.828586240381, 213.44946090016182, 436.3329797999808, 466.0122003474037, 508.16665368616157, 498.9635603063895, 461.3703915276022, 394.7232960312277, 488.6497045160278, 415.0639514596997, 487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548], "episode_lengths": [750, 309, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.550198403802463, "mean_inference_ms": 0.7072486381320318, "mean_action_processing_ms": 0.06686934712544915, "mean_env_wait_ms": 3.5249515522786488, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1357500, "agent_timesteps_total": 1357500, "timers": {"sample_time_ms": 7211.812, "sample_throughput": 1039.961, "learn_time_ms": 5724.403, "learn_throughput": 1310.18, "update_time_ms": 2.071}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1428.960674014334, "policy_loss": -0.0033834220218014414, "vf_loss": 1428.9640429997849, "vf_explained_var": 0.2539896070957184, "kl": 0.0282634734332597, "entropy": 0.20629844505781844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1357500, "num_agent_steps_sampled": 1357500, "num_steps_trained": 1357500}, "done": false, "episodes_total": 1816, "training_iteration": 181, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-32-37", "timestamp": 1693794757, "time_this_iter_s": 12.2808096408844, "time_total_s": 2375.727743625641, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2375.727743625641, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 27.083333333333332, "ram_util_percent": 19.21111111111111}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 383.5962778251463, "episode_reward_mean": 482.7457933853448, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [487.69322860745876, 515.0769427013981, 444.229076605874, 383.5962778251463, 501.74782135617755, 472.2603935160063, 403.96758199740583, 512.158358965708, 466.5968844556418, 519.8609098656145, 518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.549123595308754, "mean_inference_ms": 0.7068020833434575, "mean_action_processing_ms": 0.06682742803631546, "mean_env_wait_ms": 3.5226764671007227, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1365000, "agent_timesteps_total": 1365000, "timers": {"sample_time_ms": 7142.916, "sample_throughput": 1049.991, "learn_time_ms": 5732.392, "learn_throughput": 1308.354, "update_time_ms": 2.074}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1399.7655536716268, "policy_loss": -0.002798491823723761, "vf_loss": 1399.7683326333256, "vf_explained_var": 0.26237431168556213, "kl": 0.023865227050481743, "entropy": -0.11561344324816335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1365000, "num_agent_steps_sampled": 1365000, "num_steps_trained": 1365000}, "done": false, "episodes_total": 1826, "training_iteration": 182, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-32-50", "timestamp": 1693794770, "time_this_iter_s": 12.71055817604065, "time_total_s": 2388.4383018016815, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2388.4383018016815, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 23.444444444444446, "ram_util_percent": 19.23333333333333}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 484.86488210051175, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.9896528834796, 480.90902742931087, 518.238014497873, 503.141349963556, 501.1001658706086, 514.5411193236628, 470.9120626997721, 504.0832945718483, 449.88528729856046, 436.99562494102395, 514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5470236789115805, "mean_inference_ms": 0.7065330209621533, "mean_action_processing_ms": 0.06680125872663173, "mean_env_wait_ms": 3.520799794981919, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1372500, "agent_timesteps_total": 1372500, "timers": {"sample_time_ms": 7172.006, "sample_throughput": 1045.732, "learn_time_ms": 5736.862, "learn_throughput": 1307.335, "update_time_ms": 2.102}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1491.7470436225503, "policy_loss": -0.0040227599947129265, "vf_loss": 1491.7510497012381, "vf_explained_var": 0.24318739771842957, "kl": 0.024931210505438964, "entropy": 0.031670061177554366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1372500, "num_agent_steps_sampled": 1372500, "num_steps_trained": 1372500}, "done": false, "episodes_total": 1836, "training_iteration": 183, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-33-03", "timestamp": 1693794783, "time_this_iter_s": 12.509447574615479, "time_total_s": 2400.947749376297, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2400.947749376297, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 27.038888888888888, "ram_util_percent": 19.261111111111106}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 485.625324467121, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.9300328930572, 482.78102376392013, 516.1368751662817, 511.71237474076804, 416.38792605111064, 503.74369206790004, 415.1511292024951, 463.27356985659327, 515.5948076595301, 405.3087364092691, 496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.544103345925458, "mean_inference_ms": 0.7062763830178818, "mean_action_processing_ms": 0.06677646375587849, "mean_env_wait_ms": 3.5189474006484676, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1380000, "agent_timesteps_total": 1380000, "timers": {"sample_time_ms": 6996.507, "sample_throughput": 1071.964, "learn_time_ms": 5740.039, "learn_throughput": 1306.611, "update_time_ms": 2.089}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1483.9305335093352, "policy_loss": -0.00232625092928282, "vf_loss": 1483.9328495348914, "vf_explained_var": 0.20835068821907043, "kl": 0.02334086021287122, "entropy": -0.078126465355567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1380000, "num_agent_steps_sampled": 1380000, "num_steps_trained": 1380000}, "done": false, "episodes_total": 1846, "training_iteration": 184, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-33-15", "timestamp": 1693794795, "time_this_iter_s": 12.100098371505737, "time_total_s": 2413.0478477478027, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2413.0478477478027, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 23.18235294117647, "ram_util_percent": 19.24705882352941}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 488.3587935708107, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [496.83253294816615, 506.8860432526074, 507.0627653987145, 446.72867359072615, 498.7055329054796, 437.49825653985386, 519.1587004518025, 428.0942628522811, 497.94893974846457, 523.8381251957146, 474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.540493882237043, "mean_inference_ms": 0.7060534366762781, "mean_action_processing_ms": 0.06675456823556856, "mean_env_wait_ms": 3.5172650924854647, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1387500, "agent_timesteps_total": 1387500, "timers": {"sample_time_ms": 6872.668, "sample_throughput": 1091.279, "learn_time_ms": 5745.875, "learn_throughput": 1305.284, "update_time_ms": 2.116}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1490.5688368457859, "policy_loss": -0.0025760890537146796, "vf_loss": 1490.5713944774564, "vf_explained_var": 0.2215404212474823, "kl": 0.020841315940887988, "entropy": 0.06288268486100991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1387500, "num_agent_steps_sampled": 1387500, "num_steps_trained": 1387500}, "done": false, "episodes_total": 1856, "training_iteration": 185, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-33-28", "timestamp": 1693794808, "time_this_iter_s": 12.693764448165894, "time_total_s": 2425.7416121959686, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2425.7416121959686, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 25.531578947368423, "ram_util_percent": 19.252631578947366}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 532.1749617238776, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 489.9183304341608, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [474.16676363226003, 509.2726995927053, 461.368857096299, 532.1749617238776, 507.1403941617109, 413.2167281996333, 430.44279589160385, 497.43429762144564, 473.82070488974244, 495.6361244845602, 497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5372691418089826, "mean_inference_ms": 0.7058207278458517, "mean_action_processing_ms": 0.06673250684912511, "mean_env_wait_ms": 3.5155702108437215, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1395000, "agent_timesteps_total": 1395000, "timers": {"sample_time_ms": 6931.745, "sample_throughput": 1081.979, "learn_time_ms": 5747.179, "learn_throughput": 1304.988, "update_time_ms": 2.098}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1503.7710339562368, "policy_loss": -0.002147356614123209, "vf_loss": 1503.7731606693592, "vf_explained_var": 0.18303082883358002, "kl": 0.025796024107559063, "entropy": -0.019170451041121604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1395000, "num_agent_steps_sampled": 1395000, "num_steps_trained": 1395000}, "done": false, "episodes_total": 1866, "training_iteration": 186, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-33-41", "timestamp": 1693794821, "time_this_iter_s": 12.45676589012146, "time_total_s": 2438.19837808609, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2438.19837808609, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 26.766666666666666, "ram_util_percent": 19.249999999999996}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 492.1642547184193, "episode_len_mean": 749.21, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [497.79758414152025, 517.6808826895783, 498.00756618901937, 420.9774702441036, 444.47582699956087, 507.04628249299975, 445.5947648791812, 435.1843579830483, 504.4222082768307, 431.08615704001187, 518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 671, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.533683478609437, "mean_inference_ms": 0.7056173386209124, "mean_action_processing_ms": 0.06671273258655777, "mean_env_wait_ms": 3.513941711109009, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1402500, "agent_timesteps_total": 1402500, "timers": {"sample_time_ms": 6776.963, "sample_throughput": 1106.69, "learn_time_ms": 5753.347, "learn_throughput": 1303.589, "update_time_ms": 2.122}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1422.9443749379304, "policy_loss": -0.0012319199661961046, "vf_loss": 1422.9455886582198, "vf_explained_var": 0.25451236963272095, "kl": 0.017989029270418087, "entropy": -0.029800151591583834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1402500, "num_agent_steps_sampled": 1402500, "num_steps_trained": 1402500}, "done": false, "episodes_total": 1876, "training_iteration": 187, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-33-53", "timestamp": 1693794833, "time_this_iter_s": 12.133301019668579, "time_total_s": 2450.3316791057587, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2450.3316791057587, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 25.158823529411766, "ram_util_percent": 19.241176470588233}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 493.39733514895573, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.7453642356777, 471.9337013460402, 466.3340249527274, 515.0285778523805, 497.4451236095483, 491.6895371612977, 512.4311666259825, 466.59710299108923, 514.2219428714407, 504.46843790651167, 436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.529878254728292, "mean_inference_ms": 0.7054170579305299, "mean_action_processing_ms": 0.06669321160502234, "mean_env_wait_ms": 3.512319604335778, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1410000, "agent_timesteps_total": 1410000, "timers": {"sample_time_ms": 6681.039, "sample_throughput": 1122.58, "learn_time_ms": 5756.317, "learn_throughput": 1302.916, "update_time_ms": 2.145}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1359.3400499246889, "policy_loss": -0.003377370257719846, "vf_loss": 1359.3434086686473, "vf_explained_var": 0.32173576951026917, "kl": 0.01818241060371606, "entropy": 0.01872101767714751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1410000, "num_agent_steps_sampled": 1410000, "num_steps_trained": 1410000}, "done": false, "episodes_total": 1886, "training_iteration": 188, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-34-06", "timestamp": 1693794846, "time_this_iter_s": 12.697248935699463, "time_total_s": 2463.028928041458, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2463.028928041458, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 25.83157894736842, "ram_util_percent": 19.247368421052627}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 400.8931040228548, "episode_reward_mean": 490.64984780059507, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [436.64542649234113, 416.7119827994477, 501.31917128489766, 517.518685902969, 408.8288160763824, 424.22694604843144, 427.98039608969276, 492.4428182316468, 519.1182776201335, 493.0210207111983, 464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.525958908543915, "mean_inference_ms": 0.7052196065759654, "mean_action_processing_ms": 0.06667415719422444, "mean_env_wait_ms": 3.5108060585224443, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1417500, "agent_timesteps_total": 1417500, "timers": {"sample_time_ms": 6636.69, "sample_throughput": 1130.081, "learn_time_ms": 5757.025, "learn_throughput": 1302.756, "update_time_ms": 2.148}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1497.3814037258342, "policy_loss": -0.006889045332416387, "vf_loss": 1497.3882738016418, "vf_explained_var": 0.16836224496364594, "kl": 0.024516610975645864, "entropy": 0.3089588494754349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1417500, "num_agent_steps_sampled": 1417500, "num_steps_trained": 1417500}, "done": false, "episodes_total": 1896, "training_iteration": 189, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-34-18", "timestamp": 1693794858, "time_this_iter_s": 12.213727712631226, "time_total_s": 2475.2426557540894, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2475.2426557540894, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 29.005882352941175, "ram_util_percent": 19.24705882352941}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 491.49501265460276, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [464.7462801312541, 461.0759155414686, 504.64876560978075, 491.58960912617636, 522.7176124446358, 514.6014905730914, 517.6722225548251, 516.8165144744206, 492.4841881647509, 400.8931040228548, 514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.522493964105347, "mean_inference_ms": 0.7050099153580911, "mean_action_processing_ms": 0.06665364387196891, "mean_env_wait_ms": 3.509143526563775, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1425000, "agent_timesteps_total": 1425000, "timers": {"sample_time_ms": 6667.882, "sample_throughput": 1124.795, "learn_time_ms": 5754.006, "learn_throughput": 1303.44, "update_time_ms": 2.125}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1444.0587941832462, "policy_loss": -0.004080928448524515, "vf_loss": 1444.0628518314684, "vf_explained_var": 0.19785729050636292, "kl": 0.027604979351883444, "entropy": 0.08321304858930535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1425000, "num_agent_steps_sampled": 1425000, "num_steps_trained": 1425000}, "done": false, "episodes_total": 1906, "training_iteration": 190, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-34-31", "timestamp": 1693794871, "time_this_iter_s": 12.503516435623169, "time_total_s": 2487.7461721897125, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2487.7461721897125, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 22.63684210526316, "ram_util_percent": 19.23684210526315}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 490.711141339803, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [514.1780502370353, 469.4283243205386, 517.6426123292877, 511.9519768333736, 495.5929875873758, 516.2147077019101, 517.5001947319611, 503.92765321225954, 514.1919731853798, 519.2921306417104, 490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.518732946654358, "mean_inference_ms": 0.7048025562236501, "mean_action_processing_ms": 0.06663344491376305, "mean_env_wait_ms": 3.5074424031847955, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1432500, "agent_timesteps_total": 1432500, "timers": {"sample_time_ms": 6642.592, "sample_throughput": 1129.077, "learn_time_ms": 5759.857, "learn_throughput": 1302.116, "update_time_ms": 2.124}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1365.515139201536, "policy_loss": -0.004315987879102576, "vf_loss": 1365.5194424903998, "vf_explained_var": 0.27226534485816956, "kl": 0.020223752770378828, "entropy": 0.07613893483402365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1432500, "num_agent_steps_sampled": 1432500, "num_steps_trained": 1432500}, "done": false, "episodes_total": 1916, "training_iteration": 191, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-34-43", "timestamp": 1693794883, "time_this_iter_s": 12.085509538650513, "time_total_s": 2499.831681728363, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2499.831681728363, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 24.929411764705883, "ram_util_percent": 19.241176470588233}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 527.9343431676389, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 487.15779863477945, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.66523456490876, 465.78435481297373, 527.9343431676389, 504.095346455527, 501.17111582521045, 485.7713560488044, 527.608276402037, 508.61006945570233, 451.529354268532, 455.9268964117868, 459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.515688440544443, "mean_inference_ms": 0.7045545804271286, "mean_action_processing_ms": 0.06661454892082419, "mean_env_wait_ms": 3.505804125176997, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1440000, "agent_timesteps_total": 1440000, "timers": {"sample_time_ms": 6718.495, "sample_throughput": 1116.321, "learn_time_ms": 5760.743, "learn_throughput": 1301.915, "update_time_ms": 2.158}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1431.4085022748527, "policy_loss": -0.001273959062567328, "vf_loss": 1431.4097560042042, "vf_explained_var": 0.21737441420555115, "kl": 0.02395356161601556, "entropy": -0.16110092523064803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1440000, "num_agent_steps_sampled": 1440000, "num_steps_trained": 1440000}, "done": false, "episodes_total": 1926, "training_iteration": 192, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-34-57", "timestamp": 1693794897, "time_this_iter_s": 13.479087352752686, "time_total_s": 2513.3107690811157, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2513.3107690811157, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 24.535000000000004, "ram_util_percent": 19.224999999999994}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.3153599218871, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 485.460811448193, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.4434066155869, 517.6342826619091, 520.5365468997259, 495.43249160390553, 520.2737858150394, 477.0982235746526, 507.59057520766567, 499.59242745091683, 458.0943156029759, 519.1437807082459, 517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.512733925145962, "mean_inference_ms": 0.7043086947762193, "mean_action_processing_ms": 0.0665956904223504, "mean_env_wait_ms": 3.504236055208841, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1447500, "agent_timesteps_total": 1447500, "timers": {"sample_time_ms": 6754.419, "sample_throughput": 1110.384, "learn_time_ms": 5760.104, "learn_throughput": 1302.06, "update_time_ms": 2.154}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1436.099587857521, "policy_loss": -0.0035245135110818734, "vf_loss": 1436.1030992410952, "vf_explained_var": 0.22040219604969025, "kl": 0.020831747246601594, "entropy": 0.14513983263997204, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1447500, "num_agent_steps_sampled": 1447500, "num_steps_trained": 1447500}, "done": false, "episodes_total": 1936, "training_iteration": 193, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-35-10", "timestamp": 1693794910, "time_this_iter_s": 12.861266374588013, "time_total_s": 2526.1720354557037, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2526.1720354557037, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 28.016666666666666, "ram_util_percent": 19.23333333333333}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.3153599218871, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 483.0749974612973, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [517.5388760053262, 475.32594073334496, 518.8054901721383, 517.0099142552524, 510.4227980131728, 487.67401507542166, 496.3321217549233, 520.9288658674737, 465.11977895348866, 509.2092773493489, 515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.513305158349519, "mean_inference_ms": 0.7040614432714084, "mean_action_processing_ms": 0.0665766482715926, "mean_env_wait_ms": 3.5027769142886713, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1455000, "agent_timesteps_total": 1455000, "timers": {"sample_time_ms": 7255.433, "sample_throughput": 1033.708, "learn_time_ms": 5765.273, "learn_throughput": 1300.892, "update_time_ms": 2.152}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1450.417143637447, "policy_loss": -0.0052388642168745905, "vf_loss": 1450.4223591432733, "vf_explained_var": 0.17380347847938538, "kl": 0.026100714950846253, "entropy": 0.10030305527221664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1455000, "num_agent_steps_sampled": 1455000, "num_steps_trained": 1455000}, "done": false, "episodes_total": 1946, "training_iteration": 194, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-35-27", "timestamp": 1693794927, "time_this_iter_s": 17.16154718399048, "time_total_s": 2543.333582639694, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2543.333582639694, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 19.368, "ram_util_percent": 19.099999999999998}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.3153599218871, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 480.20202534887983, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.0843093755709, 506.1645036891537, 524.9706354681383, 450.41951739229927, 514.9283004750989, 519.823680951089, 518.6695268203763, 462.25770916252105, 491.07379926933197, 515.3155366152473, 509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.513843173276639, "mean_inference_ms": 0.7038243059144582, "mean_action_processing_ms": 0.06655833793417183, "mean_env_wait_ms": 3.5013340157985, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1462500, "agent_timesteps_total": 1462500, "timers": {"sample_time_ms": 7217.443, "sample_throughput": 1039.149, "learn_time_ms": 5764.238, "learn_throughput": 1301.126, "update_time_ms": 2.103}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1368.932604489084, "policy_loss": -0.005465528829086383, "vf_loss": 1368.9380467043084, "vf_explained_var": 0.25487494468688965, "kl": 0.029365707493670627, "entropy": -0.06428546607494354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1462500, "num_agent_steps_sampled": 1462500, "num_steps_trained": 1462500}, "done": false, "episodes_total": 1956, "training_iteration": 195, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-35-40", "timestamp": 1693794940, "time_this_iter_s": 12.304285049438477, "time_total_s": 2555.6378676891327, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2555.6378676891327, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 27.316666666666666, "ram_util_percent": 19.244444444444444}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 525.3153599218871, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 478.6615675946452, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [509.81018724750015, 515.9312342342774, 510.96888934664213, 519.8066152228546, 489.05438739448107, 525.3153599218871, 502.6928565024875, 512.2096278355576, 415.98255504474855, 517.4950429692366, 503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402, 477.70932288089705, 478.62297725533773, 450.7027565650292, 516.1015902297344, 520.8115587175167, 460.2943452565357, 517.90721045662, 485.56016106708944, 488.66160906703243, 468.2902122995571], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.514355861814167, "mean_inference_ms": 0.7035878135912879, "mean_action_processing_ms": 0.06653999423430365, "mean_env_wait_ms": 3.4999186198827794, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1470000, "agent_timesteps_total": 1470000, "timers": {"sample_time_ms": 7212.4, "sample_throughput": 1039.876, "learn_time_ms": 5770.931, "learn_throughput": 1299.617, "update_time_ms": 2.167}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1433.3737113306079, "policy_loss": -0.0025247930201812317, "vf_loss": 1433.376214289261, "vf_explained_var": 0.21920017898082733, "kl": 0.02240166044892715, "entropy": -0.10067858533081361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1470000, "num_agent_steps_sampled": 1470000, "num_steps_trained": 1470000}, "done": false, "episodes_total": 1966, "training_iteration": 196, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-35-52", "timestamp": 1693794952, "time_this_iter_s": 12.474344491958618, "time_total_s": 2568.1122121810913, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2568.1122121810913, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 25.58888888888889, "ram_util_percent": 19.255555555555553}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.3683489941375, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 475.52848331488485, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [503.91486994580276, 504.42914980659117, 429.8291830258199, 509.0324716910296, 517.0786106845678, 511.0390331930213, 421.83958521993884, 508.8780131843439, 408.1386552339848, 511.40157200441183, 411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402, 477.70932288089705, 478.62297725533773, 450.7027565650292, 516.1015902297344, 520.8115587175167, 460.2943452565357, 517.90721045662, 485.56016106708944, 488.66160906703243, 468.2902122995571, 462.96694761192856, 423.4541605272741, 405.11480854128723, 509.55593485774074, 480.3869981555757, 515.6020076682921, 504.4249689652088, 510.1449848523532, 447.8229438514412, 446.4845727125575], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.515061329129465, "mean_inference_ms": 0.7033438479507869, "mean_action_processing_ms": 0.06652116621523531, "mean_env_wait_ms": 3.498508006652269, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1477500, "agent_timesteps_total": 1477500, "timers": {"sample_time_ms": 7260.678, "sample_throughput": 1032.961, "learn_time_ms": 5769.811, "learn_throughput": 1299.869, "update_time_ms": 2.112}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1377.244014727059, "policy_loss": -0.004831343377009034, "vf_loss": 1377.2488290560448, "vf_explained_var": 0.26547086238861084, "kl": 0.021126108004275793, "entropy": -0.05301677809744063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1477500, "num_agent_steps_sampled": 1477500, "num_steps_trained": 1477500}, "done": false, "episodes_total": 1976, "training_iteration": 197, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-36-05", "timestamp": 1693794965, "time_this_iter_s": 12.60436463356018, "time_total_s": 2580.7165768146515, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2580.7165768146515, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 23.805555555555557, "ram_util_percent": 19.25}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 523.3683489941375, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 474.9221029507373, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [411.106111638229, 422.5349676145691, 453.9750003313166, 507.72949172039654, 439.4557424201259, 513.6765136714574, 471.83283803241426, 479.1001906867016, 523.3683489941375, 461.36703960728806, 509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402, 477.70932288089705, 478.62297725533773, 450.7027565650292, 516.1015902297344, 520.8115587175167, 460.2943452565357, 517.90721045662, 485.56016106708944, 488.66160906703243, 468.2902122995571, 462.96694761192856, 423.4541605272741, 405.11480854128723, 509.55593485774074, 480.3869981555757, 515.6020076682921, 504.4249689652088, 510.1449848523532, 447.8229438514412, 446.4845727125575, 515.548252911926, 477.753599651799, 453.9088495494238, 449.0140700622409, 485.7919659462991, 469.1546048558573, 479.6259151820268, 512.8622997928649, 492.9220534719804, 428.3614961503301], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.516188456165461, "mean_inference_ms": 0.7030906719606839, "mean_action_processing_ms": 0.06650175968021153, "mean_env_wait_ms": 3.497043549633199, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1485000, "agent_timesteps_total": 1485000, "timers": {"sample_time_ms": 7281.61, "sample_throughput": 1029.992, "learn_time_ms": 5765.369, "learn_throughput": 1300.871, "update_time_ms": 2.067}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1394.2794256178, "policy_loss": -0.003023480038332232, "vf_loss": 1394.2824363579184, "vf_explained_var": 0.2631067931652069, "kl": 0.01883651808422717, "entropy": -0.081084098561146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1485000, "num_agent_steps_sampled": 1485000, "num_steps_trained": 1485000}, "done": false, "episodes_total": 1986, "training_iteration": 198, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-36-18", "timestamp": 1693794978, "time_this_iter_s": 12.86223816871643, "time_total_s": 2593.578814983368, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2593.578814983368, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 25.073684210526316, "ram_util_percent": 19.247368421052627}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 521.4745812642706, "episode_reward_min": 399.3637067154012, "episode_reward_mean": 476.0143951696653, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [509.2236509917045, 517.8022592109105, 501.13612079607896, 473.17585053639067, 399.3637067154012, 436.0701979692248, 441.8654954039678, 427.730579251079, 514.5320411838093, 501.4301245993363, 454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402, 477.70932288089705, 478.62297725533773, 450.7027565650292, 516.1015902297344, 520.8115587175167, 460.2943452565357, 517.90721045662, 485.56016106708944, 488.66160906703243, 468.2902122995571, 462.96694761192856, 423.4541605272741, 405.11480854128723, 509.55593485774074, 480.3869981555757, 515.6020076682921, 504.4249689652088, 510.1449848523532, 447.8229438514412, 446.4845727125575, 515.548252911926, 477.753599651799, 453.9088495494238, 449.0140700622409, 485.7919659462991, 469.1546048558573, 479.6259151820268, 512.8622997928649, 492.9220534719804, 428.3614961503301, 484.5252679978978, 486.1613564294076, 514.6895235373629, 502.72610483671207, 476.12402373337636, 507.54632792694247, 407.8753410417327, 423.86097655549946, 507.76647320742904, 482.100071343076], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5180680864352, "mean_inference_ms": 0.7028291159188398, "mean_action_processing_ms": 0.06648131612487701, "mean_env_wait_ms": 3.4954897280573407, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1492500, "agent_timesteps_total": 1492500, "timers": {"sample_time_ms": 7440.535, "sample_throughput": 1007.992, "learn_time_ms": 5765.97, "learn_throughput": 1300.735, "update_time_ms": 2.09}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1352.0287829900192, "policy_loss": -0.0058487965314948966, "vf_loss": 1352.0346135543564, "vf_explained_var": 0.29290077090263367, "kl": 0.02469249614901672, "entropy": -0.1410026391494577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1492500, "num_agent_steps_sampled": 1492500, "num_steps_trained": 1492500}, "done": false, "episodes_total": 1996, "training_iteration": 199, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-36-32", "timestamp": 1693794992, "time_this_iter_s": 13.808937311172485, "time_total_s": 2607.3877522945404, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2607.3877522945404, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 20.745, "ram_util_percent": 19.24}, "trial_id": "ba3bd_00000"}
{"episode_reward_max": 521.4745812642706, "episode_reward_min": 390.26815551399363, "episode_reward_mean": 474.3417819123525, "episode_len_mean": 750.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [454.18142448833737, 521.4745812642706, 407.3372629373535, 446.4306038758446, 519.7474736008892, 414.20888595726774, 515.6918957301845, 512.3277704733013, 503.514063086338, 513.9446097494858, 509.9503473907492, 455.7324543259498, 463.30115672641233, 509.8667566961835, 431.31611163030084, 508.3238525636362, 498.63287008971514, 495.9393420074792, 412.311842009081, 439.2116068389769, 414.57422284243444, 453.12242173818527, 513.7090019400335, 452.57884815810223, 506.9061635361395, 491.0818270520369, 463.8804167174136, 519.6114053258482, 514.6183355366574, 419.31498590762106, 513.5129858321553, 475.0517741198624, 453.5251821302131, 433.16420898661875, 438.77480631124695, 515.994615945095, 517.2384273244593, 498.71703026383244, 460.4288726415772, 429.8505338960041, 489.801859954348, 407.7468162040422, 447.69163877289947, 497.9572431791079, 500.86120110722084, 514.4501096634629, 475.2080984268735, 468.6130279467935, 439.54707133185303, 489.1928003515402, 477.70932288089705, 478.62297725533773, 450.7027565650292, 516.1015902297344, 520.8115587175167, 460.2943452565357, 517.90721045662, 485.56016106708944, 488.66160906703243, 468.2902122995571, 462.96694761192856, 423.4541605272741, 405.11480854128723, 509.55593485774074, 480.3869981555757, 515.6020076682921, 504.4249689652088, 510.1449848523532, 447.8229438514412, 446.4845727125575, 515.548252911926, 477.753599651799, 453.9088495494238, 449.0140700622409, 485.7919659462991, 469.1546048558573, 479.6259151820268, 512.8622997928649, 492.9220534719804, 428.3614961503301, 484.5252679978978, 486.1613564294076, 514.6895235373629, 502.72610483671207, 476.12402373337636, 507.54632792694247, 407.8753410417327, 423.86097655549946, 507.76647320742904, 482.100071343076, 422.45277971568487, 490.02853630199405, 420.03785864814074, 477.19401836620995, 505.56574155392764, 441.8430595709626, 484.6452962907182, 462.01407059997, 461.01918436500847, 390.26815551399363], "episode_lengths": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.5197256755871305, "mean_inference_ms": 0.7025824816239719, "mean_action_processing_ms": 0.06646214777110356, "mean_env_wait_ms": 3.4940298254849, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 10, "timesteps_total": 1500000, "agent_timesteps_total": 1500000, "timers": {"sample_time_ms": 7471.135, "sample_throughput": 1003.864, "learn_time_ms": 5766.622, "learn_throughput": 1300.588, "update_time_ms": 2.102}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 5.000000000000001e-05, "total_loss": 1413.6029274116129, "policy_loss": 0.00016569807904504114, "vf_loss": 1413.6027561511023, "vf_explained_var": 0.24770843982696533, "kl": 0.0180946004965446, "entropy": 0.08349662865117445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}}}, "num_steps_sampled": 1500000, "num_agent_steps_sampled": 1500000, "num_steps_trained": 1500000}, "done": true, "episodes_total": 2006, "training_iteration": 200, "experiment_id": "95f74753cab44a9bbbbd3de36d4d1aad", "date": "2023-09-03_22-36-45", "timestamp": 1693795005, "time_this_iter_s": 12.816088914871216, "time_total_s": 2620.2038412094116, "pid": 23405, "hostname": "michael-villarreal", "node_ip": "192.168.0.200", "config": {"num_workers": 10, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 750, "batch_mode": "truncate_episodes", "gamma": 0.999, "lr": 5e-05, "train_batch_size": 7500, "model": {"_use_default_native_models": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": 750, "soft_horizon": false, "no_done_at_end": false, "env": "MergePOEnv-v0", "observation_space": null, "action_space": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"circle_mask\": true,\n            \"evaluate\": false,\n            \"img_dim\": 84,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"obs_type\": \"precise\",\n            \"perturb\": false,\n            \"target_velocity\": 20\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.merge.MergePOEnv\",\n    \"exp_tag\": \"double_merge_precise_HW1300M200\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 50,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 350,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1170.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 130.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_bottom\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge_top\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 200,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.merge.MergeNetwork\",\n    \"sim\": {\n        \"additional_params\": {\n            \"network\": \"merge\",\n            \"obs_type\": \"precise\"\n        },\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": true,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 42,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "WARN", "callbacks": "<class 'ray.rllib.agents.callbacks.DefaultCallbacks'>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": true, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.02, "vf_share_layers": -1}, "time_since_restore": 2620.2038412094116, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 24.394444444444442, "ram_util_percent": 19.277777777777775}, "trial_id": "ba3bd_00000"}
